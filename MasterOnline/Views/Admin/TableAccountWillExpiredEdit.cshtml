@using System.Globalization
@using MasterOnline.Models
@model MasterOnline.Models.MenuAccount
@{
    var context_ = new MoDbContext();
}
<table id="datatable_willexpirededit" class="table table-striped table-bordered dataTable" role="grid" aria-describedby="datatable_info">
    <thead>
        <tr role="row">
            @*change by nurul 13/2/2019*@
            @*<th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 90px;">Account</th>
        <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 50px;">Email</th>
        <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 85px;">No. HP</th>
        <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 85px;">Nama Toko</th>
        <th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 60px;">Status</th>
        <th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 70px;">Tipe Subs</th>
        <th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 120px;">Tgl. Berakhir Subs</th>
        <th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 40px; max-width: 40px;">Ubah</th>*@

            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 90px;">Account/Email</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 90px;">Nama</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 85px;">No. HP</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 85px;">Nama Toko</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 85px;">Nama Partner</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 90px;">Tgl. Daftar</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 90px;">Tgl. Approve</th>
            <th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 120px;">Tgl. Berakhir Subs</th>
            <th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 70px;">Tipe Subs</th>
            <th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 60px;">Jumlah User</th>
            <th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 60px;">Status</th>
            @*<th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 40px; max-width: 40px;">Ubah Detail</th>*@
            @*end change by nurul 13/2/2019*@
        </tr>
    </thead>
    <tbody>
        @if (Model != null)
        {
            foreach (var user in Model.ListAccount.ToList())
            {
                var nmPartner = "-";
                var partner = Model?.ListPartner?.SingleOrDefault(a => Convert.ToString(a.PartnerId) == user.KODE_REFERRAL);
                if (partner != null)
                {
                    nmPartner = partner.Username;
                }
        <tr>
            <td>@user.Email</td>
            <td>
                @*<a class="user-link" href="@Url.Action("AccountDetail", "Admin", new {accId = user.AccountId })"> 'change by nurul 20/2/2019*@
                <a class="user-link" href="#" onclick="LihatAccount2(@(user.AccountId))">
                    @user.Username
                </a>
            </td>
            <td class="text-center">@user.NoHp</td>
            <td>@user.NamaTokoOnline</td>
            <td>
                @*@Model.ListPartner.SingleOrDefault(a => a.Email == user.Email).Username*@
                @nmPartner
            </td>
            <td class="text-center">@(user.TGL_DAFTAR?.ToString("dd/MM/yyyy"))</td>
            <td class="text-center">@(user.tgl_approve?.ToString("dd/MM/yyyy"))</td>
            <td class="text-center">@(user.TGL_SUBSCRIPTION?.ToString("dd/MM/yyyy"))</td>
            <td class="text-center">
                @*change by Tri, 8 Feb 2019*@
                @*@if (user.KODE_SUBSCRIPTION == "01")
            {
                @("FREE")
            }
            else if (user.KODE_SUBSCRIPTION == "02")
            {
                @("BASIC")
            }
            else if (user.KODE_SUBSCRIPTION == "03")
            {
                @("PREMIUM")
            }*@
                @context_.Subscription.Where(p => p.KODE == user.KODE_SUBSCRIPTION).FirstOrDefault().KETERANGAN
                @*end change by Tri, 8 Feb 2019*@
            </td>
            <td class="text-center">@(user?.jumlahUser == null ? 0 : user.jumlahUser)</td>
            <td class="text-center">
                @if (user.Status)
                {
                    @("Aktif")
                }
                else
                {
                    @("Tidak Aktif")
                }
            </td>
            @*<td class="edit-hapus-col">
            @if (user.UserId == "admin_manage")
            {
                <button class="btn btn-primary" disabled="disabled" onclick="editAccount(@user.AccountId)">
                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                </button>
            }
            else
            {
                <button class="btn btn-primary" onclick="editAccount(@user.AccountId)">
                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                </button>
            }
        </td>*@
        </tr>
            }
        }
    </tbody>
</table>
@using System.Globalization
@using MasterOnline.ViewModels
@model MasterOnline.ViewModels.SubsViewModel
@{
    ViewBag.Title = "Manage Account";
    Layout = "~/Views/Shared/_LayoutManage.cshtml";

    var context = new MoDbContext();
    var dataSession = Session["SessionInfo"] as AccountUserViewModel;

    long accId;
    var username = "";
    if (dataSession?.User != null)
    {
        accId = context.User.Single(u => u.Username == dataSession.User.Username).AccountId;
        username = context.Account.Single(a => a.AccountId == accId).Username;
    }
    else
    {
        username = dataSession?.Account?.Username;
        accId = (dataSession?.Account?.AccountId ?? 0);
    }
}

@section styles {
    <link href="~/Content/build/css/bootstrap-datepicker.min.css" rel="stylesheet" />
    @*<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.css" rel="stylesheet" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css" rel="stylesheet" />*@
    @*<link type="text/css" rel="stylesheet" href="css/default.css" />*@

    <link type="text/css" href="//gyrocode.github.io/jquery-datatables-checkboxes/1.2.11/css/dataTables.checkboxes.css" rel="stylesheet" />

    <style>
        .label_waktu {
            margin-bottom: 15px;
        }

        .divider_2 {
            border-bottom: solid 2px #e6e9ed;
            margin: 10px 0;
        }

        .pemisah_info {
            margin: 7px 0;
        }

        .block_subtitle {
            display: inline-block;
            width: 300px;
            font-size: 15px;
        }

        #today_label {
            position: absolute;
            top: 7px;
        }

        .dropdown-menu > li > a {
            font-size: 14px !important;
        }
    </style>
    @*//add by nurul 22/2/2019*@
    <style>
        #modal-pricing {
            margin: auto;
            width: 60em;
        }

            #modal-pricing .modal-content {
                -webkit-box-shadow: none;
                box-shadow: none;
                border: none;
                background-color: transparent;
            }

        .snip1404 {
            font-family: 'Source Sans Pro', Arial, sans-serif;
            text-align: left;
            font-size: 16px;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            display: table;
        }

            .snip1404 img {
                /*position: absolute;
                left: 0;
                top: 0;
                height: 100%;
                z-index: -1;*/
                width: 60%;
                margin-bottom: 20px;
                margin-top: 15px;
                z-index: 0;
            }

            .snip1404 .plan {
                margin: 0;
                width: 33.333333%;
                position: relative;
                float: left;
                overflow: hidden;
                border: 3px solid #442232;
                box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
                background-color: #c13232;
            }

                .snip1404 .plan:hover i,
                .snip1404 .plan.hover i {
                    -webkit-transform: scale(1.2);
                    transform: scale(1.2);
                }

                .snip1404 .plan:first-of-type {
                    border-radius: 8px 0 0 8px;
                }

                .snip1404 .plan:last-of-type {
                    border-radius: 0 8px 8px 0;
                }

            .snip1404 * {
                -webkit-box-sizing: border-box;
                box-sizing: border-box;
                -webkit-transition: all 0.25s ease-out;
                transition: all 0.25s ease-out;
            }

            .snip1404 header {
                background-color: #c13232;
                color: #ffffff;
            }

            .snip1404 .plan-title {
                background-color: rgba(0, 0, 0, 0.5);
                position: relative;
                margin: 0;
                padding: 20px 20px 0;
                text-transform: uppercase;
                letter-spacing: 4px;
            }

                .snip1404 .plan-title:after {
                    position: absolute;
                    content: '';
                    top: 100%;
                    left: 0;
                    width: 0;
                    height: 0;
                    border-style: solid;
                    border-width: 30px 250px 0 0;
                    border-color: rgba(0, 0, 0, 0.5) transparent transparent;
                }

            .snip1404 .plan-cost {
                padding: 20px 20px 10px;
                text-align: right;
            }

            .snip1404 .plan-price {
                font-weight: 600;
                font-size: 1.5em;
            }

            .snip1404 .plan-type {
                opacity: 0.8;
                font-size: 0.7em;
                text-transform: uppercase;
            }

            .snip1404 .plan-price-total {
                font-weight: 600;
                font-size: 1.1em;
                color: #fff;
            }

            .snip1404 .plan-month-total {
                font-weight: 600;
                font-size: 0.9em;
                color: #fff;
            }

            .snip1404 .plan-features {
                color: #fff;
                padding: 0 0 10px;
                margin: 0;
                list-style: outside none none;
            }

                .snip1404 .plan-features li {
                    padding: 0;
                }

                .snip1404 .plan-features i {
                    margin-right: 8px;
                    color: rgba(0, 0, 0, 0.5);
                }

            .snip1404 .plan-select {
                border-top: 1px solid rgba(0, 0, 0, 0.2);
                padding: 5px;
                text-align: center;
            }

                .snip1404 .plan-select a {
                    background-color: #442232;
                    color: #ffffff;
                    text-decoration: none;
                    padding: 12px 20px;
                    font-size: 0.75em;
                    font-weight: 600;
                    border-radius: 20px;
                    text-transform: uppercase;
                    letter-spacing: 4px;
                    display: inline-block;
                }

                    .snip1404 .plan-select a:hover {
                        background-color: #552a3f;
                    }

            .snip1404 .featured {
                margin-top: -10px;
                border-color: #331926;
                box-shadow: 0 0 25px rgba(0, 0, 0, 0.4);
                z-index: 1;
                border-radius: 8px;
            }

                .snip1404 .featured .plan-select {
                    padding: 15px 10px;
                }

        @@media only screen and (max-width: 767px) {
            .snip1404 .plan {
                width: 50%;
            }

            .snip1404 .plan-title,
            .snip1404 .plan-select a {
                -webkit-transform: translateY(0);
                transform: translateY(0);
            }

            .snip1404 .plan-select,
            .snip1404 .featured .plan-select {
                padding: 20px;
            }

            .snip1404 .featured {
                margin-top: 0;
            }
        }

        @@media only screen and (max-width: 440px) {
            .snip1404 .plan {
                width: 100%;
            }
        }

        body {
            background-color: #212121;
        }

        .btn-section > .row > button {
            padding: 5px;
            margin-bottom: 5px;
            background: #fb9595;
            border: 1px solid #9a2828;
            color: #000;
            width: 65%;
        }

            .btn-section > .row > button[disabled] {
                padding: 10px;
                margin-bottom: 15px;
                background: #9c9c9c;
                border: 1px solid #9a2828;
                color: #000;
            }

            .btn-section > .row > button:hover {
                padding: 5px;
                margin-bottom: 5px;
                background: #fd4646;
                border: 1px solid #9a2828;
                color: #000;
            }

        .subs_active {
            background: #fd4646 !important;
        }

        .btn-pindah-paket:hover {
            cursor: pointer;
        }
    </style>
    <style type="text/css">
        /*//add by nurul 5/7/2019*/
        [class$="-legend"] {
            list-style: none;
            cursor: pointer;
            padding-left: 0;
        }

            [class$="-legend"] li {
                display: inline-block;
                padding: 0 5px;
            }

                [class$="-legend"] li.hidden {
                    text-decoration: line-through;
                }

                [class$="-legend"] li span {
                    border-radius: 5px;
                    display: inline-block;
                    height: 10px;
                    margin-right: 10px;
                    width: 10px;
                }

        /*//end add by nurul 5/7/2019*/
        .bar {
            font-size: 30px;
            color: #ed1338;
        }

        .nav-row {
            padding: 30px;
        }

            .nav-row > div > a {
                padding: 7px;
            }

        #loading_spinner {
            display: none;
            width: 100%;
            height: 100%;
            position: fixed;
            z-index: 100;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-color: rgba(0,0,0,.5);
        }

        #loading_spinner_image {
            width: 20px;
            height: 20px;
            margin-top: -90px;
            margin-left: -90px;
            position: absolute;
            top: 50%;
            left: 50%;
            border-width: 30px;
            border-radius: 50%;
        }

        #loading_spinner_btn {
            display: none;
            width: 100%;
            height: 100%;
            z-index: 100;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        #loading_spinner_image_btn {
            width: 20px;
            height: 40px;
            border-width: 30px;
            border-radius: 50%;
        }

        #soc-med-btn-nav {
            float: right;
            margin-right: 80px;
            margin-bottom: 15px;
        }


        .subs_body {
            background: white;
            letter-spacing: 0.4px;
            font-family: 'RoundedElegance';
            color: black;
        }

        @@font-face {
            font-family: 'RoundedElegance'; /*src: url("~/fonts/rounded_elegance.svg");
                src: url("~/fonts/rounded_elegance.ttf") format('truetype');*/
            src: url("../../fonts/rounded_elegance.svg");
            src: url("../../fonts/rounded_elegance.ttf") format('truetype');
            font-weight: bold;
        }

        /*.modal-content {
            margin-top: 225px !important;
        }*/

        .modal-dialog {
            height: auto !important;
        }

        .title-features-mobile {
            font-size: 10px !important;
        }

        .sub-title-features-mobile {
            font-size: 9px !important;
        }

        .feature-mobile-row {
            margin-bottom: 25px !important;
        }


        h2.mobile-title {
            font-size: 16px !important;
        }

        #cover p {
            font-size: 14px !important;
        }

        #mobile-app-section {
            margin-top: 25px !important;
        }


        body {
            overflow-x: hidden;
        }

        .row {
            margin-right: 0;
            margin-left: 0;
        }

        html {
            /*-webkit-text-stroke-width: 0.5pt;*/
            text-rendering: optimizeLegibility !important;
            -webkit-font-smoothing: antialiased !important;
            -moz-osx-font-smoothing: grayscale !important;
        }

        #cover {
            margin-top: 175px;
            margin-bottom: 18px;
            background-size: cover;
            min-height: 350px;
        }

        h2.pc-title {
            color: #891539;
            font-size: 45px;
            line-height: 60px;
            letter-spacing: 3px;
            font-weight: 700;
        }

        h2.mobile-title {
            color: #891539;
            font-size: 30px;
            line-height: 58px;
            letter-spacing: 3px;
            font-weight: 700;
        }

        #cover h3 {
            font-size: 58px;
            font-weight: 700;
            text-transform: uppercase;
            font-family: 'RoundedElegance';
        }

            #cover h3 span {
                color: #ed5565;
            }

        #cover span {
            font-size: 53px;
        }

        #cover p {
            font-size: 18px;
            letter-spacing: .5px;
        }

        #cover .btn {
            background-color: #891539;
            color: #fff;
        }

            #cover .btn:hover {
                background-color: #f37100 !important;
            }

        .focus-text {
            text-transform: uppercase;
            color: #f37100;
        }

        #btn-daftar-pc {
            width: 50%;
            float: right;
            margin: 0 auto;
            border-radius: 10px !important;
            margin-top: 40px;
            box-shadow: 0px 7px 5px rgb(136, 136, 136);
        }

        #mobile-app-section {
            margin-top: 60px;
        }

        #btn-daftar-mobile {
            border-radius: 10px !important;
            width: 100%;
            margin-top: 25px;
            box-shadow: 0px 7px 5px rgb(136, 136, 136);
        }

        #btn-video-pc {
            width: 50%;
            float: left;
            background-color: #5db836 !important;
            margin: 0 auto;
            border-radius: 10px !important;
            margin-top: 40px;
            box-shadow: 0px 7px 5px rgb(136, 136, 136);
        }

        #btn-video-mobile {
            background-color: #5db836 !important;
            border-radius: 10px !important;
            width: 100%;
            margin-top: 25px;
            box-shadow: 0px 7px 5px rgb(136, 136, 136);
        }

        #gradient-mo {
            background: rgba(255,23,23,1);
            background: -moz-linear-gradient(left, rgba(255,23,23,1) 0%, rgba(137,21,57,1) 50%, rgba(137,21,57,1) 100%);
            background: -webkit-gradient(left top, right top, color-stop(0%, rgba(255,23,23,1)), color-stop(50%, rgba(137,21,57,1)), color-stop(100%, rgba(137,21,57,1)));
            background: -webkit-linear-gradient(left, rgba(255,23,23,1) 0%, rgba(137,21,57,1) 50%, rgba(137,21,57,1) 100%);
            background: -o-linear-gradient(left, rgba(255,23,23,1) 0%, rgba(137,21,57,1) 50%, rgba(137,21,57,1) 100%);
            background: -ms-linear-gradient(left, rgba(255,23,23,1) 0%, rgba(137,21,57,1) 50%, rgba(137,21,57,1) 100%);
            background: linear-gradient(to right, rgba(255,23,23,1) 0%, rgba(137,21,57,1) 50%, rgba(137,21,57,1) 100%);
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ff1717', endColorstr='#891539', GradientType=1 );
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
        }

        .videoWrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 */
            padding-top: 25px;
            height: 0;
        }

            .videoWrapper iframe {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
            }

        .modal-dialog {
            width: 75%;
            height: 75%;
            margin: 0 auto;
            padding: 0;
        }

        .modal-content {
            margin-top: 35px;
            height: auto;
            min-height: 100%;
            border-radius: 0;
        }

        .videoBox {
            position: relative;
            padding-bottom: 30.25%; /* 16:9 */
            height: 0;
        }

            .videoBox iframe {
                position: absolute;
                top: 0;
                left: 25%;
                width: 50%;
                height: 100%;
            }

        #marketplace .logo-container {
            padding: 40px 0;
        }

        .grayish-white {
            background-color: #F5F5F5;
        }

        .grayish-white-f6 {
            background-color: #f6f6f6;
        }

        #marketplace .title-box-red,
        .carakerja .title-box-red {
            padding: 10px 7px;
        }

            #marketplace .title-box-red h3,
            .carakerja .title-box-red h3 {
                font-size: 20px;
                color: #fff;
                font-weight: 400;
                margin: 0px;
                text-align: left !important;
            }

        #marketplace .mp-logo:first-child {
            margin-left: 60px;
        }

        #marketplace .mp-logo {
            margin-right: 15px;
        }

        .titleSection {
            color: #ed5565;
            font-size: 35px;
            text-align: center;
            font-weight: 500;
        }

        .carakerja {
            padding: 0 0 40px 0;
            background-color: #fff;
        }

            .carakerja h3, .carakerja p {
                font-weight: 300;
                text-align: center;
            }

            .carakerja h3 {
                font-size: 22px;
            }

            .carakerja p {
                font-size: 17px;
                line-height: 24px;
                color: #777;
            }

            .carakerja strong {
                font-size: 20px;
                font-weight: 500;
                text-align: center;
                display: block;
            }

            .carakerja img {
                margin-top: 25px;
            }

        #banner {
            background: url(../../Content/Images/shattered.png) 0 50%;
            min-height: 200px;
            padding: 20px 0;
            text-align: center;
        }

            #banner h2 {
                color: #999;
                font-size: 25px;
                font-weight: 400;
                margin: 30px 0 28px 0;
            }

        /*footer {
            background: #891539;
            padding: 30px 0;
        }

        .footerMenuCol {
            margin-bottom: 20px;
        }

        footer h3 {
            color: #fff;
            font-size: 15px;
            font-weight: 400;
            text-transform: uppercase;
            margin-top: 0;
        }

        footer ul, footer ul li {
            list-style: none;
        }

            footer ul li {
                margin-left: -40px !important;
                padding: 7px 0 7px 10px;
                border-bottom: 1px solid #f9f9f9;
            }

                footer ul li a {
                    color: #f7f7f7;
                    font-size: 12px;
                    font-weight: 300;
                    text-decoration: none;
                }*/

        .title-box-red {
            background: rgba(137,21,57,1);
            background: -moz-linear-gradient(left, rgba(137,21,57,1) 0%, rgba(137,21,57,1) 70%, rgba(255,23,23,1) 100%);
            background: -webkit-gradient(left top, right top, color-stop(0%, rgba(137,21,57,1)), color-stop(70%, rgba(137,21,57,1)), color-stop(100%, rgba(255,23,23,1)));
            background: -webkit-linear-gradient(left, rgba(137,21,57,1) 0%, rgba(137,21,57,1) 70%, rgba(255,23,23,1) 100%);
            background: -o-linear-gradient(left, rgba(137,21,57,1) 0%, rgba(137,21,57,1) 70%, rgba(255,23,23,1) 100%);
            background: -ms-linear-gradient(left, rgba(137,21,57,1) 0%, rgba(137,21,57,1) 70%, rgba(255,23,23,1) 100%);
            background: linear-gradient(to right, rgba(137,21,57,1) 0%, rgba(137,21,57,1) 70%, rgba(255,23,23,1) 100%);
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#891539', endColorstr='#ff1717', GradientType=1 );
        }

        .carakerja .content-feature {
            background-color: #f6f6f6;
            padding-bottom: 10px;
        }

        #promo_pulsa {
            display: none; /* Sementara */
            position: absolute;
            width: 20%;
            right: 15px;
            top: 175px;
            z-index: 100;
        }

        .no-padding {
            padding: 0 !important;
        }

        .title-features {
            font-size: 15px;
            font-weight: bold;
            position: absolute;
            top: 0;
            left: 0;
        }

        .sub-title-features {
            font-size: 14px;
            position: absolute;
            top: 30px;
            left: 0;
        }

        .title-features-mobile {
            font-size: 12px;
            font-weight: bold;
            position: absolute;
            top: 0;
            left: 0;
        }

        .sub-title-features-mobile {
            font-size: 11px;
            position: absolute;
            top: 25px;
            left: 0;
        }

        .feature-mobile-row {
            margin-bottom: 30px;
        }

        .btn-basicfree:hover {
            color: #F5F5F5;
            background-color: #891539;
        }

        .btn-basicfree {
            color: #891539;
            background-color: white;
            text-align: center;
            border-radius: 10 1 1 1;
            border: 1px solid #891539;
        }

        .btn-silver:hover {
            color: #F5F5F5;
            background-color: #891539;
        }

        .btn-silver {
            color: #891539;
            background-color: white;
            text-align: center;
            border-radius: 10 1 1 1;
            border: 1px solid #891539;
        }


        .panel-default-noborder {
            border: 1px;
        }

        hr {
            border: 1px solid #891539;
        }

        .table thead > tr > th,
        .table tbody > tr > th,
        .table tfoot > tr > th,
        .table thead > tr > td,
        .table tbody > tr > td,
        .table tfoot > tr > td {
            padding: 8px;
            line-height: 1.428571429;
            vertical-align: top;
            border-top: 0px;
        }

        .table_subs thead > tr > th {
            padding: 8px;
            line-height: 1.428571429;
            vertical-align: top;
            border-top: 0px solid #dddddd;
            border-bottom: 2px solid #891539;
        }



        .glyphicon-ok {
            color: #21b716;
        }

        /*.glyphicon-remove {
            color: #891539;
        }*/


        .enterpriseColumn {
            padding: 8px;
            line-height: 1.428571429;
            vertical-align: middle;
            border: 2px solid #891539 !important;
            color: #891539;
        }
    </style>
    @*//add by nurul 22/2/2019*@

    @*//add by nurul 19/7/2019*@
    <style>
        .checkbox-container {
            display: block;
            position: relative;
            /*padding-left: 35px;*/
            margin-top: 4px;
            cursor: pointer;
            font-size: 11px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

            /* Hide the browser's default checkbox */
            .checkbox-container input {
                position: relative;
                opacity: 100;
                cursor: pointer;
                display: none;
            }

        /* Create a custom checkbox */
        .checkmark {
            position: absolute;
            top: 0;
            /*remark by calvin 17 juni 2019, perbaikan tampilan suryadi*/
            /*left: 18px;*/
            /*end remark by calvin 17 juni 2019, perbaikan tampilan suryadi*/
            height: 25px;
            width: 25px;
            background-color: #FFFFFF;
            border: solid 1px #ccc;
        }

        /* On mouse-over, add a grey background color */
        .checkbox-container:hover input ~ .checkmark {
            background-color: #ccc;
        }

        /* When the checkbox is checked, add a blue background */
        .checkbox-container input:checked ~ .checkmark {
            background-color: #2196F3;
        }

        /* Create the checkmark/indicator (hidden when not checked) */
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        /* Show the checkmark when checked */
        .checkbox-container input:checked ~ .checkmark:after {
            display: block;
        }

        /* Style the checkmark/indicator */
        .checkbox-container .checkmark:after {
            left: 9px;
            top: 5px;
            width: 6px;
            height: 10px;
            border: solid white;
            border-width: 0 3px 3px 0;
            -webkit-transform: rotate(45deg);
            -ms-transform: rotate(45deg);
            transform: rotate(45deg);
        }
    </style>
    @*//end add by nurul 19/7/2019*@
}
<div id="top_dashboard">
    <div class="row">
        <div class="col-md-2">
            <b class="hidden-md hidden-lg">Tanggal Hari Ini :</b>
            <b class="hidden-xs hidden-sm" id="today_label">Tanggal Hari Ini :</b>
        </div>
        <div class="col-md-2">
            <div class="input-group date">
                <input type="text" id="TGL" class="form-control" />
                <span class="input-group-addon">
                    <span class="glyphicon glyphicon-calendar"></span>
                </span>
            </div>
        </div>
        <div class="col-md-2 col-sm-12">
            <div class="dropdown">
                <button class="btn btn-default dropdown-toggle" disabled="disabled" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                    <span id="mode">Tabel</span>
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                    <li><a onclick="changeMode(0)">Grafik</a></li>
                    @*<li><a onclick="changeMode(1)">Angka</a></li>*@
                    <li><a onclick="changeMode(1)">Tabel</a></li>
                </ul>
            </div>
        </div>
    </div>
    @*<div class="row chart-mode">
            <div class="col-md-6" id="chart-jumlah-section">
                <h4>Grafik Berdasarkan Jumlah</h4>
                <canvas id="chart-jumlah" height="200"></canvas>
            </div>
            <div class="col-md-6" id="chart-nilai-section">
                <h4>Grafik Berdasarkan Nilai</h4>
                <canvas id="chart-nilai" height="200"></canvas>
            </div>
        </div>
        <br />*@
    <div class="row chart-mode" style="margin-bottom: 20px;">
        @*//add by nurul 12/7/2019*@
        <div class="x_panel" id="dashboard_line">
            @*<h4>Grafik Garis</h4>*@
            <div class="row">
                <div class="col-md-4">
                    <div class="col-md-4" style="padding-bottom:10px">
                        <label class="col-md-4 checkbox-container">
                            <input id="ctk_pesanan" type="checkbox" class="cbx" name="cbx-pesanan-only" />
                            <span id="ctk_pesanan" class="checkmark"></span>
                        </label>
                        <div class="col-md-8" style="padding-top: 7px;">
                            @Html.Label("", "Pesanan")
                        </div>
                    </div>

                    <div class="col-md-4" style="padding-bottom:10px">
                        <label class="col-md-4 checkbox-container">
                            <input id="ctk_faktur" type="checkbox" class="cbx" name="cbx-faktur-only" />
                            <span id="ctk_faktur" class="checkmark"></span>
                        </label>
                        <div class="col-md-8" style="padding-top: 7px;">
                            @Html.Label("", "Faktur")
                        </div>
                        @*<div class="col-md-1" style="padding-top: 7px;">
                Faktur
            </div>*@
                    </div>

                    <div class="col-md-4" style="padding-bottom:10px">
                        <label class="col-md-4 checkbox-container">
                            <input id="ctk_retur" type="checkbox" class="cbx" name="cbx-retur-only" />
                            <span id="ctk_retur" class="checkmark"></span>
                        </label>
                        <div class="col-md-8" style="padding-top: 7px;">
                            @Html.Label("", "Retur")
                        </div>
                    </div>
                    @*<div class="col-md-1" style="padding-top: 7px;">
            Retur
        </div>*@
                </div>
                @*<div class="col-md-1"></div>*@
                <div class="col-md-1" style="padding-top: 7px;">
                    @Html.Label("", "Periode :")
                </div>
                <div class="col-md-3">
                    <div class="input-group text">
                        <select class="form-control" id="periode" name="periode" required="required">
                            <option value="1">Mingguan</option>
                            <option value="2">Bulanan</option>
                            <option value="3">Tahunan</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4"></div>
            </div>
            <div class="col-md-12" id="grafik-line-section">
                @*<canvas id="chartMingguan" height="400"></canvas>*@
                @*<canvas id="chart-mingguan" height="200"></canvas>*@
                @*@Html.Partial("TableDashboardLinePartial")*@
            </div>
        </div>
        @*//end add by nurul 12/7/2019*@
        @*<div class="col-md-6" id="chart-jumlah-per-market-section">
                <h4>Grafik Pesanan Per Market Berdasarkan Jumlah</h4>
                <canvas id="chart-jumlah-per-market" height="200"></canvas>
            </div>
            <div class="col-md-6" id="chart-nilai-per-market-section">
                <h4>Grafik Pesanan Per Market Berdasarkan Nilai</h4>
                <canvas id="chart-nilai-per-market" height="200"></canvas>
            </div>*@
    </div>
</div>

<div id="dashboard_partial">
    <div id="dashboard_page"></div>
    <div class="row pricing_page" style="display: none;">
        <div class="col-lg-12">
            <div class="page-editor">
                <h2 class="editor-title">Subscription</h2>
                <span class="title-accent"></span>
                <button id="close-editor-1" type="button" class="pull-right page-close">
                    <span class="close-btn thick"></span>
                </button>
                <div class="form-horizontal" id="form_subs">
                    @Html.Partial("PricingNewPartialView", Model?.ListSubs)
                </div>
            </div>
        </div>
    </div>
</div>
@*//add by nurul 21/2/2019*@
<div class="modal fade" id="modalPricing" tabindex="-1" role="dialog" aria-labelledby="pricingLabel">
    <div class="modal-dialog" id="modal-pricing" role="document">
        <div class="modal-content">
            @Html.Partial("PricingNewPartialView", Model?.ListSubs)
        </div>
    </div>
</div>
@*//add by nurul 21/2/2019*@

@section scripts
{
    <script src="~/Scripts/jquery-1.7.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js" type="text/javascript"></script>
    <script src="~/Content/vendors/moment/min/moment.min.js" type="text/javascript"></script>
    <script src="~/Content/build/js/bootstrap-datepicker.min.js" type="text/javascript"></script>

    @*<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.bundle.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.bundle.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js" type="text/javascript"></script>*@

    <script type="text/javascript" src="//gyrocode.github.io/jquery-datatables-checkboxes/1.2.11/js/dataTables.checkboxes.min.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/Chart.min.js"></script>
    <script src="js/line.js"></script>

    @*//add by nurul 22/2/2019*@
    @*<script type="text/javascript" src="https://app.sandbox.midtrans.com/snap/snap.js" data-client-key="SB-Mid-client-AyzcvZKcwAlD_0QY"></script>*@
    <script type="text/javascript" src="https://app.midtrans.com/snap/snap.js" data-client-key="Mid-client-sMzViq24qWRlPdPu"></script>
    @*SB-Mid-client-AyzcvZKcwAlD_0QY__Mid-client-sMzViq24qWRlPdPu*@
    @*//end add by nurul 22/2/2019*@
    <script type="text/javascript">
        //var $tipeTampilan = 0;
        var $tipeTampilan = 1;
        var $tipeStyle = 1;

        var $href = "";

        $(document).ready(function () {
            getTanggal();            
            $('#TGL').datepicker('setDate', '0');
            //getDashboard();

            //add by nurul 22/7/2019
            $('#ctk_pesanan').prop('checked', true);
            $('#ctk_faktur').prop('checked', true);
            $('#ctk_retur').prop('checked', true);
            //end add by nurul 22/7/2019

            $('#close-editor-1').on('click',
                function () {
                    $('#top_dashboard').show();
                    $('#dashboard_page').show();
                    $('.pricing_page').hide();
                });
            
            //add by nurul 22/2/2019
            $href = window.location.href.split('home')[1];
            if ($href != "") {
                var link = '@Url.Action("CekJumlahPesananBulanIni", "Manage", new {accId = "replaceUname"})';
                link = link.replace("replaceUname", '@(accId)');

                $.ajax({
                    type: "GET",
                    url: link,
                    success: function (res) {
                        $jumlahPesananMax = res.JumlahPesananMax;
                        $jumlahPesananBulanIni = res.JumlahPesananBulanIni;

                        if ($jumlahPesananBulanIni >= $jumlahPesananMax) {
                            //$('#modalPricing').modal('show');
                            $('#top_dashboard').hide();
                            $('#dashboard_page').hide();
                            $('.pricing_page').show();
                            showSubsMenu(1);

                        } else if (res.SudahSampaiBatasTanggal) {
                            //$('#modalPricing').modal('show');
                            $('#top_dashboard').hide();
                            $('#dashboard_page').hide();
                            $('.pricing_page').show();
                            showSubsMenu(2);

                        } else {
                            //$('#modalPricing').modal('hide');
                            $('#top_dashboard').show();
                            $('#dashboard_page').show();
                            $('.pricing_page').hide();
                        }
                    },
                    error: function (xhr, status, error) {
                        console.log(error);
                    }
                });
            }
            //add 09-10-2018, function button di subscription
            $('.btn-subs').click(function () {

                var $this = $(this);
                var $kodeSubs = $this.attr('data-plan-btn');
                var $bulanPilihan = parseInt($this.attr('data-kali'));
                var $harga = parseInt($('#subs-price-' + $kodeSubs).attr('data-harga'));
                var $pilihan = "";

                $('#plan-' + $kodeSubs + ' .btn-section .btn').removeClass('subs_active');
                $this.addClass('subs_active');

                if ($bulanPilihan == 3) {
                    $pilihan = "Paket 3 Bulan";
                } else if ($bulanPilihan == 5) {
                    $pilihan = "Paket 6 Bulan";
                } else if ($bulanPilihan == 10) {
                    $pilihan = "Paket 12 Bulan";
                }

                $('#selected-package-' + $kodeSubs).text($pilihan);
                $('#price-total-' + $kodeSubs).text(convertToRupiah($harga * $bulanPilihan));
            });
            //end add 09-10-2018, function button di subscription
            //add by nurul 22/2/2019
        });

        //add by nurul 22/2/2019
        function showSubsMenu(type) {
            $('#divSubs').hide();
            if (type == 1) {
                $('#divSubsExpand').show();
                $('#divSubExpired').hide();
            }
            else if (type == 2) {
                $('#divSubsExpand').hide();
                $('#divSubExpired').show();
            }

        }
        //end add by nurul 22/2/2019

        function changeMode(tipe) {
            if (tipe === 0) {
                $('#mode').text('Grafik');
                $('.chart-mode').show();
                $('.angka-mode').hide();
                $tipeTampilan = 0;
            } else {
                //$('#mode').text('Angka');
                $('#mode').text('Tabel');
                $('.chart-mode').hide();
                $('.angka-mode').show();
                $tipeTampilan = 1;
            }
        }

        function getChart1() {
            $('#chart-jumlah').remove();
            $('#chart-nilai').remove();
            $('#chart-jumlah-per-market').remove();
            $('#chart-nilai-per-market').remove();
            $('#chart-jumlah-section').append('<canvas id="chart-jumlah" height="200"></canvas>');
            $('#chart-nilai-section').append('<canvas id="chart-nilai" height="200"></canvas>');
            $('#chart-jumlah-per-market-section').append('<canvas id="chart-jumlah-per-market" height="200"></canvas>');
            $('#chart-nilai-per-market-section').append('</canvas><canvas id="chart-nilai-per-market" height="200"></canvas>');

            $.ajax({
                type: "POST",
                url: '/api/chart',
                headers: {
                    'X-API-KEY':'M@STERONLINE4P1K3Y',
                    'Content-Type':'application/json'
                },
                data: JSON.stringify({
                    AccId: @accId,
                    SelDate: $('#TGL').val()
                }),
                contentType: "application/json; charset=UTF-8",
                cache: false,
                success: function (response) {
                    var arrayData = [
                        response.data.JumlahPesananHariIni, response.data.JumlahFakturHariIni,
                        response.data.JumlahReturHariIni,
                        response.data.JumlahPesananBulanIni, response.data.JumlahFakturBulanIni,
                        response.data.JumlahReturBulanIni
                    ];

                    var max = Math.max.apply(Math, arrayData);
                    var maxTicksBasic = Math.ceil(max / 10) * 10;

                    var steppingBasic = (Math.ceil(max / 10) * 10) / 5;

                    var ctx = document.getElementById("chart-jumlah").getContext('2d');
                    var chartJumlah = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ["Pesanan", "Faktur", "Retur"],
                            datasets: [{
                                label: 'Hari Ini',
                                data: [response.data.JumlahPesananHariIni, response.data.JumlahFakturHariIni, response.data.JumlahReturHariIni],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.2)',
                                    'rgba(54, 162, 235, 0.2)',
                                    'rgba(255, 206, 86, 0.2)',
                                ],
                                borderColor: [
                                    'rgba(255,99,132,1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                ],
                                borderWidth: 1
                            },
                                {
                                    label: 'Bulan Ini',
                                    data: [response.data.JumlahPesananBulanIni, response.data.JumlahFakturBulanIni, response.data.JumlahReturBulanIni],
                                    backgroundColor: [
                                        'rgba(255, 99, 132, 0.2)',
                                        'rgba(54, 162, 235, 0.2)',
                                        'rgba(255, 206, 86, 0.2)',
                                    ],
                                    borderColor: [
                                        'rgba(255,99,132,1)',
                                        'rgba(54, 162, 235, 1)',
                                        'rgba(255, 206, 86, 1)',
                                    ],
                                    borderWidth: 1
                                }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true,
                                        stepSize: steppingBasic,
                                        max: maxTicksBasic
                                    }
                                }],

                            }
                        }
                    });

                    var dividerValueBasic = 10;
                    var arrayDataValueBasic = [
                        response.data.NilaiPesananHariIni,
                        response.data.NilaiFakturHariIni,
                        response.data.NilaiReturHariIni,
                        response.data.NilaiPesananBulanIni,
                        response.data.NilaiFakturBulanIni,
                        response.data.NilaiReturBulanIni
                    ];

                    var maxValueBasic = Math.max.apply(Math, arrayDataValueBasic);

                    if (maxValueBasic > 100 && maxValueBasic <= 1000) {
                        dividerValueBasic = 100;
                    } else if (maxValueBasic > 1000 && maxValueBasic <= 10000) {
                        dividerValueBasic = 1000;
                    } else if (maxValueBasic > 10000 && maxValueBasic <= 100000) {
                        dividerValueBasic = 10000;
                    } else if (maxValueBasic > 100000 && maxValueBasic <= 1000000) {
                        dividerValueBasic = 100000;
                    } else if (maxValueBasic > 1000000 && maxValueBasic <= 10000000) {
                        dividerValueBasic = 1000000;
                    } else if (maxValueBasic > 10000000 && maxValueBasic <= 100000000) {
                        dividerValueBasic = 10000000;
                    } else if (maxValueBasic > 100000000 && maxValueBasic <= 1000000000) {
                        dividerValueBasic = 100000000;
                    } else if (maxValueBasic > 1000000000 && maxValueBasic <= 10000000000) {
                        dividerValueBasic = 1000000000;
                    } else if (maxValueBasic > 10000000000 && maxValueBasic <= 100000000000) {
                        dividerValueBasic = 10000000000;
                    }

                    var roundValueBasic = Math.round(maxValueBasic / dividerValueBasic) * dividerValueBasic;
                    var steppingValueBasic = roundValueBasic / 5;

                    var maxTicksValueBasic = roundValueBasic + dividerValueBasic;

                    var ctxNilai = document.getElementById("chart-nilai").getContext('2d');
                    var chartNilai = new Chart(ctxNilai, {
                        type: 'bar',
                        showTooltips: false,
                        data: {
                            labels: ["Pesanan", "Faktur", "Retur"],
                            datasets: [{
                                label: 'Hari Ini',
                                data: [response.data.NilaiPesananHariIni, response.data.NilaiFakturHariIni, response.data.NilaiReturHariIni],
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.2)',
                                    'rgba(54, 162, 235, 0.2)',
                                    'rgba(255, 206, 86, 0.2)',
                                ],
                                borderColor: [
                                    'rgba(255,99,132,1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                ],
                                borderWidth: 1
                            },
                                {
                                    label: 'Bulan Ini',
                                    data: [response.data.NilaiPesananBulanIni, response.data.NilaiFakturBulanIni, response.data.NilaiReturBulanIni],
                                    backgroundColor: [
                                        'rgba(255, 99, 132, 0.2)',
                                        'rgba(54, 162, 235, 0.2)',
                                        'rgba(255, 206, 86, 0.2)',
                                    ],
                                    borderColor: [
                                        'rgba(255,99,132,1)',
                                        'rgba(54, 162, 235, 1)',
                                        'rgba(255, 206, 86, 1)',
                                    ],
                                    borderWidth: 1
                                }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true,
                                        stepSize: steppingValueBasic,
                                        max: maxTicksValueBasic,
                                        userCallback: function(value, index, values) {
                                            value = value.toString();
                                            value = value.split(/(?=(?:...)*$)/);
                                            value = value.join('.');
                                            return 'Rp ' + value;
                                        }
                                    }
                                }]
                            },
                            tooltips: {
                                callbacks: {
                                    label: (tooltipItem, data) => {
                                        return data.datasets[tooltipItem.datasetIndex].label + ": Rp " + convertToRupiah(tooltipItem.yLabel);
                                    },
                                },
                            }
                        }
                    });

                    var akunMarketPlace = [];
                    var jumlahPesananHariIniPerMarket = [];
                    var jumlahPesananBulanIniPerMarket = [];
                    var nilaiPesananHariIniPerMarket = [];
                    var nilaiPesananBulanIniPerMarket = [];

                    for (var i = 0; i < response.data.ListPesananPerMarketplace.length; i++) {
                        akunMarketPlace.push(response.data.ListPesananPerMarketplace[i].NamaMarket);
                        jumlahPesananHariIniPerMarket.push(response.data.ListPesananPerMarketplace[i].JumlahPesananHariIni);
                        jumlahPesananBulanIniPerMarket.push(response.data.ListPesananPerMarketplace[i].JumlahPesananBulanIni);
                        nilaiPesananHariIniPerMarket.push(convertToAngka(response.data.ListPesananPerMarketplace[i].NilaiPesananHariIni));
                        nilaiPesananBulanIniPerMarket.push(convertToAngka(response.data.ListPesananPerMarketplace[i].NilaiPesananBulanIni));
                    }

                    var maxJumlahPesananHariIni = Math.max.apply(Math, jumlahPesananHariIniPerMarket);
                    var maxJumlahPesananBulanIni = Math.max.apply(Math, jumlahPesananBulanIniPerMarket);
                    var dataMaxJumlah = [maxJumlahPesananHariIni, maxJumlahPesananBulanIni];
                    var maxJumlahByMarket = Math.max.apply(Math, dataMaxJumlah);

                    var maxTicksByMarket = Math.ceil(maxJumlahByMarket / 10) * 10;

                    var steppingByMarket = (Math.ceil(maxJumlahByMarket / 10) * 10) / 5;

                    var ctxJumlahPerMarket = document.getElementById("chart-jumlah-per-market").getContext('2d');
                    var chartJumlahPerMarket = new Chart(ctxJumlahPerMarket, {
                        type: 'bar',
                        data: {
                            labels: akunMarketPlace,
                            datasets: [{
                                label: 'Hari Ini',
                                data: jumlahPesananHariIniPerMarket,
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.2)',
                                    'rgba(54, 162, 235, 0.2)',
                                    'rgba(255, 206, 86, 0.2)',
                                ],
                                borderColor: [
                                    'rgba(255,99,132,1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                ],
                                borderWidth: 1
                            },
                                {
                                    label: 'Bulan Ini',
                                    data: jumlahPesananBulanIniPerMarket,
                                    backgroundColor: [
                                        'rgba(255, 99, 132, 0.2)',
                                        'rgba(54, 162, 235, 0.2)',
                                        'rgba(255, 206, 86, 0.2)',
                                    ],
                                    borderColor: [
                                        'rgba(255,99,132,1)',
                                        'rgba(54, 162, 235, 1)',
                                        'rgba(255, 206, 86, 1)',
                                    ],
                                    borderWidth: 1
                                }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true,
                                        stepSize: steppingByMarket,
                                        max: maxTicksByMarket
                                    }
                                }],

                            }
                        }
                    });

                    var dividerValueByMarket = 10;
                    var maxNilaiPesananHariIni = Math.max.apply(Math, nilaiPesananHariIniPerMarket);
                    var maxNilaiPesananBulanIni = Math.max.apply(Math, nilaiPesananBulanIniPerMarket);
                    var dataMaxValueByMarket = [maxNilaiPesananHariIni, maxNilaiPesananBulanIni];
                    var maxValueByMarket = Math.max.apply(Math, dataMaxValueByMarket);

                    if (maxValueByMarket > 100 && maxValueByMarket <= 1000) {
                        dividerValueByMarket = 100;
                    } else if (maxValueByMarket > 1000 && maxValueByMarket <= 10000) {
                        dividerValueByMarket = 1000;
                    } else if (maxValueByMarket > 10000 && maxValueByMarket <= 100000) {
                        dividerValueByMarket = 10000;
                    } else if (maxValueByMarket > 100000 && maxValueByMarket <= 1000000) {
                        dividerValueByMarket = 100000;
                    } else if (maxValueByMarket > 1000000 && maxValueByMarket <= 10000000) {
                        dividerValueByMarket = 1000000;
                    } else if (maxValueByMarket > 10000000 && maxValueByMarket <= 100000000) {
                        dividerValueByMarket = 10000000;
                    } else if (maxValueByMarket > 100000000 && maxValueByMarket <= 1000000000) {
                        dividerValueByMarket = 100000000;
                    } else if (maxValueByMarket > 1000000000 && maxValueByMarket <= 10000000000) {
                        dividerValueByMarket = 1000000000;
                    } else if (maxValueByMarket > 10000000000 && maxValueByMarket <= 100000000000) {
                        dividerValueByMarket = 10000000000;
                    }

                    var roundValueByMarket = Math.round(maxValueByMarket / dividerValueByMarket) * dividerValueByMarket;
                    var steppingValueByMarket = roundValueByMarket / 5;

                    var maxTicksValueByMarket = roundValueByMarket + dividerValueByMarket;

                    var ctxNilaiPerMarket = document.getElementById("chart-nilai-per-market").getContext('2d');
                    var chartNilaiPerMarket = new Chart(ctxNilaiPerMarket, {
                        type: 'bar',
                        showTooltips: false,
                        data: {
                            labels: akunMarketPlace,
                            datasets: [{
                                label: 'Hari Ini',
                                data: nilaiPesananHariIniPerMarket,
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.2)',
                                    'rgba(54, 162, 235, 0.2)',
                                    'rgba(255, 206, 86, 0.2)',
                                ],
                                borderColor: [
                                    'rgba(255,99,132,1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                ],
                                borderWidth: 1
                            },
                                {
                                    label: 'Bulan Ini',
                                    data: nilaiPesananBulanIniPerMarket,
                                    backgroundColor: [
                                        'rgba(255, 99, 132, 0.2)',
                                        'rgba(54, 162, 235, 0.2)',
                                        'rgba(255, 206, 86, 0.2)',
                                    ],
                                    borderColor: [
                                        'rgba(255,99,132,1)',
                                        'rgba(54, 162, 235, 1)',
                                        'rgba(255, 206, 86, 1)',
                                    ],
                                    borderWidth: 1
                                }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true,
                                        stepSize: steppingValueByMarket,
                                        max: maxTicksValueByMarket,
                                        userCallback: function (value, index, values) {
                                            value = value.toString();
                                            value = value.split(/(?=(?:...)*$)/);
                                            value = value.join('.');
                                            return 'Rp ' + value;
                                        }
                                    }
                                }]
                            },
                            tooltips: {
                                callbacks: {
                                    label: (tooltipItem, data) => {
                                        return data.datasets[tooltipItem.datasetIndex].label + ": Rp " + convertToRupiah(tooltipItem.yLabel);
                                    },
                                },
                            }
                        }
                    });
                },
                error: function(errMsg) {
                    console.log(errMsg);
                },
            });
        }

        function convertToRupiah(angka) {
            return $.number(angka, 2, ',', '.');
        }

        function convertToAngka(rupiah) {
            if (rupiah == '') {
                rupiah = '0';
            }
            return parseInt(rupiah.replace(/,.*|[^0-9]/g, ''), 10);
        }

        function getDashboard($selectedDate = '') {
            var $selectedMonth = $selectedDate.substring(3, 5);
            var monthVal = moment(new Date()).locale('id').format("MM");
            var monthName = moment($selectedMonth).locale('id').format("MMMM");

            var link = '@Url.Action("DashboardPartial", "Manage", new { selDate = "replaceDate" })';
            link = link.replace("replaceDate", $selectedDate);

            $.ajax({
                type: "GET",
                url: link,
                beforeSend: function () {
                    $('#loading_spinner').show();
                },
                success: function (response) {
                    $('#dashboard_page').html(response);

                    if ($selectedDate !== '' && $selectedDate !== moment(new Date()).format("DD/MM/YYYY")) {
                        $('.date_label').text('Tanggal ' + $selectedDate);
                    }

                    if ($selectedMonth !== '' && $selectedMonth !== monthVal) {
                        $('.month_label').text('Bulan ' + monthName);
                    }
                  
                    if ($tipeTampilan == 0) {
                        $('.chart-mode').show();
                        $('.angka-mode').hide();
                    }
                    else {
                        $('.chart-mode').hide();
                        $('.angka-mode').show();
                    }
                    //if ($tipeTampilan == 0)
                    //{
                    //    $('#mode').text('Grafik');
                    //    $('.chart-mode').show();
                    //    $('.angka-mode').hide();
                    //    $tipeTampilan = 0;
                    //}
                    //else
                    //{
                    //    $('#mode').text('Angka');
                    //    $('.chart-mode').hide();
                    //    $('.angka-mode').show();
                    //    $tipeTampilan = 1;
                    //}
                  
                    //add by nurul 4/7/2019
                    //region 10 barang laku
                    var d = new Date();
                    d.setMonth(d.getMonth() - 3);
                    $('#DrTanggal').datepicker({
                        format: 'dd/mm/yyyy',
                        language: 'id'
                    }).datepicker('setDate', d);
                    $('#DrTanggal').datepicker({
                        format: 'dd/mm/yyyy',
                        language: 'id'
                    }).change(function () {
                        $('#DrTanggal').val($('#DrTanggal').val());
                        $('#DrTanggal').datepicker('hide');
                        RefreshTableDashboardBaranglakuPartial();
                    });
                    $('#SdTanggal').datepicker({
                        format: 'dd/mm/yyyy',
                        language: 'id'
                    }).datepicker('setDate', '0');
                    $('#SdTanggal').datepicker({
                        format: 'dd/mm/yyyy',
                        language: 'id'
                    }).change(function () {
                        $('#SdTanggal').val($('#SdTanggal').val());
                        $('#SdTanggal').datepicker('hide');
                        RefreshTableDashboardBaranglakuPartial();
                    });
                    RefreshTableDashboardBaranglakuPartial();
                    //end region 10 barang laku
                    //region faktur
                    var c = new Date();
                    c.setMonth(c.getMonth() - 1);
                    $('#DrTanggal1').datepicker({
                        format: 'dd/mm/yyyy',
                        language: 'id'
                    }).datepicker('setDate', c);
                    $('#DrTanggal1').datepicker({
                        format: 'dd/mm/yyyy',
                        language: 'id'
                    }).change(function () {
                        $('#DrTanggal1').val($('#DrTanggal1').val());
                        $('#DrTanggal1').datepicker('hide');
                        RefreshTableDashboardFaktur();
                    });
                    $('#SdTanggal1').datepicker({
                        format: 'dd/mm/yyyy',
                        language: 'id'
                    }).datepicker('setDate', '0');
                    $('#SdTanggal1').datepicker({
                        format: 'dd/mm/yyyy',
                        language: 'id'
                    }).change(function () {
                        $('#SdTanggal1').val($('#SdTanggal1').val());
                        $('#SdTanggal1').datepicker('hide');
                        RefreshTableDashboardFaktur();
                        });
                    RefreshTableDashboardFaktur();
                    //end region faktur
                    //end add by nurul 4/7/2019

                    $('#loading_spinner').hide();
                },
                error: function (xhr, status, error) {
                    console.log(error);
                }
            });
        }

            function getTanggal() {
                $('#TGL').datepicker({
                    format: 'dd/mm/yyyy',
                    language: 'id'
                }).change(function () {
                    getDashboard($(this).val());
                    getChart();
                    $(this).datepicker('hide');
                });
            }

            //add by nurul 22/2/2019

            function changeUser(val) {
                if (val == -1 && $('#txtJmlUser')[0].innerText == 5) {
                    return;
                }
                var currentUser = parseInt($('#txtJmlUser')[0].innerText);
                var cost = convertToAngka($('#lbl_0_03')[0].innerText);
                var newCost = cost + (100000 * val);
                $('#txtJmlUser')[0].innerText = currentUser + val;
                $('#lbl_0_03')[0].innerText = convertToRupiah(newCost);
                $('#btnPay_3_03')[0].innerText = 'Rp ' + convertToRupiah(newCost * 3) + '\n per 3 bulan';
                $('#btnPay_12_03')[0].innerText = 'Rp ' + convertToRupiah(newCost * 10) + '\n per 12 bulan';

            }

            //add by Tri, call midtrans api get token
            function setBln(kode, bln) {
                switch (kode){
                    case "01":
                        break;
                    case "02":
                        txtBln_02.value = bln;
                        break;
                    case "03":
                        txtBln_03.value = bln;
                        break;
                }
            }

            function clickSub(kode, bln) {
                if ($('#ckBox')[0].checked) {
                    //var bln = 0;
                    //switch (kode) {
                    //    case "01":
                    //        break;
                    //    case "02":
                    //        bln = txtBln_02.value;
                    //        break;
                    //    case "03":
                    //        bln = txtBln_03.value;
                    //        break;
                    //}
                    @{
                //var accountId = dataSession?.Account?.AccountId; 'change by nurul 4/2/2019
                var accountId = new long();
                if (dataSession?.Account != null)
                {
                    accountId = dataSession.Account.AccountId;
                }
                else if (dataSession?.User != null)
                {
                    accountId = context.Account.SingleOrDefault(a => a.AccountId == dataSession.User.AccountId).AccountId;
                }
                //end change by nurul 4/2/2019
                var account = context.Account.Where(p => p.AccountId == accountId).SingleOrDefault();
            }
                    //moment.locale('id');
                    var tglSubThn = @account.TGL_SUBSCRIPTION.Value.Year;
                    var tglSubBln = @account.TGL_SUBSCRIPTION.Value.Month;
                    var tglSubHari = @account.TGL_SUBSCRIPTION.Value.Day;
                    var tglSub = new Date(tglSubThn, parseInt(tglSubBln) - 1, tglSubHari);
                    //var tglSub2 = moment(tglSubThn + '-' + tglSubBln + '-' + tglSubHari, 'yyyy-MM-dd');
                    $('#txtCode').val(kode);
                    $('#txtBulan').val(bln);

                    if ('@account.KODE_SUBSCRIPTION' != '01' && tglSub >= Date.today()) {

                        //tglSub.setMonth(tglSub.getMonth() + bln);
                        var msg = "Masa berlangganan anda s/d " + tglSub.format("d-M-Y") + "\nApakah Anda ingin melakukan perpanjangan s/d : " + tglSub.addMonths(bln).format("d-M-Y") + "?";
                        if (confirm(msg)) {
                            //alert('kode:' + kode + '\nbln:' + bln);
                            @*var link = '@Url.Action("PaymentMidtrans", "Midtrans", new { code = "replaceCode", bulan = "replaceBulan" })';
                link = link.replace("replaceCode", kode);
                link = link.replace("replaceBulan", String(bln));*@
                            @*var link = '@Url.Action("PaymentMidtrans", "Midtrans")';
                        link += '?code=' + kode + '&bulan=' + bln + '&accId=0';

                        $.ajax({
                            type: "GET",
                            url: link,
                            success: function (response) {
                                if (response != null) {
                                    //window.location = response.urlView;
                                    if (response.error == null) {
                                        snap.pay(response.token, { skipOrderSummary: true });
                                    } else {
                                        alert(response.error);
                                    }
                                }
                                //window.open(response, "_self");
                                //window.location.href(response);

                            },
                            error: function (xhr, status, error) {
                                console.log(error);
                            }
                        });*@
                            $('#modalTransfer').modal('show');
                        }
                    }
                    else {
                        @*var link = '@Url.Action("PaymentMidtrans", "Midtrans")';
                    link += '?code=' + kode + '&bulan=' + bln + '&accId=0';

                    $.ajax({
                        type: "GET",
                        url: link,
                        success: function (response) {
                            if (response.error == null) {
                                snap.pay(response.token, { skipOrderSummary: true });
                            } else {
                                alert(response.error);
                            }
                            //window.open(response, "_self");
                            //window.location.href(response);

                        },
                        error: function (xhr, status, error) {
                            console.log(error);
                        }
                    });*@
                        $('#modalTransfer').modal('show');
                    }
                } else {
                    alert('Anda harus menyetujui Syarat & Ketentuan');
                }
            }
            //end add by Tri, call midtrans api get token
            //end add by nurul 22/2/2019
            function snapMidtrans(kode, bln) {
                var link = '@Url.Action("PaymentMidtrans", "Midtrans")';
                link += '?code=' + kode + '&bulan=' + bln + '&accId=0' + '&accCount=' + $('#txtJmlUser')[0].innerText;

                $.ajax({
                    type: "GET",
                    url: link,
                    success: function (response) {
                        if (response != null) {
                            //window.location = response.urlView;
                            if (response.error == null) {
                                snap.pay(response.token, { skipOrderSummary: true });
                                $('#modalTransfer').modal('hide');
                            } else {
                                alert(response.error);
                                $('#modalTransfer').modal('hide');
                            }
                        }
                        //window.open(response, "_self");
                        //window.location.href(response);

                    },
                    error: function (xhr, status, error) {
                        console.log(error);
                        $('#modalTransfer').modal('hide');
                    }
                });
        }

        //add by nurul 12/7/2019
        function getChart() {
            var $tgl = "";
            if ($('#TGL').val() != undefined) {
                $tgl = $('#TGL').val();
            }
            var link = '@Html.Raw(Url.Action("RefreshDashboardLine", "Manage", new { tgl = "replaceTgl" }))';
            link = link.replace("replaceTgl", $tgl);
            $.ajax({
                type: "POST",
                url: link,
                contentType: "application/json; charset=UTF-8",
                beforeSend: function () {
                    $('#grafik-line-section').hide();
                    //$('#loading_dashboard_faktur').show();
                },
                success: function (response) {
                    $('#grafik-line-section').html(response);
                    //if (listPieFaktur.length > 0) {
                    //#region allMingguan
                    var listDataPesananM = listPesananMingguan;
                    var listDataFakturM = listFakturMingguan;
                    var listDataReturM = listReturMingguan;

                    var labelpesananMingguan = [];
                    var labelfakturMingguan = [];
                    var labelreturMingguan = [];
                    var jumlahpesananMingguan = [];
                    var jumlahfakturMingguan = [];
                    var jumlahreturMingguan = [];
                    var nilaipesananMingguan = [];
                    var nilaifakturMingguan = [];
                    var nilaireturMingguan = [];

                    for (var i = 0; i < listDataPesananM.length; i++) {
                        labelpesananMingguan.push(listDataPesananM[i].No);
                        jumlahpesananMingguan.push(listDataPesananM[i].Jumlah);
                        nilaipesananMingguan.push(listDataPesananM[i].Nilai);
                    }
                    for (var i = 0; i < listDataFakturM.length; i++) {
                        jumlahfakturMingguan.push(listDataFakturM[i].Jumlah);
                        nilaifakturMingguan.push(listDataFakturM[i].Nilai);
                    }
                    for (var i = 0; i < listDataReturM.length; i++) {
                        jumlahreturMingguan.push(listDataReturM[i].Jumlah);
                        nilaireturMingguan.push(listDataReturM[i].Nilai);
                    }
                    
                    var maxJumlahPesananMingguan = Math.max.apply(Math, jumlahpesananMingguan);
                    var maxJumlahFakturMingguan = Math.max.apply(Math, jumlahfakturMingguan);
                    var maxJumlahReturMingguan = Math.max.apply(Math, jumlahreturMingguan);
                    var dataMaxJumlah = [maxJumlahPesananMingguan, maxJumlahFakturMingguan, maxJumlahReturMingguan];
                    var maxJumlah = Math.max.apply(Math, dataMaxJumlah);

                    var maxTicksBasic = Math.ceil(maxJumlah / 10) * 10;

                    var steppingBasic = (Math.ceil(maxJumlah / 10) * 10) / 5;

                    var ctxAllMingguan = document.getElementById("chartMingguan").getContext('2d');

                    var dataAllMingguan = {
                        labels: labelpesananMingguan,
                        datasets: [
                            {
                                label: "Pesanan",
                                data: jumlahpesananMingguan,
                                data1: nilaireturMingguan,
                                borderColor: "#f3545d",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#f3545d",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 5,
                                radius: 5,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            },
                            {
                                label: "Faktur",
                                data: jumlahfakturMingguan,
                                data1: nilaifakturMingguan,
                                borderColor: "#1d7af3",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#1d7af3",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 5,
                                radius: 5,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            },
                            {
                                label: "Retur",
                                data: jumlahreturMingguan,
                                data1: nilaireturMingguan,
                                borderColor: "#59d05d",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#59d05d",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 4,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            }
                        ]
                        };

            //options
            var optionsAllMingguan = {
                responsive: true,
                title: {
                    display: true,
                    position: "top",
                    text: "Pesanan, Faktur, dan Retur Mingguan",
                    fontSize: 18,
                    fontColor: "#111"
                },
                scales: {
                    yAxes: [{
                        ticks: {
                            max: maxTicksBasic,
                            min: -5,
                            stepSize: steppingBasic
                        }
                    }]
                },
                legendCallback: function (chart) {
                                    var text = [];
                                    text.push('<ul class="' + chart.id + '-legend" style="list-style:none">');
                                    for (var i = 0; i < chart.data.datasets.length; i++) {
                                        if (chart.data.datasets[i].label) {
                                            text.push(' <div style="width:10px;height:10px;display:inline-block;background:' + chart.data.datasets[i].borderColor + '" />&nbsp;');
                                            text.push(chart.data.datasets[i].label);
                                            text.join(' ');
                                        }
                                    }
                                    text.push('</ul>');

                                    return text.join('');
                },
                legend: { display: false },
                tooltips: {
                                    callbacks: {
                                        label: function (tooltipItem, data) {
                                            var dataset = data.datasets[tooltipItem.datasetIndex];
                                            var meta = dataset._meta[Object.keys(dataset._meta)[0]];
                                            var total = meta.total;
                                            var currentValue = dataset.label;
                                            var label = dataset.data[tooltipItem.index]
                                            var nilai = dataset.data1[tooltipItem.index]
                                            var percentage = parseFloat((nilai / total * 100).toFixed(1));
                                            return currentValue + ': ' + label;
                                        },
                                        //afterLabel: function (tooltipItem, data) {
                                        //    var dataset = data.datasets[tooltipItem.datasetIndex];
                                        //    var nilai = dataset.data[tooltipItem.index]
                                        //    return 'Rp. ' + convertToRupiah(nilai);
                                        //},
                                        title: function (tooltipItem, data) {
                                            return data.labels[tooltipItem[0].index];
                                        }
                                    },
                                    backgroundColor: '#FFF',
                                    titleFontColor: '#0066ff',
                                    bodyFontColor: '#000'
                }
            };

            //create Chart class object
            var chartAllMingguan = new Chart(ctxAllMingguan, {
                type: "line",
                data: dataAllMingguan,
                options: optionsAllMingguan
            });

                    $("#MingguanLegend").html(chartAllMingguan.generateLegend());

                    //#end region allMingguan

                    //#region allTahunan
                    var listDataPesananT = listPesananTahunan;
                    var listDataFakturT = listFakturTahunan;
                    var listDataReturT = listReturTahunan;

                    var labelpesanan = [];
                    var labelfaktur = [];
                    var labelretur = [];
                    var jumlahpesanan = [];
                    var jumlahfaktur = [];
                    var jumlahretur = [];
                    var nilaipesanan = [];
                    var nilaifaktur = [];
                    var nilairetur = [];

                    for (var i = 0; i < listDataPesananT.length; i++) {
                        labelpesanan.push(listDataPesananT[i].No);
                        jumlahpesanan.push(listDataPesananT[i].Jumlah);
                        nilaipesanan.push(listDataPesananT[i].Nilai);
                    }
                    for (var i = 0; i < listDataFakturT.length; i++) {
                        jumlahfaktur.push(listDataFakturT[i].Jumlah);
                        nilaifaktur.push(listDataFakturT[i].Nilai);
                    }
                    for (var i = 0; i < listDataReturT.length; i++) {
                        jumlahretur.push(listDataReturT[i].Jumlah);
                        nilairetur.push(listDataReturT[i].Nilai);
                    }

                    var maxJumlahPesanan = Math.max.apply(Math, jumlahpesanan);
                    var maxJumlahFaktur = Math.max.apply(Math, jumlahfaktur);
                    var maxJumlahRetur = Math.max.apply(Math, jumlahretur);
                    var dataMaxJumlah = [maxJumlahPesanan, maxJumlahFaktur, maxJumlahRetur];
                    var maxJumlah = Math.max.apply(Math, dataMaxJumlah);

                    var maxTicksBasic = Math.ceil(maxJumlah / 10) * 10;

                    var steppingBasic = (Math.ceil(maxJumlah / 10) * 10) / 5;

                    var ctxTahunan = document.getElementById("chartTahunan").getContext('2d');

                    var dataTahunan = {
                        labels: labelpesanan,
                        datasets: [
                            {
                                label: "Pesanan",
                                data: jumlahpesanan,
                                data1: nilairetur,
                                borderColor: "#f3545d",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#f3545d",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 5,
                                radius: 5,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            },
                            {
                                label: "Faktur",
                                data: jumlahfaktur,
                                data1: nilaifaktur,
                                borderColor: "#1d7af3",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#1d7af3",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 5,
                                radius: 5,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            },
                            {
                                label: "Retur",
                                data: jumlahretur,
                                data1: nilairetur,
                                borderColor: "#59d05d",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#59d05d",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 4,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            }
                        ]
                    };

                    //options
                    var optionsTahunan = {
                        responsive: true,
                        title: {
                            display: true,
                            position: "top",
                            text: "Pesanan, Faktur, dan Retur Tahunan",
                            fontSize: 18,
                            fontColor: "#111"
                        },
                        scales: {
                            yAxes: [{
                                ticks: {
                                    max: maxTicksBasic,
                                    min: -5,
                                    stepSize: steppingBasic
                                }
                            }]
                        },
                        legendCallback: function (chart) {
                            var text = [];
                            text.push('<ul class="' + chart.id + '-legend" style="list-style:none">');
                            for (var i = 0; i < chart.data.datasets.length; i++) {
                                if (chart.data.datasets[i].label) {
                                    text.push(' <div style="width:10px;height:10px;display:inline-block;background:' + chart.data.datasets[i].borderColor + '" />&nbsp;');
                                    text.push(chart.data.datasets[i].label);
                                    text.join(' ');
                                }
                            }
                            text.push('</ul>');

                            return text.join('');
                        },
                        legend: { display: false },
                        tooltips: {
                            callbacks: {
                                label: function (tooltipItem, data) {
                                    var dataset = data.datasets[tooltipItem.datasetIndex];
                                    var meta = dataset._meta[Object.keys(dataset._meta)[0]];
                                    var total = meta.total;
                                    var currentValue = dataset.label;
                                    var label = dataset.data[tooltipItem.index]
                                    var nilai = dataset.data1[tooltipItem.index]
                                    var percentage = parseFloat((nilai / total * 100).toFixed(1));
                                    return currentValue + ': ' + label;
                                },
                                //afterLabel: function (tooltipItem, data) {
                                //    var dataset = data.datasets[tooltipItem.datasetIndex];
                                //    var nilai = dataset.data[tooltipItem.index]
                                //    return 'Rp. ' + convertToRupiah(nilai);
                                //},
                                title: function (tooltipItem, data) {
                                    return data.labels[tooltipItem[0].index];
                                }
                            },
                            backgroundColor: '#FFF',
                            titleFontColor: '#0066ff',
                            bodyFontColor: '#000'
                        }
                    };

                    //create Chart class object
                    var chartTahunan = new Chart(ctxTahunan, {
                        type: "line",
                        data: dataTahunan,
                        options: optionsTahunan
                    });

                    $("#TahunanLegend").html(chartTahunan.generateLegend());

                    //#end region allTahunan
                    //#region PesananTahunan

                    var labelpesananTahunan = [];
                    var labelfakturTahunan = [];
                    var labelreturTahunan = [];
                    var jumlahpesananTahunan = [];
                    var jumlahfakturTahunan = [];
                    var jumlahreturTahunan = [];
                    var nilaipesananTahunan = [];
                    var nilaifakturTahunan = [];
                    var nilaireturTahunan = [];

                    for (var i = 0; i < listDataPesananT.length; i++) {
                        labelpesananTahunan.push(listDataPesananT[i].No);
                        jumlahpesananTahunan.push(listDataPesananT[i].Jumlah);
                        nilaipesananTahunan.push(listDataPesananT[i].Nilai);
                    }
                                        
                    var maxJumlahPesananTahunan = Math.max.apply(Math, jumlahpesananTahunan);
                    var dataMaxJumlahPesananTahunan = [dataMaxJumlahPesananTahunan];
                    var maxJumlahPesananTahunan = Math.max.apply(Math, dataMaxJumlahPesananTahunan);
                    var maxTicksBasicPesananTahunan = Math.ceil(maxJumlahPesananTahunan / 10) * 10;
                    var steppingBasicPesananTahunan = (Math.ceil(maxJumlahPesananTahunan / 10) * 10) / 5;
                    
                    var ctxPesananTahunan = document.getElementById("chartPesananTahunan").getContext('2d');

                    var dataPesananTahunan = {
                        labels: labelpesananTahunan,
                        datasets: [
                            {
                                label: "Pesanan",
                                data: jumlahpesananTahunan,
                                data1: nilaipesananTahunan,
                                borderColor: "#f3545d",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#f3545d",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 5,
                                radius: 5,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            }
                        ]
                    };

                    //options
                    var optionsPesananTahunan = {
                        responsive: true,
                        title: {
                            display: true,
                            position: "top",
                            text: "Pesanan Tahunan",
                            fontSize: 18,
                            fontColor: "#111"
                        },
                        scales: {
                            yAxes: [{
                                ticks: {
                                    max: maxTicksBasicPesananTahunan,
                                    min: -5,
                                    stepSize: steppingBasicPesananTahunan
                                }
                            }]
                        },
                        legendCallback: function (chart) {
                            var text = [];
                            text.push('<ul class="' + chart.id + '-legend" style="list-style:none">');
                            for (var i = 0; i < chart.data.datasets.length; i++) {
                                if (chart.data.datasets[i].label) {
                                    text.push(' <div style="width:10px;height:10px;display:inline-block;background:' + chart.data.datasets[i].borderColor + '" />&nbsp;');
                                    text.push(chart.data.datasets[i].label);
                                    text.join(' ');
                                }
                            }
                            text.push('</ul>');

                            return text.join('');
                        },
                        legend: { display: false },
                        tooltips: {
                            callbacks: {
                                label: function (tooltipItem, data) {
                                    var dataset = data.datasets[tooltipItem.datasetIndex];
                                    var meta = dataset._meta[Object.keys(dataset._meta)[0]];
                                    var total = meta.total;
                                    var currentValue = dataset.label;
                                    var label = dataset.data[tooltipItem.index]
                                    var nilai = dataset.data1[tooltipItem.index]
                                    var percentage = parseFloat((nilai / total * 100).toFixed(1));
                                    return currentValue + ': ' + label;
                                },
                                //afterLabel: function (tooltipItem, data) {
                                //    var dataset = data.datasets[tooltipItem.datasetIndex];
                                //    var nilai = dataset.data[tooltipItem.index]
                                //    return 'Rp. ' + convertToRupiah(nilai);
                                //},
                                title: function (tooltipItem, data) {
                                    return data.labels[tooltipItem[0].index];
                                }
                            },
                            backgroundColor: '#FFF',
                            titleFontColor: '#0066ff',
                            bodyFontColor: '#000'
                        }
                    };

                    //create Chart class object
                    var chartPesananTahunan = new Chart(ctxPesananTahunan, {
                        type: "line",
                        data: dataPesananTahunan,
                        options: optionsPesananTahunan
                    });

                    $("#PesananTahunanLegend").html(chartPesananTahunan.generateLegend());

                    //#end region PesananTahunan

                    //#region FakturTahunan
                    for (var i = 0; i < listDataFakturT.length; i++) {
                        labelfakturTahunan.push(listDataFakturT[i].No);
                        jumlahfakturTahunan.push(listDataFakturT[i].Jumlah);
                        nilaifakturTahunan.push(listDataFakturT[i].Nilai);
                    }
                    var maxJumlahFakturTahunan = Math.max.apply(Math, jumlahfakturTahunan);
                    var dataMaxJumlahFakturTahunan = [maxJumlahFakturTahunan];
                    var maxJumlahFakturTahunan = Math.max.apply(Math, dataMaxJumlahFakturTahunan);
                    var maxTicksBasicFakturTahunan = Math.ceil(maxJumlahFakturTahunan / 10) * 10;
                    var steppingBasicFakturTahunan = (Math.ceil(maxJumlahFakturTahunan / 10) * 10) / 5;

                    var ctxFakturTahunan = document.getElementById("chartFakturTahunan").getContext('2d');

                    var dataFakturTahunan = {
                        labels: labelfakturTahunan,
                        datasets: [
                            {
                                label: "Faktur",
                                data: jumlahfakturTahunan,
                                data1: nilaifakturTahunan,
                                borderColor: "#1d7af3",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#1d7af3",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 5,
                                radius: 5,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            }
                        ]
                    };
                    //options
                    var optionsFakturTahunan = {
                        responsive: true,
                        title: {
                            display: true,
                            position: "top",
                            text: "Faktur Tahunan",
                            fontSize: 18,
                            fontColor: "#111"
                        },
                        scales: {
                            yAxes: [{
                                ticks: {
                                    max: maxTicksBasicFakturTahunan,
                                    min: -5,
                                    stepSize: steppingBasicFakturTahunan
                                }
                            }]
                        },
                        legendCallback: function (chart) {
                            var text = [];
                            text.push('<ul class="' + chart.id + '-legend" style="list-style:none">');
                            for (var i = 0; i < chart.data.datasets.length; i++) {
                                if (chart.data.datasets[i].label) {
                                    text.push(' <div style="width:10px;height:10px;display:inline-block;background:' + chart.data.datasets[i].borderColor + '" />&nbsp;');
                                    text.push(chart.data.datasets[i].label);
                                    text.join(' ');
                                }
                            }
                            text.push('</ul>');

                            return text.join('');
                        },
                        legend: { display: false },
                        tooltips: {
                            callbacks: {
                                label: function (tooltipItem, data) {
                                    var dataset = data.datasets[tooltipItem.datasetIndex];
                                    var meta = dataset._meta[Object.keys(dataset._meta)[0]];
                                    var total = meta.total;
                                    var currentValue = dataset.label;
                                    var label = dataset.data[tooltipItem.index]
                                    var nilai = dataset.data1[tooltipItem.index]
                                    var percentage = parseFloat((nilai / total * 100).toFixed(1));
                                    return currentValue + ': ' + label;
                                },
                                //afterLabel: function (tooltipItem, data) {
                                //    var dataset = data.datasets[tooltipItem.datasetIndex];
                                //    var nilai = dataset.data[tooltipItem.index]
                                //    return 'Rp. ' + convertToRupiah(nilai);
                                //},
                                title: function (tooltipItem, data) {
                                    return data.labels[tooltipItem[0].index];
                                }
                            },
                            backgroundColor: '#FFF',
                            titleFontColor: '#0066ff',
                            bodyFontColor: '#000'
                        }
                    };

                    //create Chart class object
                    var chartFakturTahunan = new Chart(ctxFakturTahunan, {
                        type: "line",
                        data: dataFakturTahunan,
                        options: optionsFakturTahunan
                    });

                    $("#FakturTahunanLegend").html(chartFakturTahunan.generateLegend());
                    //#end Region FakturTahunan
                    //#region ReturTahunan
                    for (var i = 0; i < listDataReturT.length; i++) {
                        labelreturTahunan.push(listDataReturT[i].No);
                        jumlahreturTahunan.push(listDataReturT[i].Jumlah);
                        nilaireturTahunan.push(listDataReturT[i].Nilai);
                    }
                    var maxJumlahReturTahunan = Math.max.apply(Math, jumlahreturTahunan);
                    var dataMaxJumlahReturTahunan = [maxJumlahReturTahunan];
                    var maxJumlahReturTahunan = Math.max.apply(Math, dataMaxJumlahReturTahunan);
                    var maxTicksBasicReturTahunan = Math.ceil(maxJumlahReturTahunan / 10) * 10;
                    var steppingBasicReturTahunan = (Math.ceil(maxJumlahReturTahunan / 10) * 10) / 5;

                    var ctxReturTahunan = document.getElementById("chartReturTahunan").getContext('2d');

                    var dataReturTahunan = {
                        labels: labelreturTahunan,
                        datasets: [
                            {
                                label: "Retur",
                                data: jumlahreturTahunan,
                                data1: nilaireturTahunan,
                                borderColor: "#59d05d",
                                pointBorderColor: "#FFF",
                                pointBackgroundColor: "#59d05d",
                                pointBorderWidth: 2,
                                pointHoverRadius: 4,
                                pointHoverBorderWidth: 1,
                                pointRadius: 4,
                                backgroundColor: 'transparent',
                                fill: true,
                                borderWidth: 2
                            }
                        ]
                    };

                    //options
                    var optionsReturTahunan = {
                        responsive: true,
                        title: {
                            display: true,
                            position: "top",
                            text: "Retur Tahunan",
                            fontSize: 18,
                            fontColor: "#111"
                        },
                        scales: {
                            yAxes: [{
                                ticks: {
                                    max: maxTicksBasicReturTahunan,
                                    min: -5,
                                    stepSize: steppingBasicReturTahunan
                                }
                            }]
                        },
                        legendCallback: function (chart) {
                            var text = [];
                            text.push('<ul class="' + chart.id + '-legend" style="list-style:none">');
                            for (var i = 0; i < chart.data.datasets.length; i++) {
                                if (chart.data.datasets[i].label) {
                                    text.push(' <div style="width:10px;height:10px;display:inline-block;background:' + chart.data.datasets[i].borderColor + '" />&nbsp;');
                                    text.push(chart.data.datasets[i].label);
                                    text.join(' ');
                                }
                            }
                            text.push('</ul>');

                            return text.join('');
                        },
                        legend: { display: false },
                        tooltips: {
                            callbacks: {
                                label: function (tooltipItem, data) {
                                    var dataset = data.datasets[tooltipItem.datasetIndex];
                                    var meta = dataset._meta[Object.keys(dataset._meta)[0]];
                                    var total = meta.total;
                                    var currentValue = dataset.label;
                                    var label = dataset.data[tooltipItem.index]
                                    var nilai = dataset.data1[tooltipItem.index]
                                    var percentage = parseFloat((nilai / total * 100).toFixed(1));
                                    return currentValue + ': ' + label;
                                },
                                //afterLabel: function (tooltipItem, data) {
                                //    var dataset = data.datasets[tooltipItem.datasetIndex];
                                //    var nilai = dataset.data[tooltipItem.index]
                                //    return 'Rp. ' + convertToRupiah(nilai);
                                //},
                                title: function (tooltipItem, data) {
                                    return data.labels[tooltipItem[0].index];
                                }
                            },
                            backgroundColor: '#FFF',
                            titleFontColor: '#0066ff',
                            bodyFontColor: '#000'
                        }
                    };

                    //create Chart class object
                    var chartReturTahunan = new Chart(ctxReturTahunan, {
                        type: "line",
                        data: dataReturTahunan,
                        options: optionsReturTahunan
                    });

                    $("#ReturTahunanLegend").html(chartReturTahunan.generateLegend());
                    //#end Region ReturTahunan
                    

                    $('#loading_dashboard_faktur').hide();
                    $('#grafik-line-section').show();
                },
                error: function (xhr, status, error) {
                    console.log(error);
                }
            });
        }
        //end add by nurul 12/7/2019
    </script>
}

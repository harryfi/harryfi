@using System.Globalization
@using MasterOnline.ViewModels
@model MasterOnline.ViewModels.FakturViewModel
@{
    ViewBag.Title = "Lihat Faktur";
    Layout = null;

    var dataSession = Session["SessionInfo"] as AccountUserViewModel;
    var username = "";
    var context = new MoDbContext("");
    if (dataSession?.User != null)
    {
        var accId = context.User.SingleOrDefault(u => u.Email == dataSession.User.Email)?.AccountId;
        username = context.Account.SingleOrDefault(a => a.AccountId == accId)?.Username;
        context.Dispose();
    }
    else
    {
        username = dataSession?.Account.Username;
    }
    if (username.Length > 20)
    {
        username = username.Substring(0, 17) + "...";
    }

    var CetakFaktur = Model?.urlFaktur;
    var CetakLabel = Model?.urlLabel;
}

<!DOCTYPE html>

<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>@ViewBag.Title - Situs Jualan Online Terpusat</title>
    <link href="~/Content/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="~/Content/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="~/Content/vendors/nprogress/nprogress.css" rel="stylesheet">
    <link href="~/Content/vendors/iCheck/skins/flat/green.css" rel="stylesheet">
    <link href="~/Content/vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
    <link href="~/Content/vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet" />
    <link href="~/Content/build/css/custom.min.css" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Josefin+Sans" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Roboto+Condensed:400,300,300italic,400italic,700,700italic' rel='stylesheet' type='text/css'>
    <!--[if lt IE 9]><script src="http://cdnjs.cloudflare.com/ajax/libs/es5-shim/2.0.8/es5-shim.min.js"></script><![endif]-->

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/paper-css/0.4.1/paper.css" media="print">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/paper-css/0.4.1/paper.min.css" media="print">

    @*<style type="text\css" media="print">
            #myFooter, #myHeader {
                display: none !important;
            }

            /*#page {
                margin: 0;
            }

            html {
                background-color: #FFFFFF;
                margin: 0px;
            }*/

            body * {
                visibility: hidden;
            }

            #fake_page, #fake_page * {
                visibility: visible;
            }

            #fake_page {
                position: absolute;
                left: 50px;
                top: 50px;
            }
        </style>*@

    <style>
        body {
            background-color: #F7F7F7;
            font-family: 'Roboto Condensed', sans-serif;
            color: #606060;
        }

        #faktur_viewer {
            padding: 20px;
        }

        .fake_page {
            background-color: #fff;
            padding: 10px;
            padding-top:5px;
        }

        .bold_title {
            font-weight: bold;
            padding-top: 20px;
            font-size: 24px;
            height: 59px;
        }

        .bold_title_invoice {
            font-weight: bold;
            padding-top: 20px;
            font-size: 36px;
        }

        .sub_title {
            font-size: 16px;
        }

        .block_subtitle {
            display: inline-block;
            width: 80px;
            font-weight: bold;
        }

        .block_subtitle_label {
            display: inline-block;
            width: 135px;
            font-weight: bold;
        }

        hr {
            border: solid 1.5px #eee;
            margin: 15px 0 10px 0;
        }

        #rincian_faktur > thead > tr:not(:last-child) > th {
            border-top: 0;
            border-bottom: 0;
        }

        #rincian_faktur > thead > tr:first-child > th {
            border-top: solid 1px #ddd;
        }

        #garis_potong {
            border: dashed 1.5px #606060;
            margin: 12px 0;
        }

        #print-btn {
            /*position: absolute;
            top: 20px;
            right: 20px;*/
        }

        #barang-faktur > tr > td {
            border-top: none;
        }
    </style>
    <style type="text/css">
        @@media print {
            @@page {
                size: A4 portrait;
                margin: 0;
                width: 210mm;
                height: 297mm;
            }

            body * {
                page: initial;
                position: initial;
                margin: 0;
                padding: 0;
            }

            /*.div_label_pengiriman {
                page-break-after: always !important;
            }*/

                /*.div_label_pengiriman:last-child {
                    page-break-after: avoid ;
                    page-break-inside: avoid ;
                    margin-bottom: 0px ;
                }*/
        }

    </style>
</head>
<body class="A4">
    <div id="faktur_viewer">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12" @*id="fake_page"*@>
                    @if (Model.ListCetakLabel != null)
                    {
                        var listLabel = Model.ListCetakLabel;
                        <div class=" col-md-6 ">

                            @foreach (var labelList in listLabel)
                            {
                                string cekLastOrder = listLabel.Last().Faktur.NO_SO;
                                string no_resi = (labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi);
                                string no_port = (labelList.linkport == null || labelList.linkport == "" ? "-" : labelList.linkport);
                                string isi_port = (labelList.isiPort == null || labelList.isiPort == "" ? "-" : labelList.isiPort);
                                string no_ref = (labelList.linkref == null || labelList.linkref == "" ? "-" : labelList.linkref);
                                string isi_ref = (labelList.isiRef == null || labelList.isiRef == "" ? "-" : labelList.isiRef);
                                string logoKurir = (labelList.logoKurirApi == null || labelList.logoKurirApi == "" ? "-" : labelList.logoKurirApi);
                                int fakturNo = 0;
                                int labelNo = 0;
                                <section>
                                    <div class="row fake_page" id="fake_page">
                                        <div class="row" hidden="hidden">
                                            <div class="col-md-12">
                                                <button id="print-btn" class="btn btn-success pull-right">Print</button>
                                            </div>
                                        </div>
                                        <div hidden="hidden">
                                            @Html.Label(labelList.NamaToko, new { @class = "nm_toko" })
                                            @*@Html.Label(labelList.TlpToko, new { @class = "no_toko" })*@
                                            @Html.Label(labelList.TlpToko == null || labelList.TlpToko == "" ? "-" : labelList.TlpToko, new { @class = "no_toko" })
                                        </div>
                                        @if (CetakFaktur == "1")
                                        {
                                            if (CetakLabel == "1")
                                            {
                                                <div class="div_faktur">
                                                    <div class="row" style="width:650px !important;">
                                                        <div class="col-md-12">
                                                            <table cellpadding="0" style="width:619px !important;">
                                                                <tr>
                                                                    <td>
                                                                        <table class="table-hover" style="width:619px !important;">
                                                                            @*<tr style="width:650px !important;">*@
                                                                            <tr>
                                                                                @*@if (labelList.linktoko != null && labelList.linktoko != "")
                                                {
                                                    <td style="text-align:left; width:325px !important; padding-left:10px !important;">
                                                        <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.linktoko)</span></h1></div>
                                                    </td>
                                                }
                                                else
                                                {
                                                    <td style="text-align:left; width:325px !important; padding-left:10px !important;">
                                                        <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.NamaToko)</span></h1></div>
                                                    </td>
                                                }
                                                <td style="text-align:right; width:325px !important">
                                                    <h1 class="bold_title_invoice" style="margin-right:10px; padding-top:unset">INVOICE</h1>
                                                </td>*@
                                                                                <td>
                                                                                    <div class="col-md-9" style="width: 440px !important;">
                                                                                        @if (labelList.linktoko != null && labelList.linktoko != "")
                                                                                        {
                                                                                            <div style="text-align:left; ">
                                                                                                <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.linktoko)</span></h1></div>
                                                                                            </div>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <div style="text-align:left; ">
                                                                                                <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.NamaToko)</span></h1></div>
                                                                                            </div>
                                                                                        }
                                                                                    </div>
                                                                                    <div class="col-md-3 pull-right">
                                                                                        <div style="text-align:right;">
                                                                                            <h1 class="bold_title_invoice" style="margin-right:10px; padding-top:unset">INVOICE</h1>
                                                                                        </div>
                                                                                    </div>
                                                                                </td>
                                                                            </tr>
                                                                            @if (Model?.urlalamat_faktur != null && Model?.urlalamat_faktur == "1")
                                                                            {
                                                                                <tr style="width:650px !important;">
                                                                                    <td colspan="2">
                                                                                        <div id="alamat_faktur" class="col-md-12 alamat_faktur"><span>@labelList.AlamatToko</span></div>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                            @if (Model?.urlTlp_faktur != null && Model?.urlTlp_faktur == "1")
                                                                            {
                                                                                <tr style="width:650px !important;">
                                                                                    @if (labelList.linktlptoko != null && labelList.linktlptoko != "")
                                                                                    {
                                                                                        <td colspan="2">
                                                                                            <div id="tlp_faktur" class="col-md-12 tlp_faktur"><span class="tlp_toko"> @(labelList.linktlptoko == null ? "" : labelList.linktlptoko)</span></div>
                                                                                        </td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td colspan="2">
                                                                                            <div id="tlp_faktur" class="col-md-12 tlp_faktur"><span class="tlp_toko"> @(labelList.TlpToko == null ? "" : labelList.TlpToko)</span></div>
                                                                                        </td>
                                                                                    }
                                                                                </tr>
                                                                            }
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    @*<br />*@
                                                    <table style="width:619px !important;">
                                                        <tr>
                                                            <td>
                                                                <table class="table-hover">
                                                                    <tr>
                                                                        <td style="text-align:left; background-color:lightskyblue; width:300px  !important;">
                                                                            <span class="block_subtitle" style="color:white;  font-size:16px; text-decoration-line:underline; margin-left:10px">BILL TO</span>
                                                                        </td>
                                                                        <td style="text-align:center; width:19px  !important;"></td>
                                                                        <td style="width:150px  !important; background-color:lightskyblue; text-align:center">
                                                                            <span class="block_subtitle" style="color:white;  font-size:16px; text-decoration-line:underline">INVOICE #</span>
                                                                        </td>
                                                                        <td style="width:150px  !important; background-color:lightskyblue ; text-align:center">
                                                                            <span class="block_subtitle" style="color:white; font-size:16px; text-decoration-line:underline">DATE</span>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="width:300px  !important;">
                                                                            <span class="block_subtitle" style="margin-left:10px">Pembeli</span> @(labelList.namaPembeli)
                                                                        </td>
                                                                        <td style="text-align:center; width:19px !important;"></td>
                                                                        <td style="width:150px !important; text-align:center">
                                                                            <span class="block_subtitle">@(labelList.Faktur.NO_BUKTI)</span>
                                                                        </td>
                                                                        <td style="width:150px !important; text-align:center">
                                                                            <span class="block_subtitle">@(labelList.Faktur.TGL.ToString("dd/MM/yyyy"))</span>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>
                                                                            <span class="block_subtitle" style="margin-left:10px">Telepon</span> @(labelList.tlpPembeli)
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="text-align:left; background-color:lightskyblue; width:300px !important;">
                                                                            <span class="block_subtitle" style="color:white; width:100px; font-size:16px; text-decoration-line:underline; margin-left:10px">NO REFERENSI</span>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>
                                                                            <span class="block_subtitle" style="margin-left:10px">Nomor</span> @(labelList.noRef == null || labelList.noRef == "" ? "-" : labelList.noRef)
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                    <table class="table" style="width:619px !important;">
                                                        <tr style="width:619px !important;">
                                                            <th>No</th>
                                                            <th>Nama Barang</th>
                                                            <th>Lokasi Rak</th>
                                                            <th style="text-align: right;">Jumlah Barang</th>
                                                            <th style="text-align: right;">Harga Barang</th>
                                                            <th style="text-align: right;">Diskon</th>
                                                            <th style="text-align: right;">Subtotal</th>
                                                        </tr>
                                                        <tbody class="barang-faktur" style="width:619px !important;">
                                                            @foreach (var fakturDetail in labelList.ListFakturDetail)
                                                            {
                                                                //change by nurul 15/9/2020
                                                                //var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA;
                                                                //var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA2;
                                                                //var discTotal = fakturDetail.NILAI_DISC ?? 0;
                                                                //var merk = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.Sort2;
                                                                //var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.STN2;
                                                                //var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail);

                                                                var tempBrgBaru = fakturDetail.BRG_MULTISKU != null && fakturDetail.BRG_MULTISKU != "" ? fakturDetail.BRG_MULTISKU : fakturDetail.BRG;
                                                                var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA;
                                                                var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA2;
                                                                var discTotal = fakturDetail.NILAI_DISC ?? 0;
                                                                var merk = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.Sort2;
                                                                var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.STN2;
                                                                var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail);
                                                                //end change by nurul 15/9/2020
                                                                fakturNo = fakturNo + 1;

                                                                //add by nurul 5/2/2021
                                                                var rak = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.LKS;
                                                                //end add by nurul 5/2/2021
                                                                <tr>
                                                                    <td>@fakturNo</td>
                                                                    <td style="width:219px !important;">
                                                                        @namaBarang1
                                                                        @if (!String.IsNullOrWhiteSpace(namaBarang2))
                                                                        {
                                                                            @namaBarang2
                                                                        }
                                                                    </td>
                                                                    <td>
                                                                        @if (!string.IsNullOrEmpty(rak))
                                                                        {
                                                                            @rak
                                                                        }
                                                                    </td>
                                                                    <td style="text-align: right;width:100px !important;">
                                                                        @fakturDetail.QTY @satuan
                                                                    </td>
                                                                    <td style="text-align: right;width:100px !important;">
                                                                        @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", fakturDetail.H_SATUAN)
                                                                    </td>
                                                                    <td style="text-align: right;width:100px !important;">
                                                                        @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", discTotal)
                                                                    </td>
                                                                    <td style="text-align: right;width:100px !important;">
                                                                        @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", fakturDetail.HARGA)
                                                                    </td>
                                                                </tr>
                                                                if (labelList.Marketplace.ToUpper() == "TOKOPEDIA" && ketTokped != "-")
                                                                {
                                                                    if (Model.urlKet_faktur != null && Model?.urlKet_faktur == "1")
                                                                    {
                                                                        <tr style="border-top:hidden;">
                                                                            <td colspan="6">
                                                                                <table>
                                                                                    <tr>
                                                                                        <th width="60px">Catatan</th>
                                                                                        <td>@ketTokped</td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                    }
                                                                }
                                                            }
                                                        </tbody>
                                                    </table>
                                                    <hr style="width:619px !important;" />
                                                    @*//ADD BY NURUL 15/5/2020*@
                                                    @if (labelList.Marketplace.ToUpper() == "SHOPEE" && !string.IsNullOrEmpty(labelList.Ket) && labelList.Ket.Length > 0)
                                                    {
                                                        if (Model.urlKet != null && Model?.urlKet == "1")
                                                        {
                                                            <diV>
                                                                @*<span class="block_subtitle_label">Catatan</span> @(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)*@
                                                                <table>
                                                                    <tr>
                                                                        <th width="60px">Catatan</th>
                                                                        <td>@(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)</td>
                                                                    </tr>
                                                                </table>
                                                            </diV>
                                                            <hr style="width:619px !important;" />
                                                        }
                                                    }
                                                    @*//END ADD BY NURUL 15/5/2020*@
                                                    <table class="table-hover rincian_faktur" id="rincian_faktur" style="width:619px !important;">
                                                        <thead>
                                                            <tr>
                                                                <td style="width: 160px; "></td>
                                                                <td style="width: 160px;"></td>
                                                                <td style="width: 100px; ">Subtotal</td>
                                                                <td style="width: 100px; "></td>
                                                                <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", labelList?.Faktur?.BRUTO)</td>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td style="width: 160px; "></td>
                                                                <td style="width: 160px;"></td>
                                                                <td style="width: 100px; ">Nilai Diskon</td>
                                                                <td style="width: 100px; "></td>
                                                                <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "- {0:N}", labelList?.Faktur?.NILAI_DISC)</td>
                                                            </tr>
                                                            <tr>
                                                                <td style="width: 160px; "></td>
                                                                <td style="width: 160px;"></td>
                                                                <td style="width: 100px; ">Nilai PPN (@(Model?.Faktur?.PPN)%)</td>
                                                                <td style="width: 100px; "></td>
                                                                <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "+ {0:N}", labelList?.Faktur?.NILAI_PPN)</td>
                                                            </tr>
                                                            <tr>
                                                                <td style="width: 160px; "></td>
                                                                <td style="width: 160px;"></td>
                                                                <td style="width: 100px; border-bottom:groove;">Ongkos Kirim</td>
                                                                <td style="width: 100px; border-bottom:groove;"></td>
                                                                <td style="width: 109px; border-bottom:groove; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "+ {0:N}", labelList?.Faktur?.MATERAI)</td>
                                                            </tr>
                                                            <tr>
                                                                <td style="width: 160px; "></td>
                                                                <td style="width: 160px;"></td>
                                                                <td style="width: 100px; border-bottom:groove;">TOTAL</td>
                                                                <td style="width: 100px; border-bottom:groove;"></td>
                                                                <td style="width: 109px; border-bottom:groove; text-align: right; ">Rp. @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", labelList?.Faktur?.NETTO)</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <br />
                                                
                                                    <div id="div_gunting" class="row div_gunting" style="width:650px !important;">
                                                        <div class="col-md-1">
                                                            <span style="font-size: 20px">&#9986;</span>
                                                        </div>
                                                        <div class="col-md-11">
                                                            <hr id="garis_potong" />
                                                        </div>
                                                        <br />
                                                    </div>
                                                
                                            }
                                            else
                                            {
                                                if (cekLastOrder == labelList.Faktur.NO_SO)
                                                {
                                                    <div class="div_faktur" style="page-break-after:avoid;">
                                                        <div class="row" style="width:650px !important;">
                                                            <div class="col-md-12">
                                                                <table cellpadding="0" style="width:619px !important;">
                                                                    <tr>
                                                                        <td>
                                                                            <table class="table-hover" style="width:619px !important;">
                                                                                @*<tr style="width:650px !important;">*@
                                                                                <tr>
                                                                                    @*@if (labelList.linktoko != null && labelList.linktoko != "")
                                                    {
                                                        <td style="text-align:left; width:325px !important; padding-left:10px !important;">
                                                            <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.linktoko)</span></h1></div>
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td style="text-align:left; width:325px !important; padding-left:10px !important;">
                                                            <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.NamaToko)</span></h1></div>
                                                        </td>
                                                    }
                                                    <td style="text-align:right; width:325px !important">
                                                        <h1 class="bold_title_invoice" style="margin-right:10px; padding-top:unset">INVOICE</h1>
                                                    </td>*@
                                                                                    <td>
                                                                                        <div class="col-md-9" style="width: 440px !important;">
                                                                                            @if (labelList.linktoko != null && labelList.linktoko != "")
                                                                                            {
                                                                                                <div style="text-align:left; ">
                                                                                                    <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.linktoko)</span></h1></div>
                                                                                                </div>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <div style="text-align:left; ">
                                                                                                    <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.NamaToko)</span></h1></div>
                                                                                                </div>
                                                                                            }
                                                                                        </div>
                                                                                        <div class="col-md-3 pull-right">
                                                                                            <div style="text-align:right;">
                                                                                                <h1 class="bold_title_invoice" style="margin-right:10px; padding-top:unset">INVOICE</h1>
                                                                                            </div>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                                @if (Model?.urlalamat_faktur != null && Model?.urlalamat_faktur == "1")
                                                                                {
                                                                                    <tr style="width:650px !important;">
                                                                                        <td colspan="2">
                                                                                            <div id="alamat_faktur" class="col-md-12 alamat_faktur"><span>@labelList.AlamatToko</span></div>
                                                                                        </td>
                                                                                    </tr>
                                                                                }
                                                                                @if (Model?.urlTlp_faktur != null && Model?.urlTlp_faktur == "1")
                                                                                {
                                                                                    <tr style="width:650px !important;">
                                                                                        @if (labelList.linktlptoko != null && labelList.linktlptoko != "")
                                                                                        {
                                                                                            <td colspan="2">
                                                                                                <div id="tlp_faktur" class="col-md-12 tlp_faktur"><span class="tlp_toko"> @(labelList.linktlptoko == null ? "" : labelList.linktlptoko)</span></div>
                                                                                            </td>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <td colspan="2">
                                                                                                <div id="tlp_faktur" class="col-md-12 tlp_faktur"><span class="tlp_toko"> @(labelList.TlpToko == null ? "" : labelList.TlpToko)</span></div>
                                                                                            </td>
                                                                                        }
                                                                                    </tr>
                                                                                }
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        @*<br />*@
                                                        <table style="width:619px !important;">
                                                            <tr>
                                                                <td>
                                                                    <table class="table-hover">
                                                                        <tr>
                                                                            <td style="text-align:left; background-color:lightskyblue; width:300px  !important;">
                                                                                <span class="block_subtitle" style="color:white;  font-size:16px; text-decoration-line:underline; margin-left:10px">BILL TO</span>
                                                                            </td>
                                                                            <td style="text-align:center; width:19px  !important;"></td>
                                                                            <td style="width:150px  !important; background-color:lightskyblue; text-align:center">
                                                                                <span class="block_subtitle" style="color:white;  font-size:16px; text-decoration-line:underline">INVOICE #</span>
                                                                            </td>
                                                                            <td style="width:150px  !important; background-color:lightskyblue ; text-align:center">
                                                                                <span class="block_subtitle" style="color:white; font-size:16px; text-decoration-line:underline">DATE</span>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td style="width:300px  !important;">
                                                                                <span class="block_subtitle" style="margin-left:10px">Pembeli</span> @(labelList.namaPembeli)
                                                                            </td>
                                                                            <td style="text-align:center; width:19px !important;"></td>
                                                                            <td style="width:150px !important; text-align:center">
                                                                                <span class="block_subtitle">@(labelList.Faktur.NO_BUKTI)</span>
                                                                            </td>
                                                                            <td style="width:150px !important; text-align:center">
                                                                                <span class="block_subtitle">@(labelList.Faktur.TGL.ToString("dd/MM/yyyy"))</span>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <span class="block_subtitle" style="margin-left:10px">Telepon</span> @(labelList.tlpPembeli)
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td style="text-align:left; background-color:lightskyblue; width:300px !important;">
                                                                                <span class="block_subtitle" style="color:white; width:100px; font-size:16px; text-decoration-line:underline; margin-left:10px">NO REFERENSI</span>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <span class="block_subtitle" style="margin-left:10px">Nomor</span> @(labelList.noRef == null || labelList.noRef == "" ? "-" : labelList.noRef)
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                        <table class="table" style="width:619px !important;">
                                                            <tr style="width:619px !important;">
                                                                <th>No</th>
                                                                <th>Nama Barang</th>
                                                                <th>Lokasi Rak</th>
                                                                <th style="text-align: right;">Jumlah Barang</th>
                                                                <th style="text-align: right;">Harga Barang</th>
                                                                <th style="text-align: right;">Diskon</th>
                                                                <th style="text-align: right;">Subtotal</th>
                                                            </tr>
                                                            <tbody class="barang-faktur" style="width:619px !important;">
                                                                @foreach (var fakturDetail in labelList.ListFakturDetail)
                                                                {
                                                                    //change by nurul 15/9/2020
                                                                    //var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA;
                                                                    //var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA2;
                                                                    //var discTotal = fakturDetail.NILAI_DISC ?? 0;
                                                                    //var merk = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.Sort2;
                                                                    //var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.STN2;
                                                                    //var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail);

                                                                    var tempBrgBaru = fakturDetail.BRG_MULTISKU != null && fakturDetail.BRG_MULTISKU != "" ? fakturDetail.BRG_MULTISKU : fakturDetail.BRG;
                                                                    var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA;
                                                                    var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA2;
                                                                    var discTotal = fakturDetail.NILAI_DISC ?? 0;
                                                                    var merk = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.Sort2;
                                                                    var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.STN2;
                                                                    var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail);
                                                                    //end change by nurul 15/9/2020
                                                                    fakturNo = fakturNo + 1;

                                                                    //add by nurul 5/2/2021
                                                                    var rak = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.LKS;
                                                                    //end add by nurul 5/2/2021
                                                                    <tr>
                                                                        <td>@fakturNo</td>
                                                                        <td style="width:219px !important;">
                                                                            @namaBarang1
                                                                            @if (!String.IsNullOrWhiteSpace(namaBarang2))
                                                                            {
                                                                                @namaBarang2
                                                                            }
                                                                        </td>
                                                                        <td>
                                                                            @if (!string.IsNullOrEmpty(rak))
                                                                            {
                                                                                @rak
                                                                            }
                                                                        </td>
                                                                        <td style="text-align: right;width:100px !important;">
                                                                            @fakturDetail.QTY @satuan
                                                                        </td>
                                                                        <td style="text-align: right;width:100px !important;">
                                                                            @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", fakturDetail.H_SATUAN)
                                                                        </td>
                                                                        <td style="text-align: right;width:100px !important;">
                                                                            @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", discTotal)
                                                                        </td>
                                                                        <td style="text-align: right;width:100px !important;">
                                                                            @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", fakturDetail.HARGA)
                                                                        </td>
                                                                    </tr>
                                                                    if (labelList.Marketplace.ToUpper() == "TOKOPEDIA" && ketTokped != "-")
                                                                    {
                                                                        if (Model.urlKet_faktur != null && Model?.urlKet_faktur == "1")
                                                                        {
                                                                            <tr style="border-top:hidden;">
                                                                                <td colspan="6">
                                                                                    <table>
                                                                                        <tr>
                                                                                            <th width="60px">Catatan</th>
                                                                                            <td>@ketTokped</td>
                                                                                        </tr>
                                                                                    </table>
                                                                                </td>
                                                                            </tr>
                                                                        }
                                                                    }
                                                                }
                                                            </tbody>
                                                        </table>
                                                        <hr style="width:619px !important;" />
                                                        @*//ADD BY NURUL 15/5/2020*@
                                                        @if (labelList.Marketplace.ToUpper() == "SHOPEE" && !string.IsNullOrEmpty(labelList.Ket) && labelList.Ket.Length > 0)
                                                        {
                                                            if (Model.urlKet != null && Model?.urlKet == "1")
                                                            {
                                                                <diV>
                                                                    @*<span class="block_subtitle_label">Catatan</span> @(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)*@
                                                                    <table>
                                                                        <tr>
                                                                            <th width="60px">Catatan</th>
                                                                            <td>@(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)</td>
                                                                        </tr>
                                                                    </table>
                                                                </diV>
                                                                <hr style="width:619px !important;" />
                                                            }
                                                        }
                                                        @*//END ADD BY NURUL 15/5/2020*@
                                                        <table class="table-hover rincian_faktur" id="rincian_faktur" style="width:619px !important;">
                                                            <thead>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; ">Subtotal</td>
                                                                    <td style="width: 100px; "></td>
                                                                    <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", labelList?.Faktur?.BRUTO)</td>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; ">Nilai Diskon</td>
                                                                    <td style="width: 100px; "></td>
                                                                    <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "- {0:N}", labelList?.Faktur?.NILAI_DISC)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; ">Nilai PPN (@(Model?.Faktur?.PPN)%)</td>
                                                                    <td style="width: 100px; "></td>
                                                                    <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "+ {0:N}", labelList?.Faktur?.NILAI_PPN)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; border-bottom:groove;">Ongkos Kirim</td>
                                                                    <td style="width: 100px; border-bottom:groove;"></td>
                                                                    <td style="width: 109px; border-bottom:groove; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "+ {0:N}", labelList?.Faktur?.MATERAI)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; border-bottom:groove;">TOTAL</td>
                                                                    <td style="width: 100px; border-bottom:groove;"></td>
                                                                    <td style="width: 109px; border-bottom:groove; text-align: right; ">Rp. @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", labelList?.Faktur?.NETTO)</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <br />
                                                    
                                                }
                                                else
                                                {
                                                    <div class="div_faktur" style="page-break-after:always;">
                                                        <div class="row" style="width:650px !important;">
                                                            <div class="col-md-12">
                                                                <table cellpadding="0" style="width:619px !important;">
                                                                    <tr>
                                                                        <td>
                                                                            <table class="table-hover" style="width:619px !important;">
                                                                                @*<tr style="width:650px !important;">*@
                                                                                <tr>
                                                                                    @*@if (labelList.linktoko != null && labelList.linktoko != "")
                                                    {
                                                        <td style="text-align:left; width:325px !important; padding-left:10px !important;">
                                                            <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.linktoko)</span></h1></div>
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td style="text-align:left; width:325px !important; padding-left:10px !important;">
                                                            <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.NamaToko)</span></h1></div>
                                                        </td>
                                                    }
                                                    <td style="text-align:right; width:325px !important">
                                                        <h1 class="bold_title_invoice" style="margin-right:10px; padding-top:unset">INVOICE</h1>
                                                    </td>*@
                                                                                    <td>
                                                                                        <div class="col-md-9" style="width:440px !important;">
                                                                                            @if (labelList.linktoko != null && labelList.linktoko != "")
                                                                                            {
                                                                                                <div style="text-align:left; ">
                                                                                                    <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.linktoko)</span></h1></div>
                                                                                                </div>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <div style="text-align:left; ">
                                                                                                    <div class="nama_faktur"><h1 class="bold_title_invoice" style="padding-top:unset"><span class="nama_toko">@(labelList.NamaToko)</span></h1></div>
                                                                                                </div>
                                                                                            }
                                                                                        </div>
                                                                                        <div class="col-md-3 pull-right">
                                                                                            <div style="text-align:right;">
                                                                                                <h1 class="bold_title_invoice" style="margin-right:10px; padding-top:unset">INVOICE</h1>
                                                                                            </div>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                                @if (Model?.urlalamat_faktur != null && Model?.urlalamat_faktur == "1")
                                                                                {
                                                                                    <tr style="width:650px !important;">
                                                                                        <td colspan="2">
                                                                                            <div id="alamat_faktur" class="col-md-12 alamat_faktur"><span>@labelList.AlamatToko</span></div>
                                                                                        </td>
                                                                                    </tr>
                                                                                }
                                                                                @if (Model?.urlTlp_faktur != null && Model?.urlTlp_faktur == "1")
                                                                                {
                                                                                    <tr style="width:650px !important;">
                                                                                        @if (labelList.linktlptoko != null && labelList.linktlptoko != "")
                                                                                        {
                                                                                            <td colspan="2">
                                                                                                <div id="tlp_faktur" class="col-md-12 tlp_faktur"><span class="tlp_toko"> @(labelList.linktlptoko == null ? "" : labelList.linktlptoko)</span></div>
                                                                                            </td>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <td colspan="2">
                                                                                                <div id="tlp_faktur" class="col-md-12 tlp_faktur"><span class="tlp_toko"> @(labelList.TlpToko == null ? "" : labelList.TlpToko)</span></div>
                                                                                            </td>
                                                                                        }
                                                                                    </tr>
                                                                                }
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        @*<br />*@
                                                        <table style="width:619px !important;">
                                                            <tr>
                                                                <td>
                                                                    <table class="table-hover">
                                                                        <tr>
                                                                            <td style="text-align:left; background-color:lightskyblue; width:300px  !important;">
                                                                                <span class="block_subtitle" style="color:white;  font-size:16px; text-decoration-line:underline; margin-left:10px">BILL TO</span>
                                                                            </td>
                                                                            <td style="text-align:center; width:19px  !important;"></td>
                                                                            <td style="width:150px  !important; background-color:lightskyblue; text-align:center">
                                                                                <span class="block_subtitle" style="color:white;  font-size:16px; text-decoration-line:underline">INVOICE #</span>
                                                                            </td>
                                                                            <td style="width:150px  !important; background-color:lightskyblue ; text-align:center">
                                                                                <span class="block_subtitle" style="color:white; font-size:16px; text-decoration-line:underline">DATE</span>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td style="width:300px  !important;">
                                                                                <span class="block_subtitle" style="margin-left:10px">Pembeli</span> @(labelList.namaPembeli)
                                                                            </td>
                                                                            <td style="text-align:center; width:19px !important;"></td>
                                                                            <td style="width:150px !important; text-align:center">
                                                                                <span class="block_subtitle">@(labelList.Faktur.NO_BUKTI)</span>
                                                                            </td>
                                                                            <td style="width:150px !important; text-align:center">
                                                                                <span class="block_subtitle">@(labelList.Faktur.TGL.ToString("dd/MM/yyyy"))</span>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <span class="block_subtitle" style="margin-left:10px">Telepon</span> @(labelList.tlpPembeli)
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td style="text-align:left; background-color:lightskyblue; width:300px !important;">
                                                                                <span class="block_subtitle" style="color:white; width:100px; font-size:16px; text-decoration-line:underline; margin-left:10px">NO REFERENSI</span>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <span class="block_subtitle" style="margin-left:10px">Nomor</span> @(labelList.noRef == null || labelList.noRef == "" ? "-" : labelList.noRef)
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                        <table class="table" style="width:619px !important;">
                                                            <tr style="width:619px !important;">
                                                                <th>No</th>
                                                                <th>Nama Barang</th>
                                                                <th>Lokasi Rak</th>
                                                                <th style="text-align: right;">Jumlah Barang</th>
                                                                <th style="text-align: right;">Harga Barang</th>
                                                                <th style="text-align: right;">Diskon</th>
                                                                <th style="text-align: right;">Subtotal</th>
                                                            </tr>
                                                            <tbody class="barang-faktur" style="width:619px !important;">
                                                                @foreach (var fakturDetail in labelList.ListFakturDetail)
                                                                {
                                                                    //change by nurul 15/9/2020
                                                                    //var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA;
                                                                    //var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA2;
                                                                    //var discTotal = fakturDetail.NILAI_DISC ?? 0;
                                                                    //var merk = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.Sort2;
                                                                    //var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.STN2;
                                                                    //var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail);

                                                                    var tempBrgBaru = fakturDetail.BRG_MULTISKU != null && fakturDetail.BRG_MULTISKU != "" ? fakturDetail.BRG_MULTISKU : fakturDetail.BRG;
                                                                    var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA;
                                                                    var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA2;
                                                                    var discTotal = fakturDetail.NILAI_DISC ?? 0;
                                                                    var merk = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.Sort2;
                                                                    var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.STN2;
                                                                    var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail);
                                                                    //end change by nurul 15/9/2020
                                                                    fakturNo = fakturNo + 1;

                                                                    //add by nurul 5/2/2021
                                                                    var rak = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.LKS;
                                                                    //end add by nurul 5/2/2021
                                                                    <tr>
                                                                        <td>@fakturNo</td>
                                                                        <td style="width:219px !important;">
                                                                            @namaBarang1
                                                                            @if (!String.IsNullOrWhiteSpace(namaBarang2))
                                                                            {
                                                                                @namaBarang2
                                                                            }
                                                                        </td>
                                                                        <td>
                                                                            @if (!string.IsNullOrEmpty(rak))
                                                                            {
                                                                                @rak
                                                                            }
                                                                        </td>
                                                                        <td style="text-align: right;width:100px !important;">
                                                                            @fakturDetail.QTY @satuan
                                                                        </td>
                                                                        <td style="text-align: right;width:100px !important;">
                                                                            @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", fakturDetail.H_SATUAN)
                                                                        </td>
                                                                        <td style="text-align: right;width:100px !important;">
                                                                            @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", discTotal)
                                                                        </td>
                                                                        <td style="text-align: right;width:100px !important;">
                                                                            @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", fakturDetail.HARGA)
                                                                        </td>
                                                                    </tr>
                                                                    if (labelList.Marketplace.ToUpper() == "TOKOPEDIA" && ketTokped != "-")
                                                                    {
                                                                        if (Model.urlKet_faktur != null && Model?.urlKet_faktur == "1")
                                                                        {
                                                                            <tr style="border-top:hidden;">
                                                                                <td colspan="6">
                                                                                    <table>
                                                                                        <tr>
                                                                                            <th width="60px">Catatan</th>
                                                                                            <td>@ketTokped</td>
                                                                                        </tr>
                                                                                    </table>
                                                                                </td>
                                                                            </tr>
                                                                        }
                                                                    }
                                                                }
                                                            </tbody>
                                                        </table>
                                                        <hr style="width:619px !important;" />
                                                        @*//ADD BY NURUL 15/5/2020*@
                                                        @if (labelList.Marketplace.ToUpper() == "SHOPEE" && !string.IsNullOrEmpty(labelList.Ket) && labelList.Ket.Length > 0)
                                                        {
                                                            if (Model.urlKet != null && Model?.urlKet == "1")
                                                            {
                                                                <diV>
                                                                    @*<span class="block_subtitle_label">Catatan</span> @(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)*@
                                                                    <table>
                                                                        <tr>
                                                                            <th width="60px">Catatan</th>
                                                                            <td>@(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)</td>
                                                                        </tr>
                                                                    </table>
                                                                </diV>
                                                                <hr style="width:619px !important;" />
                                                            }
                                                        }
                                                        @*//END ADD BY NURUL 15/5/2020*@
                                                        <table class="table-hover rincian_faktur" id="rincian_faktur" style="width:619px !important;">
                                                            <thead>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; ">Subtotal</td>
                                                                    <td style="width: 100px; "></td>
                                                                    <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", labelList?.Faktur?.BRUTO)</td>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; ">Nilai Diskon</td>
                                                                    <td style="width: 100px; "></td>
                                                                    <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "- {0:N}", labelList?.Faktur?.NILAI_DISC)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; ">Nilai PPN (@(Model?.Faktur?.PPN)%)</td>
                                                                    <td style="width: 100px; "></td>
                                                                    <td style="width: 109px; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "+ {0:N}", labelList?.Faktur?.NILAI_PPN)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; border-bottom:groove;">Ongkos Kirim</td>
                                                                    <td style="width: 100px; border-bottom:groove;"></td>
                                                                    <td style="width: 109px; border-bottom:groove; text-align: right; ">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "+ {0:N}", labelList?.Faktur?.MATERAI)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="width: 160px; "></td>
                                                                    <td style="width: 160px;"></td>
                                                                    <td style="width: 100px; border-bottom:groove;">TOTAL</td>
                                                                    <td style="width: 100px; border-bottom:groove;"></td>
                                                                    <td style="width: 109px; border-bottom:groove; text-align: right; ">Rp. @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", labelList?.Faktur?.NETTO)</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <br />
                                                    
                                                }
                                            }
                                        }
                                        @if (CetakLabel == "1")
                                        {
                                            if (cekLastOrder == labelList.Faktur.NO_SO)
                                            {
                                                <div class="div_label_pengiriman" style="page-break-after:avoid;">
                                                    @if (labelList.KdBooking != "" && labelList.KdBooking != " ")
                                                    {
                                                        @*<div class="row">
                            <div class="col-md-2 block_subtitle_label pull-left">
                                <p class="sub_title">
                                    <span class="block_subtitle_label pull-left">Kode Booking</span>
                                </p>
                            </div>
                            <div class="col-md-8">
                                <div class="resiyes">
                                    <p class="sub_title">
                                        <img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.KdBooking, market = labelList.Marketplace })" alt="" class="pull-left" />
                                    </p>
                                </div>
                            </div>
                            @if(Model.urlLogo != null && Model?.urlLogo == "1" && !string.IsNullOrEmpty(labelList.logoToko))
                            {
                                <div class="col-md-2">
                                    <img src="@labelList.logoToko" alt="" style="width:50px;height:50px;" />
                                </div>
                            }
                        </div>*@

                                                        <div class="row">
                                                            <div class="col-md-9">
                                                                <div class="resiyes">
                                                                    <p class="sub_title">
                                                                        <span class="block_subtitle_label" style="width:80px">Kode Booking</span><img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.KdBooking, market = labelList.Marketplace })" alt="" />
                                                                    </p>
                                                                </div>
                                                            </div>
                                                            @if (Model.urlLogo != null && Model?.urlLogo == "1" && !string.IsNullOrEmpty(labelList.logoToko))
                                                            {
                                                                if (labelList.typeLogo == "2")
                                                                {
                                                                    <div class="col-md-3 pull-right">
                                                                        <img src="@labelList.logoToko" alt="" style="width:130px;height:60px;" />
                                                                    </div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="col-md-3 pull-right">
                                                                        <img src="@labelList.logoToko" alt="" style="width:100px;height:100px;" />
                                                                    </div>
                                                                }
                                                            }
                                                        </div>
                                                    }
                                                    else
                                                    {
                                                        @*<div class="row">
                            <div class="col-md-2 block_subtitle_label pull-left">
                                <p class="sub_title">
                                    <span class="block_subtitle_label pull-left">No Resi</span>
                                </p>
                            </div>
                            <div class="col-md-8">
                                @if (no_resi != "-")
                                {
                                    <div class="resiyes">
                                        <p class="sub_title">
                                            <img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi, market = labelList.Marketplace })" alt="" class="pull-left" />
                                        </p>
                                    </div>
                                }
                                else
                                {
                                    <div class="resino">
                                        <p class="sub_title">
                                            @(labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi)
                                        </p>
                                    </div>
                                }
                            </div>
                            @if (Model.urlLogo != null && Model?.urlLogo == "1" && !string.IsNullOrEmpty(labelList.logoToko))
                            {
                                <div class="col-md-2">
                                    <img src="@labelList.logoToko" alt="" style="width:50px;height:50px;" />
                                </div>
                            }
                        </div>*@

                                                        <div class="row">
                                                            <div class="col-md-9">
                                                                @if (no_resi != "-")
                                                                {
                                                                    <div class="resiyes">
                                                                        <p class="sub_title">
                                                                            <span class="block_subtitle_label" style="width:80px">No Resi</span><img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi, market = labelList.Marketplace })" alt="" />
                                                                        </p>
                                                                    </div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="resino">
                                                                        <p class="sub_title">
                                                                            <span class="block_subtitle_label" style="width:80px">No Resi</span> @(labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi)
                                                                        </p>
                                                                    </div>
                                                                }
                                                            </div>
                                                            @if (Model.urlLogo != null && Model?.urlLogo == "1" && !string.IsNullOrEmpty(labelList.logoToko))
                                                            {
                                                                if (labelList.typeLogo == "2")
                                                                {
                                                                    <div class="col-md-3 pull-right">
                                                                        <img src="@labelList.logoToko" alt="" style="width:130px;height:60px;" />
                                                                    </div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="col-md-3 pull-right">
                                                                        <img src="@labelList.logoToko" alt="" style="width:100px;height:100px;" />
                                                                    </div>
                                                                }
                                                            }
                                                        </div>
                                                    }
                                                    <br />
                                                    @if (isi_port != "-" && no_port == "1")
                                                    {
                                                        <div class="row">
                                                            <div class="col-md-11">

                                                                <div class="resiyes">
                                                                    <p class="sub_title">
                                                                        <span class="block_subtitle_label" style="width:80px">Port Code</span><img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.isiPort == null || labelList.isiPort == "" ? "-" : labelList.isiPort, market = labelList.Marketplace })" alt="" />
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    @if (isi_ref != "-" && no_ref == "1")
                                                    {
                                                        <div class="row">
                                                            <div class="col-md-11">
                                                                <div class="resiyes">
                                                                    <p class="sub_title">
                                                                        <span class="block_subtitle_label" style="width:80px">No Referensi</span><img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.isiRef == null || labelList.isiRef == "" ? "-" : labelList.isiRef, market = labelList.Marketplace })" alt="" />
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    else if (no_ref == "0" || no_ref == "-")
                                                    {
                                                        <div class="row">
                                                            <div class="col-md-11">
                                                                <p class="sub_title">
                                                                    <span class="block_subtitle_label">No. Referensi</span> @(labelList.noRef == null || labelList.noRef == "" ? "-" : labelList.noRef)
                                                                </p>
                                                            </div>
                                                        </div>
                                                    }
                                                    <br />
                                                    <table>
                                                        <tr class="col-md-12" style="width:650px !important;">
                                                            <td class="sub_title col-md-6" style="width:350px !important;">
                                                                @*@if (labelList.Marketplace.ToUpper() == "LAZADA" && logoKurir != "-")*@
                                                                @if (logoKurir != "-" && !string.IsNullOrEmpty(logoKurir))
                                                                {
                                                                    <span class="block_subtitle_label">Kurir</span><img src="@logoKurir" alt="" style="width:80px;height:40px;" />
                                                                }
                                                                else
                                                                {
                                                                    <span class="block_subtitle_label">Kurir</span> @(labelList.Kurir)
                                                                }
                                                            </td>
                                                            <td class="sub_title col-md-6" style="width:300px !important">
                                                                @if (Model.urlMp != null && Model?.urlMp == "1")
                                                                {
                                                                    <div class="market">
                                                                        <div class="sub_title">
                                                                            @*<span class="block_subtitle_label">Marketplace</span>: @(labelList.Marketplace)*@
                                                                            @*<h3><strong>@(labelList.Marketplace.ToUpper())</strong></h3>*@
                                                                            @if (labelList.LogoMarket != null && labelList.LogoMarket != "" && !labelList.Marketplace.ToUpper().Contains("OFFLINE"))
                                                                            {
                                                                                <img src="@labelList.LogoMarket" alt="" style="width:90px;height:40px;" />
                                                                            }
                                                                            @*add by nurul 25/2/2021*@
                                                                            else if (labelList.Marketplace.ToUpper().Contains("OFFLINE"))
                                                                            {
                                                                                if (labelList.linktoko != null && labelList.linktoko != "")
                                                                                {
                                                                                    <h3><strong>@(labelList.linktoko.ToUpper())</strong></h3>
                                                                                }
                                                                                else
                                                                                {
                                                                                    <h3><strong>@(labelList.NamaToko == null ? "" : labelList.NamaToko.ToUpper())</strong></h3>
                                                                                }
                                                                            }
                                                                            @*end add by nurul 25/2/2021*@
                                                                            else
                                                                            {
                                                                                <h3><strong>@(labelList.Marketplace.ToUpper())</strong></h3>
                                                                            }
                                                                        </div>
                                                                    </div>
                                                                }
                                                            </td>
                                                        </tr>
                                                        <tr class="col-md-12" style="width:650px !important;">
                                                            <td class="sub_title col-md-6" style="width:350px !important">
                                                                @*<span class="block_subtitle_label">Tanggal</span> @(labelList.Faktur.TGL.ToString("dd/MM/yyyy"))*@
                                                                <span class="block_subtitle_label">Tanggal</span> @(labelList.tglKirim)
                                                            </td>
                                                            @if (Model.urlNobuk != null && Model?.urlNobuk == "1")
                                                            {
                                                                <td class="sub_title col-md-6 noso " style="width:300px !important">
                                                                    <span class="block_subtitle_label">No. SO</span> @(labelList.Faktur.NO_SO == null || labelList.Faktur.NO_SO == "" ? "-" : labelList.Faktur.NO_SO)
                                                                </td>
                                                            }
                                                        </tr>
                                                        <tr class="col-md-12" style="width:650px;">
                                                            <td class="sub_title col-md-6" style="width:350px !important">
                                                                <span class="block_subtitle_label">Penerima</span> @labelList.Faktur.NAMAPEMESAN
                                                            </td>
                                                            @if (Model?.urlNama != null && Model?.urlNama == "1")
                                                            {
                                                                if (labelList.linktoko != null && labelList.linktoko != "")
                                                                {
                                                                    <td class="sub_title col-md-6" style="width:300px !important">
                                                                        <span class="block_subtitle_label">Nama Toko</span> <span class="nama_toko_label"> @(labelList.linktoko)</span>
                                                                    </td>
                                                                }
                                                                else
                                                                {
                                                                    <td class="sub_title col-md-6" style="width:300px !important">
                                                                        <span class="block_subtitle_label">Nama Toko</span> <span class="nama_toko_label"> @(labelList.NamaToko == null ? "" : labelList.NamaToko)</span>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                        <tr class="col-md-12" style="width:650px !important;">
                                                            <td class="sub_title col-md-6" style="width:350px !important">
                                                                <span class="block_subtitle_label">No. Telepon</span> @(labelList.tlpPembeli)
                                                            </td>
                                                            @if (Model?.urlTlp != null && Model?.urlTlp == "1")
                                                            {
                                                                if (labelList.linktlptoko != null && labelList.linktlptoko != "")
                                                                {
                                                                    <td class="sub_title col-md-6" style="width:300px !important">
                                                                        <div class="tlp_label">
                                                                            <span class="block_subtitle_label">No. Telepon Toko</span> <span class="tlp_toko_label"> @(labelList.linktlptoko == null ? "" : labelList.linktlptoko)</span>
                                                                        </div>
                                                                    </td>
                                                                }
                                                                else
                                                                {
                                                                    <td class="sub_title col-md-6" style="width:300px !important">
                                                                        <div class="tlp_label">
                                                                            <span class="block_subtitle_label">No. Telepon Toko</span> <span class="tlp_toko_label"> @(labelList.TlpToko == null ? "" : labelList.TlpToko)</span>
                                                                        </div>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                        <tr class="col-md-12" style="width:650px !important;">
                                                            <td class="sub_title col-md-6" style="width:350px !important">
                                                                <span class="block_subtitle_label">Alamat Penerima</span> @(labelList.alamatPenerima)
                                                            </td>
                                                            @if (Model?.urlAl != null && Model?.urlAl == "1")
                                                            {
                                                                <td class="sub_title col-md-6" style="width:300px !important">
                                                                    <div class="alamat_label">
                                                                        <span class="block_subtitle_label">Alamat Toko</span> @(labelList.AlamatToko)
                                                                    </div>
                                                                </td>
                                                            }
                                                        </tr>
                                                    </table>
                                                    @*<br />*@
                                                    <table>
                                                        <tr class="col-md-12" style="width:650px  !important;">
                                                            @if (Model.urlTotal != null && Model?.urlTotal == "1")
                                                            {
                                                                <td class="sub_title col-md-6 total" style="width:650px !important;">
                                                                    <span class="block_subtitle_label">Total</span> @(labelList.linktotal)
                                                                </td>
                                                            }
                                                        </tr>
                                                        @*===========================================================================*@
                                                        @*<tr>
                            <td class="sub_title">
                                @if (no_ref == "0" || no_ref == "-")
                                {
                                    <span class="block_subtitle_label">No. Referensi</span> @(labelList.noRef == null || labelList.noRef == "" ? "-" : labelList.noRef)
                                }
                            </td>
                            <td class="sub_title" style="width:550px">
                                <span class="block_subtitle_label">Penerima</span> @labelList.Faktur.NAMAPEMESAN
                            </td>
                        </tr>
                        <tr>
                            <td class="sub_title" style="width:450px">
                                <span class="block_subtitle_label">Kurir</span> @(labelList.Kurir)
                            </td>
                            <td class="sub_title" style="width:550px">
                                <span class="block_subtitle_label">Alamat Penerima</span> @(labelList.alamatPenerima)
                            </td>
                        </tr>
                        <tr>
                            <td class="sub_title">
                                <span class="block_subtitle_label">Tanggal</span> @(labelList.Faktur.TGL.ToString("dd/MM/yyyy"))
                            </td>
                            <td class="sub_title">
                                <span class="block_subtitle_label">No. Telepon</span> @(labelList.tlpPembeli)
                            </td>
                        </tr>
                        <tr>
                            @if (Model.urlNobuk != null && Model?.urlNobuk == "1")
                            {
                                <td class="sub_title noso">
                                    <span class="block_subtitle_label">No. SO</span> @(labelList.Faktur.NO_SO == null || labelList.Faktur.NO_SO == "" ? "-" : labelList.Faktur.NO_SO)
                                </td>
                            }
                            @if (Model.urlTotal != null && Model?.urlTotal == "1")
                            {
                                <td class="sub_title total">
                                    <span class="block_subtitle_label">Total</span> @(labelList.linktotal)
                                </td>
                            }
                        </tr>*@

                                                    </table>
                                                    @*<table>
                        <tr>
                            <td class="sub_title">
                                <span class="block_subtitle_label">Nama Penjual</span> <span class="nama_toko_label"> @(labelList.linktoko == null ? "" : labelList.NamaToko)</span>
                            </td>
                        </tr>
                        @if (Model?.urlAl != null && Model?.urlAl == "1")
                        {
                            <tr>
                                <td class="sub_title">
                                    <div class="alamat_label">
                                        <span class="block_subtitle_label">Alamat Penjual</span> @(labelList.AlamatToko)
                                    </div>
                                </td>
                            </tr>
                        }
                        @if (Model?.urlAl != null && Model?.urlAl == "1")
                        {
                            <tr>
                                <td class="sub_title">
                                    <div class="tlp_label">
                                        <span class="block_subtitle_label">No. Telepon Penjual</span> <span class="tlp_toko_label"> @(labelList.linktlptoko == null ? "" : labelList.TlpToko)</span>
                                    </div>
                                </td>
                            </tr>
                        }
                    </table>*@

                                                    @*add by nurul 28/1/2019*@
                                                    @*<br />*@
                                                    <table class="table" style="width:620px  !important;">
                                                        @*<thead>*@
                                                        <tr>
                                                            <th style="width:20px">No</th>
                                                            <th style="width:200px">Kode Barang</th>
                                                            <th style="width:100px">Lokasi Rak</th>
                                                            <th style="width:450px">Nama Barang</th>
                                                            <th style="text-align: right; width:150px">Jumlah Barang</th>
                                                        </tr>
                                                        @*</thead>*@
                                                        <tbody class="barang-faktur">
                                                            @foreach (var fakturDetail in labelList.ListFakturDetail)
                                                            {
                                                                //change by nurul 15/9/2020
                                                                //var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA;
                                                                //var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA2;
                                                                //var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.STN2;
                                                                //var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail);

                                                                var tempBrgBaru = fakturDetail.BRG_MULTISKU != null && fakturDetail.BRG_MULTISKU != "" ? fakturDetail.BRG_MULTISKU : fakturDetail.BRG;
                                                                var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA;
                                                                var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA2;
                                                                var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.STN2;
                                                                var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail);
                                                                //end change by nurul 15/9/2020

                                                                labelNo = labelNo + 1;

                                                                //add by nurul 5/2/2021
                                                                var rak = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.LKS;
                                                                //end add by nurul 5/2/2021
                                                                <tr>
                                                                    <td>@labelNo</td>
                                                                    <td>
                                                                        @*@fakturDetail.BRG*@
                                                                        @tempBrgBaru
                                                                    </td>
                                                                    <td>
                                                                        @if (!string.IsNullOrEmpty(rak))
                                                                        {
                                                                            @rak
                                                                        }
                                                                    </td>
                                                                    <td>
                                                                        @namaBarang1
                                                                        @if (!String.IsNullOrWhiteSpace(namaBarang2))
                                                                        {
                                                                            @namaBarang2
                                                                        }
                                                                    </td>
                                                                    <td style="text-align: right;">
                                                                        @fakturDetail.QTY @satuan
                                                                    </td>
                                                                </tr>

                                                                if (labelList.Marketplace.ToUpper() == "TOKOPEDIA" && ketTokped != "-")
                                                                {
                                                                    if (Model.urlKet != null && Model?.urlKet == "1")
                                                                    {
                                                                        <tr style="border-top:hidden;">
                                                                            <td colspan="4">
                                                                                <table>
                                                                                    <tr>
                                                                                        <th width="60px">Catatan</th>
                                                                                        <td>@ketTokped</td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                    }
                                                                }
                                                            }
                                                        </tbody>
                                                    </table>
                                                    <hr style="width:620px !important;" />
                                                    @*end add by nurul 28/1/2019*@
                                                    @*//ADD BY NURUL 15/5/2020*@
                                                    @if (labelList.Marketplace.ToUpper() == "SHOPEE" && labelList.Ket.Length > 0)
                                                    {
                                                        if (Model.urlKet != null && Model?.urlKet == "1")
                                                        {
                                                            <diV>
                                                                @*<span class="block_subtitle_label">Catatan</span> @(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)*@
                                                                <table>
                                                                    <tr>
                                                                        <th width="60px">Catatan</th>
                                                                        <td>@(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)</td>
                                                                    </tr>
                                                                </table>
                                                            </diV>
                                                        }
                                                    }
                                                    @*//END ADD BY NURUL 15/5/2020*@
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="div_label_pengiriman" style="page-break-after:always;">
                                                    @if (labelList.KdBooking != "" && labelList.KdBooking != " ")
                                                    {
                                                        @*<div class="row">
                            <div class="col-md-2 block_subtitle_label pull-left">
                                <p class="sub_title">
                                    <span class="block_subtitle_label pull-left">Kode Booking</span>
                                </p>
                            </div>
                            <div class="col-md-8">
                                <div class="resiyes">
                                    <p class="sub_title">
                                        <img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.KdBooking, market = labelList.Marketplace })" alt="" class="pull-left" />
                                    </p>
                                </div>
                            </div>
                            @if(Model.urlLogo != null && Model?.urlLogo == "1" && !string.IsNullOrEmpty(labelList.logoToko))
                            {
                                <div class="col-md-2">
                                    <img src="@labelList.logoToko" alt="" style="width:50px;height:50px;" />
                                </div>
                            }
                        </div>*@

                                                        <div class="row">
                                                            <div class="col-md-9">
                                                                <div class="resiyes">
                                                                    <p class="sub_title">
                                                                        <span class="block_subtitle_label" style="width:80px">Kode Booking</span><img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.KdBooking, market = labelList.Marketplace })" alt="" />
                                                                    </p>
                                                                </div>
                                                            </div>
                                                            @if (Model.urlLogo != null && Model?.urlLogo == "1" && !string.IsNullOrEmpty(labelList.logoToko))
                                                            {
                                                                if (labelList.typeLogo == "2")
                                                                {
                                                                    <div class="col-md-3 pull-right">
                                                                        <img src="@labelList.logoToko" alt="" style="width:130px;height:60px;" />
                                                                    </div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="col-md-3 pull-right">
                                                                        <img src="@labelList.logoToko" alt="" style="width:100px;height:100px;" />
                                                                    </div>
                                                                }
                                                            }
                                                        </div>
                                                    }
                                                    else
                                                    {
                                                        @*<div class="row">
                            <div class="col-md-2 block_subtitle_label pull-left">
                                <p class="sub_title">
                                    <span class="block_subtitle_label pull-left">No Resi</span>
                                </p>
                            </div>
                            <div class="col-md-8">
                                @if (no_resi != "-")
                                {
                                    <div class="resiyes">
                                        <p class="sub_title">
                                            <img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi, market = labelList.Marketplace })" alt="" class="pull-left" />
                                        </p>
                                    </div>
                                }
                                else
                                {
                                    <div class="resino">
                                        <p class="sub_title">
                                            @(labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi)
                                        </p>
                                    </div>
                                }
                            </div>
                            @if (Model.urlLogo != null && Model?.urlLogo == "1" && !string.IsNullOrEmpty(labelList.logoToko))
                            {
                                <div class="col-md-2">
                                    <img src="@labelList.logoToko" alt="" style="width:50px;height:50px;" />
                                </div>
                            }
                        </div>*@

                                                        <div class="row">
                                                            <div class="col-md-9">
                                                                @if (no_resi != "-")
                                                                {
                                                                    <div class="resiyes">
                                                                        <p class="sub_title">
                                                                            <span class="block_subtitle_label" style="width:80px">No Resi</span><img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi, market = labelList.Marketplace })" alt="" />
                                                                        </p>
                                                                    </div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="resino">
                                                                        <p class="sub_title">
                                                                            <span class="block_subtitle_label" style="width:80px">No Resi</span> @(labelList.NoResi == null || labelList.NoResi == "" ? "-" : labelList.NoResi)
                                                                        </p>
                                                                    </div>
                                                                }
                                                            </div>
                                                            @if (Model.urlLogo != null && Model?.urlLogo == "1" && !string.IsNullOrEmpty(labelList.logoToko))
                                                            {
                                                                if (labelList.typeLogo == "2")
                                                                {
                                                                    <div class="col-md-3 pull-right">
                                                                        <img src="@labelList.logoToko" alt="" style="width:130px;height:60px;" />
                                                                    </div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="col-md-3 pull-right">
                                                                        <img src="@labelList.logoToko" alt="" style="width:100px;height:100px;" />
                                                                    </div>
                                                                }
                                                            }
                                                        </div>
                                                    }
                                                    <br />
                                                    @if (isi_port != "-" && no_port == "1")
                                                    {
                                                        <div class="row">
                                                            <div class="col-md-11">

                                                                <div class="resiyes">
                                                                    <p class="sub_title">
                                                                        <span class="block_subtitle_label" style="width:80px">Port Code</span><img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.isiPort == null || labelList.isiPort == "" ? "-" : labelList.isiPort, market = labelList.Marketplace })" alt="" />
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    @if (isi_ref != "-" && no_ref == "1")
                                                    {
                                                        <div class="row">
                                                            <div class="col-md-11">
                                                                <div class="resiyes">
                                                                    <p class="sub_title">
                                                                        <span class="block_subtitle_label" style="width:80px">No Referensi</span><img src="@Url.Action("LihatFakturBarcode", "Manage", new { resi = labelList.isiRef == null || labelList.isiRef == "" ? "-" : labelList.isiRef, market = labelList.Marketplace })" alt="" />
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    else if (no_ref == "0" || no_ref == "-")
                                                    {
                                                        <div class="row">
                                                            <div class="col-md-11">
                                                                <p class="sub_title">
                                                                    <span class="block_subtitle_label">No. Referensi</span> @(labelList.noRef == null || labelList.noRef == "" ? "-" : labelList.noRef)
                                                                </p>
                                                            </div>
                                                        </div>
                                                    }
                                                    <br />
                                                    <table>
                                                        <tr class="col-md-12" style="width:650px !important;">
                                                            <td class="sub_title col-md-6" style="width:350px !important;">
                                                                @*@if (labelList.Marketplace.ToUpper() == "LAZADA" && logoKurir != "-")*@
                                                                @if (logoKurir != "-" && !string.IsNullOrEmpty(logoKurir))
                                                                {
                                                                    <span class="block_subtitle_label">Kurir</span><img src="@logoKurir" alt="" style="width:80px;height:40px;" />
                                                                }
                                                                else
                                                                {
                                                                    <span class="block_subtitle_label">Kurir</span> @(labelList.Kurir)
                                                                }
                                                            </td>
                                                            <td class="sub_title col-md-6" style="width:300px !important">
                                                                @if (Model.urlMp != null && Model?.urlMp == "1")
                                                                {
                                                                    <div class="market">
                                                                        <div class="sub_title">
                                                                            @*<h3><strong>@(labelList.Marketplace.ToUpper())</strong></h3>*@
                                                                            @if (labelList.LogoMarket != null && labelList.LogoMarket != "" && !labelList.Marketplace.ToUpper().Contains("OFFLINE"))
                                                                            {
                                                                                <img src="@labelList.LogoMarket" alt="" style="width:90px;height:40px;" />
                                                                            }
                                                                            @*add by nurul 25/2/2021*@
                                                                            else if (labelList.Marketplace.ToUpper().Contains("OFFLINE"))
                                                                            {
                                                                                if (labelList.linktoko != null && labelList.linktoko != "")
                                                                                {
                                                                                    <h3><strong>@(labelList.linktoko.ToUpper())</strong></h3>
                                                                                }
                                                                                else
                                                                                {
                                                                                    <h3><strong>@(labelList.NamaToko == null ? "" : labelList.NamaToko.ToUpper())</strong></h3>
                                                                                }
                                                                            }
                                                                            @*end add by nurul 25/2/2021*@
                                                                            else
                                                                            {
                                                                                <h3><strong>@(labelList.Marketplace.ToUpper())</strong></h3>
                                                                            }
                                                                        </div>
                                                                    </div>
                                                                }
                                                            </td>
                                                        </tr>
                                                        <tr class="col-md-12" style="width:650px !important;">
                                                            <td class="sub_title col-md-6" style="width:350px !important">
                                                                <span class="block_subtitle_label">Tanggal</span> @(labelList.tglKirim)
                                                            </td>
                                                            @if (Model.urlNobuk != null && Model?.urlNobuk == "1")
                                                            {
                                                                <td class="sub_title col-md-6 noso " style="width:300px !important">
                                                                    <span class="block_subtitle_label">No. SO</span> @(labelList.Faktur.NO_SO == null || labelList.Faktur.NO_SO == "" ? "-" : labelList.Faktur.NO_SO)
                                                                </td>
                                                            }
                                                        </tr>
                                                        <tr class="col-md-12" style="width:650px;">
                                                            <td class="sub_title col-md-6" style="width:350px !important">
                                                                <span class="block_subtitle_label">Penerima</span> @labelList.Faktur.NAMAPEMESAN
                                                            </td>
                                                            @if (Model?.urlNama != null && Model?.urlNama == "1")
                                                            {
                                                                if (labelList.linktoko != null && labelList.linktoko != "")
                                                                {
                                                                    <td class="sub_title col-md-6" style="width:300px !important">
                                                                        <span class="block_subtitle_label">Nama Toko</span> <span class="nama_toko_label"> @(labelList.linktoko)</span>
                                                                    </td>
                                                                }
                                                                else
                                                                {
                                                                    <td class="sub_title col-md-6" style="width:300px !important">
                                                                        <span class="block_subtitle_label">Nama Toko</span> <span class="nama_toko_label"> @(labelList.NamaToko == null ? "" : labelList.NamaToko)</span>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                        <tr class="col-md-12" style="width:650px !important;">
                                                            <td class="sub_title col-md-6" style="width:350px !important">
                                                                <span class="block_subtitle_label">No. Telepon</span> @(labelList.tlpPembeli)
                                                            </td>
                                                            @if (Model?.urlTlp != null && Model?.urlTlp == "1")
                                                            {
                                                                if (labelList.linktlptoko != null && labelList.linktlptoko != "")
                                                                {
                                                                    <td class="sub_title col-md-6" style="width:300px !important">
                                                                        <div class="tlp_label">
                                                                            <span class="block_subtitle_label">No. Telepon Toko</span> <span class="tlp_toko_label"> @(labelList.linktlptoko == null ? "" : labelList.linktlptoko)</span>
                                                                        </div>
                                                                    </td>
                                                                }
                                                                else
                                                                {
                                                                    <td class="sub_title col-md-6" style="width:300px !important">
                                                                        <div class="tlp_label">
                                                                            <span class="block_subtitle_label">No. Telepon Toko</span> <span class="tlp_toko_label"> @(labelList.TlpToko == null ? "" : labelList.TlpToko)</span>
                                                                        </div>
                                                                    </td>
                                                                }
                                                            }
                                                        </tr>
                                                        <tr class="col-md-12" style="width:650px !important;">
                                                            <td class="sub_title col-md-6" style="width:350px !important">
                                                                <span class="block_subtitle_label">Alamat Penerima</span> @(labelList.alamatPenerima)
                                                            </td>
                                                            @if (Model?.urlAl != null && Model?.urlAl == "1")
                                                            {
                                                                <td class="sub_title col-md-6" style="width:300px !important">
                                                                    <div class="alamat_label">
                                                                        <span class="block_subtitle_label">Alamat Toko</span> @(labelList.AlamatToko)
                                                                    </div>
                                                                </td>
                                                            }
                                                        </tr>
                                                    </table>
                                                    @*<br />*@
                                                    <table>
                                                        <tr class="col-md-12" style="width:650px  !important;">
                                                            @if (Model.urlTotal != null && Model?.urlTotal == "1")
                                                            {
                                                                <td class="sub_title col-md-6 total" style="width:650px !important;">
                                                                    <span class="block_subtitle_label">Total</span> @(labelList.linktotal)
                                                                </td>
                                                            }
                                                        </tr>
                                                        @*===========================================================================*@
                                                    </table>
                                                    @*<br />*@
                                                    <table class="table" style="width:620px  !important;">
                                                        <tr>
                                                            <th style="width:20px">No</th>
                                                            <th style="width:200px">Kode Barang</th>
                                                            <th style="width:100px">Lokasi Rak</th>
                                                            <th style="width:450px">Nama Barang</th>
                                                            <th style="text-align: right; width:150px">Jumlah Barang</th>
                                                        </tr>
                                                        <tbody class="barang-faktur">
                                                            @foreach (var fakturDetail in labelList.ListFakturDetail)
                                                            {
                                                                //change by nurul 15/9/2020
                                                                //var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA;
                                                                //var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.NAMA2;
                                                                //var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == fakturDetail.BRG)?.STN2;
                                                                //var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG)?.KetDetail);

                                                                var tempBrgBaru = fakturDetail.BRG_MULTISKU != null && fakturDetail.BRG_MULTISKU != "" ? fakturDetail.BRG_MULTISKU : fakturDetail.BRG;
                                                                var namaBarang1 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA;
                                                                var namaBarang2 = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.NAMA2;
                                                                var satuan = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.STN2;
                                                                var ketTokped = (labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == null || labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail == "" ? "-" : labelList?.listKetTokped.SingleOrDefault(b => b.Brg == fakturDetail.BRG && b.brg_multisku == fakturDetail.BRG_MULTISKU)?.KetDetail);
                                                                //end change by nurul 15/9/2020

                                                                labelNo = labelNo + 1;
                                                                //add by nurul 5/2/2021
                                                                var rak = labelList?.ListBarang?.SingleOrDefault(b => b.BRG == tempBrgBaru)?.LKS;
                                                                //end add by nurul 5/2/2021
                                                                <tr>
                                                                    <td>@labelNo</td>
                                                                    <td>
                                                                        @*@fakturDetail.BRG*@
                                                                        @tempBrgBaru
                                                                    </td>
                                                                    <td>
                                                                        @if (!string.IsNullOrEmpty(rak))
                                                                        {
                                                                            @rak
                                                                        }
                                                                    </td>
                                                                    <td>
                                                                        @namaBarang1
                                                                        @if (!String.IsNullOrWhiteSpace(namaBarang2))
                                                                        {
                                                                            @namaBarang2
                                                                        }
                                                                    </td>
                                                                    <td style="text-align: right;">
                                                                        @fakturDetail.QTY @satuan
                                                                    </td>
                                                                </tr>

                                                                if (labelList.Marketplace.ToUpper() == "TOKOPEDIA" && ketTokped != "-")
                                                                {
                                                                    if (Model.urlKet != null && Model?.urlKet == "1")
                                                                    {
                                                                        <tr style="border-top:hidden;">
                                                                            <td colspan="4">
                                                                                <table>
                                                                                    <tr>
                                                                                        <th width="60px">Catatan</th>
                                                                                        <td>@ketTokped</td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                    }
                                                                }
                                                            }
                                                        </tbody>
                                                    </table>
                                                    <hr style="width:620px !important;" />
                                                    @if (labelList.Marketplace.ToUpper() == "SHOPEE" && !string.IsNullOrEmpty(labelList.Ket) && labelList.Ket.Length > 0)
                                                    {
                                                        if (Model.urlKet != null && Model?.urlKet == "1")
                                                        {
                                                            <diV>
                                                                <table>
                                                                    <tr>
                                                                        <th width="60px">Catatan</th>
                                                                        <td>@(labelList.Ket == null || labelList.Ket == "" ? "-" : labelList.Ket)</td>
                                                                    </tr>
                                                                </table>
                                                            </diV>
                                                        }
                                                    }
                                                </div>
                                            }
                                        }
                                    </div>
                                    <br />
                                </section>
                            }

                        </div>

                    }
                </div>
            </div>
        </div>
    </div>
    <script src="~/Content/vendors/jquery/dist/jquery.min.js"></script>
    <script>

        function parse_query_string(query) {
            var vars = query.split("&");
            var query_string = {};
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                var key = decodeURIComponent(pair[0]);
                var value = decodeURIComponent(pair[1]);
                // If first entry with this name
                if (typeof query_string[key] === "undefined") {
                    query_string[key] = decodeURIComponent(value);
                    // If second entry with this name
                } else if (typeof query_string[key] === "string") {
                    var arr = [query_string[key], decodeURIComponent(value)];
                    query_string[key] = arr;
                    // If third or later entry with this name
                } else {
                    query_string[key].push(decodeURIComponent(value));
                }
            }
            return query_string;
        }

        $(document).ready(function () {
            $('#print-btn').click(function () {
                $(this).hide();
                window.print();
            });

            window.onafterprint = function () {
                $('#print-btn').show();
            }
            //add by nurul 29/4/2019
            function overrideKeyDown(winEvent) {
                var keyCode;

                if (!winEvent) {
                    // IE code
                    winEvent = window.event;
                    keyCode = winEvent.keyCode;
                }
                else {
                    keyCode = winEvent.which;
                }

                if (keyCode == 80 && winEvent.ctrlKey) {
                    //alert('Printer Friendly Page');
                    $('#print-btn').click();
                    return false;
                }
            }

            document.onkeydown = overrideKeyDown;
            var query = window.location.search.substring(1);
            var qs = parse_query_string(query);
            //var url1 = qs.faktur; // faktur
            //var url2 = qs.label; //label
            var url3 = qs.alamat; //alamat
            var url4 = qs.tlp; //tlp
            var url7 = qs.mp; //nama marketplace
            var url8 = qs.nobuk; //no so
            var url9 = qs.total; //harga + ongkir
            //var url5 = qs.toko; //nama toko
            //add by nurul 24/6/2019
            //var url6 = qs.tlpToko; //tlp toko
            //end add nurul 24/6/2019

            //$('.div_faktur').hide();
            //$('.div_gunting').show();
            //$('.div_label_pengiriman').hide();
            //if (CetakFaktur == "1") {
            //    $('.div_faktur').show();
            //}
            //if (CetakLabel == "1") {
            //    $('.div_label_pengiriman').show();
            //}

            //if (CetakFaktur == "0" && CetakLabel == "1") {
            //    $('.div_gunting').hide();
            //}
        });
    </script>

</body>
</html>
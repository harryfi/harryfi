@model MasterOnline.ViewModels.PesananViewModel
@{
    var Noref = Model.noref;
    var Nama_Barang = Model.nm_brg;
    var idMarket = Model.idmarket;
    //var listBarang = Model.ListBarang_NotFound.ToList();
    //var listBarangMarket = Model.ListBarangMarket_NotFound.ToList();
    var PesananDetail_Ganti = Model.PesananDetail_GantiBarang;
}

@if (PesananDetail_Ganti != null)
{
    <script type="text/javascript">
        var idMarket = @Html.Raw(Json.Encode(idMarket));
        var PesananDetail_Ganti = @Html.Raw(Json.Encode(PesananDetail_Ganti));
        var nourut = @Html.Raw(Json.Encode(PesananDetail_Ganti.NO_URUT.ToString()));
        $(document).ready(function () {
            //var tableFixNotFound = $('#datatableGantiBarang').DataTable({
            //    destroy: true,
            //    "pageLength": 6,
            //    "order": [[1, "asc"]], //or asc
            //});

            //$('#search_GantiBarang').keyup(function () {
            //    tableFixNotFound.search($(this).val()).draw();
            //});
            ////$('#search_fixNotFound').val($('#not_found_nama_barang').val());
            ////tableFixNotFound.search($('#not_found_nama_barang').val()).draw();
            //$('#search_GantiBarang').val();
            ////tableFixNotFound.search($('#not_found_nama_barang').val()).draw();

            $('#search_GantiBarang').keypress(function (e) {
                var key = e.which;
                if (key == 13)// the enter key code
                {
                    searchTableBarangGanti();
                    return false;
                }
            });
            $('#search_GantiBarang_click').click(function () {
                searchTableBarangGanti();
            });
        });

    </script>
    <div class="row">
            <div class="form-group" style="margin-top: 5px;">
                <label class="control-label col-md-3 col-sm-3">No. Pesanan</label>
                <div class="col-md-9 col-sm-9">
                    @Html.TextBox("ganti_brg_no_bukti", PesananDetail_Ganti?.NO_BUKTI, new { @class = "form-control", disabled = "disabled" })
                </div>
            </div>
        </div>
    <div class="row">
        <div class="form-group" style="margin-top: 5px;">
            <label class="control-label col-md-3 col-sm-3">No. Referensi</label>
            <div class="col-md-9 col-sm-9">
                @Html.TextBox("ganti_brg_no_ref", Noref, new { @class = "form-control", disabled = "disabled" })
            </div>
        </div>
    </div>
    <div class="row">
        <div class="form-group" style="margin-top: 5px;">
            <label class="control-label col-md-3 col-sm-3">Kode Barang</label>
            <div class="col-md-9 col-sm-9">
                @Html.TextBox("ganti_brg_kode_barang", PesananDetail_Ganti?.BRG, new { @class = "form-control", disabled = "disabled" })
            </div>
        </div>
    </div>
    <div class="row">
        <div class="form-group" style="margin-top: 5px;">
            <label class="control-label col-md-3 col-sm-3">Nama Barang</label>
            <div class="col-md-9 col-sm-9">
                @Html.TextBox("ganti_brg_kode_barang", Nama_Barang, new { @class = "form-control", disabled = "disabled" })
            </div>
        </div>
    </div>
    @*<div class="row" style="margin-top:-15px">
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3">Nama Barang</label>
            <div class="col-md-9 col-sm-9" style="padding-left:13px">
                @{
                        var catatan_split = PesananDetail.CATATAN.Split(new string[] { "_;_" }, StringSplitOptions.None);
                        var namaDiCatatan = "";
                        if (catatan_split.Count() > 2) //OrderNo_;_NamaBarang_;_IdBarang
                        {
                            namaDiCatatan = catatan_split[1];
                        }
                    }
                    @Html.TextBox("ganti_brg_nama_barang", namaDiCatatan, new { @class = "form-control", disabled = "disabled" })
                @Html.TextBox("ganti_brg_kode_barang", Nama_Barang, new { @class = "form-control", disabled = "disabled" })
            </div>
        </div>
    </div>*@
    <div class="row">
        <div class="form-group" style="margin-top: 5px;margin-left:10px;margin-right:5px;">
            <div class="input-group">
                <input id="search_GantiBarang" type="text" class="form-control" placeholder="Pencarian">
                <span class="input-group-btn">
                    <button type="button" id="search_GantiBarang_click" class="btn btn-primary">
                        <i class="fa fa-search"></i>
                    </button>
                </span>
            </div>
            <label>*Data barang yang ada di sini adalah data barang yang sudah dilakukan sinkronisasi dan di-link dengan Master Online.</label>
            @*<label>*Harga jual barang pengganti tidak bisa lebih mahal dari harga jual barang awal.</label>*@
        </div>
    </div>
    <div id="datatable-ganti-barang">
        <div id="table-ganti-barang-partial"></div>
    </div>
    @*<table id="datatableGantiBarang" class="table table-striped table-bordered" role="grid" aria-describedby="datatable_info">
        <thead>
            <tr role="row">
                <th class="sorting_asc" tabindex="0" aria-controls="datatableGantiBarang" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Kode Barang: activate to sort column descending" style="width: 222px;">Kode Barang</th>
                <th class="sorting" tabindex="0" aria-controls="datatableGantiBarang" rowspan="1" colspan="1" aria-label="Nama Barang: activate to sort column ascending" style="width: 590px;">Nama Barang</th>
                <th class="sorting" tabindex="0" aria-controls="datatableGantiBarang" rowspan="1" colspan="1" aria-label="Action: activate to sort column ascending" style="width: 74px;">Pilih</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var barang in listBarangMarket)
            {
                <tr>
                    @{
                        var stf02 = listBarang.SingleOrDefault(p => p.BRG == barang.BRG);
                        var namaBarang = stf02 == null ? "" : stf02.NAMA + " " + stf02.NAMA2;
                    }
                    <td><label class="control-label" style="padding-top: 11px;">@barang.BRG</label></td>
                    <td><label class="control-label" style="padding-top: 11px;">@namaBarang</label></td>
                    <td>
                        <button class="btn btn-primary" style="margin-bottom:1px" onclick="saveGantiBarang(@PesananDetail.NO_URUT,'@barang.RecNum','@barang.BRG',);">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </button>
                    </td>
                </tr>
            }
        </tbody>
    </table>*@
}

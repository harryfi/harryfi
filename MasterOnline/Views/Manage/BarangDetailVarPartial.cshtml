@using System.Globalization
@using MasterOnline.ViewModels
@model MasterOnline.ViewModels.BarangDetailVarViewModel
@{
    //var dataSession = Session["SessionInfo"] as AccountUserViewModel;
    //var username = "";
    //var context = new MoDbContext();
    //if (dataSession?.User != null)
    //{
    //    var accId = context.User.Single(u => u.Username == dataSession.User.Username).AccountId;
    //    username = context.Account.Single(a => a.AccountId == accId).Username;
    //}
    //else
    //{
    //    username = dataSession?.Account.Username;
    //}
}
@Html.AntiForgeryToken()
<style>
    .foto_produk_section {
        padding: 5px;
    }

        .foto_produk_section > .box_upload_var {
            width: 100px;
            height: 100px;
            border: dashed 1.5px #bbb;
            border-radius: 10px;
            background-color: #f7f7f7;
            background-image: url('');
            text-align: center;
            display: table;
            margin: 0 auto;
            cursor: pointer;
        }

        .foto_produk_section > .box_upload_var_2 {
            width: 100px;
            height: 100px;
            border: dashed 1.5px #bbb;
            border-radius: 10px;
            background-color: #f7f7f7;
            background-image: url('');
            text-align: center;
            display: table;
            margin: 0 auto;
            cursor: pointer;
        }

    .box_upload_var > .box_upload_placeholder {
        color: #ccc;
        font-size: 20px;
        display: table-cell;
        vertical-align: middle;
    }

    .box_upload_var_2 > .box_upload_placeholder {
        color: #ccc;
        font-size: 20px;
        display: table-cell;
        vertical-align: middle;
    }

    .foto_produk_section > .box_upload_var_blibli {
        width: 100px;
        height: 100px;
        border: dashed 1.5px #bbb;
        border-radius: 10px;
        background-color: #f7f7f7;
        background-image: url('');
        text-align: center;
        display: table;
        margin: 0 auto;
        cursor: pointer;
    }

    .foto_produk_section > .box_upload_var_blibli_2 {
        width: 100px;
        height: 100px;
        border: dashed 1.5px #bbb;
        border-radius: 10px;
        background-color: #f7f7f7;
        background-image: url('');
        text-align: center;
        display: table;
        margin: 0 auto;
        cursor: pointer;
    }

    .box_upload_var_blibli > .box_upload_placeholder {
        color: #ccc;
        font-size: 20px;
        display: table-cell;
        vertical-align: middle;
    }

    .box_upload_var_blibli_2 > .box_upload_placeholder {
        color: #ccc;
        font-size: 20px;
        display: table-cell;
        vertical-align: middle;
    }
    /*.btn_hapus_foto_produk_var {
        position: absolute;
        bottom: 15px;
        left: 48px;
    }*/
</style>
<script type="text/javascript">

    var validImageVar = ["image/jpeg"];
    var imageContainerInduk = [];
    var imageContainerVar = [];
    var imageContainerVar2 = [];
    var imageContainerBlibli = [];
    var tempImageContainer = [];
    var tempDataBrgId = [];
    var tempSuccessSaveImage = [];

    var tempImageContainerBlibli = [];
    var tempDataBrgIdBlibli = [];
    var tempSuccessSaveImageBlibli = [];

    $(document).ready(function () {
        $(function () {
            $('#variant-tabs-2 a:first').tab('show');
        });

        $("input[type=file]").off('click').on("click",
            function (e) {
                e.stopPropagation();
            });

        if ($('.foto_produk_var').length > 0) {
            $('#simpan_variant_btn').show();
            //if (true) {

            //}
            //$('#proses_detail_var_btn').attr('disabled', 'disabled');
        }
        else {
            $('#simpan_variant_btn').hide();
            //$('#proses_detail_var_btn').removeAttr('disabled');
        }

        $('.btn_hapus_foto_produk_var').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            var data_barang_kode = $(item).attr("data-barang-kode");
            $('#btn_hapus_var_' + data_barang_id).hide();
            $('#btn_hapus_var_' + data_barang_id).off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProduk", "Manage", new { kodeBarang = "replaceKode", urutan = "replaceUrutan" }))';
                $link = $link.replace("replaceKode", encodeURIComponent(data_barang_kode));
                $link = $link.replace("replaceUrutan", 1);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_var_' + data_barang_id).val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_var_' + data_barang_id).val(null);
                        $('#box_upload_var_' + data_barang_id).css('background-image', '');
                        $('#box_upload_var_' + data_barang_id + ' span').show();
                        $('#btn_hapus_var_' + data_barang_id).hide();
                    },
                    error: function () {
                    }
                });

                return;
            });
        });

         $('.btn_hapus_foto_produk_var_2').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            var data_barang_kode = $(item).attr("data-barang-kode");
            $('#btn_hapus_var2_' + data_barang_id).hide();
            $('#btn_hapus_var2_' + data_barang_id).off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProduk", "Manage", new { kodeBarang = "replaceKode", urutan = "replaceUrutan" }))';
                $link = $link.replace("replaceKode", data_barang_kode);
                $link = $link.replace("replaceUrutan", 2);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_var2_' + data_barang_id).val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_var2_' + data_barang_id).val(null);
                        $('#box_upload_var2_' + data_barang_id).css('background-image', '');
                        $('#box_upload_var2_' + data_barang_id + ' span').show();
                        $('#btn_hapus_var2_' + data_barang_id).hide();
                    },
                    error: function () {
                    }
                });

                return;
            });
        });

        //$('.foto_produk_var').each(function (i, item) {
        //    var data_barang_id = $(item).attr("data-barang-id");
        //    $('#foto_produk_var_' + data_barang_id).hide();
        //    $('#foto_produk_var_' + data_barang_id).off('change').on('change', function () {
        //        //var file = this.files[0];
        //        //var fileType = file["type"];
        //        //if ($.inArray(fileType, validImageVar) < 0) {
        //        //    alert('Hanya boleh file berformat .jpg!');
        //        //    return;
        //        //}
        //        //var reader = new FileReader();
        //        //reader.onloadend = function () {
        //        //    $('#box_upload_var_' + data_barang_id).css('background-image', 'url("' + reader.result + '")')
        //        //        .css('background-size', 'cover');
        //        //    $('#box_upload_var_' + data_barang_id + ' span').hide();
        //        //    $('#btn_hapus_var_' + data_barang_id).show();
        //        //}
        //        //if (file) {
        //        //    reader.readAsDataURL(file);
        //        //}

        //        var tempFoto = this;
        //        var file = this.files[0];
        //        var fileName = file["name"];
        //        var fileType = file["type"];
        //        if ($.inArray(fileType, validImageVar) < 0) {
        //            alert('Hanya boleh file berformat .jpg!');
        //            return;
        //        }

        //        var reader = new FileReader();
        //        if (file) {
        //            reader.readAsDataURL(file);
        //        }
        //        reader.onloadend = function () {

        //            //add by nurul 3/3/2020
        //            var image = new Image();
        //            image.src = reader.result;//result is base64-encoded Data URI
        //            var finalFile = reader.result;
        //            //image.name = reader.name;//set name (optional)
        //            //image.size = reader.size;//set size (optional)

        //            image.onload = function () {
        //                var maxWidth = 350,
        //                    maxHeight = 350,
        //                    imageWidth = image.width,
        //                    imageHeight = image.height;

        //                if (image.width > maxWidth) {
        //                    var oc = document.createElement('canvas'), octx = oc.getContext('2d');
        //                    oc.width = image.width;
        //                    oc.height = image.height;
        //                    octx.drawImage(image, 0, 0);
        //                    while (oc.width * 0.5 > maxWidth) {
        //                        oc.width *= 0.5;
        //                        oc.height *= 0.5;
        //                        octx.drawImage(oc, 0, 0, oc.width, oc.height);
        //                    }
        //                    oc.width = maxWidth;
        //                    oc.height = oc.width * image.height / image.width;
        //                    octx.drawImage(image, 0, 0, oc.width, oc.height);
        //                    //document.getElementById('great-image').src = oc.toDataURL();
        //                    finalFile = oc.toDataURL();
        //                } else {
        //                    //document.getElementById('small-image').src = img.src;
        //                    finalFile = reader.result;
        //                }




        //                //if (imageWidth > imageHeight) {
        //                //    if (imageWidth > maxWidth) {
        //                //        imageHeight *= maxWidth / imageWidth;
        //                //        imageWidth = maxWidth;
        //                //    }
        //                //}
        //                //else {
        //                //    if (imageHeight > maxHeight) {
        //                //        imageWidth *= maxHeight / imageHeight;
        //                //        imageHeight = maxHeight;
        //                //    }
        //                //}

        //                //var canvas = document.createElement('canvas');
        //                //canvas.width = imageWidth;
        //                //canvas.height = imageHeight;

        //                //var ctx = canvas.getContext("2d");
        //                //ctx.drawImage(this, 0, 0, imageWidth, imageHeight);

        //                //// The resized file ready for upload
        //                //var finalFile = canvas.toDataURL(fileType);
        //                ////document.getElementById('uploadPreview_induk_1').src = canvas.toDataURL(fileType);
        //                ////file = canvas.toDataURL(fileType);
        //                ////$('#foto_produk_induk_1').files[0] = dataURLtoFile(finalFile, fileName);
        //                var name = fileName.split('.');
        //                var NewName = "";
        //                for (var i = 0; i < name.length; i++) {
        //                    if (i + 1 == name.length) {
        //                        NewName += "_mo." + name[i];
        //                    } else {
        //                        NewName += name[i];
        //                    }
        //                }
        //                file = dataURLtoFile(finalFile, NewName);
        //                //file = dataURLtoFile(finalFile, fileName);
        //                //tempFoto.files[0] = file;
        //                //reader.readAsDataURL(file);
        //                if (file) {
        //                    var noone = 0;
        //                    for (var a = 0; a <= imageContainerVar.length; a++) {
        //                        if (imageContainerVar[a] != file) {
        //                            noone = noone + 1;
        //                        }
        //                    }
        //                    if (noone == imageContainerVar.length + 1) {
        //                        imageContainerVar.push(file);
        //                    }
        //                }
        //                $('#box_upload_var_' + data_barang_id).css('background-image', 'url("' + finalFile + '")')
        //                    .css('background-size', 'cover');
        //                $('#box_upload_var_' + data_barang_id + ' span').hide();
        //                $('#btn_hapus_var_' + data_barang_id).show();
        //            }
        //            //end add by nurul 3/3/2020

        //        }

        //    });
        //});

        //$('.foto_produk_var_2').each(function (i, item) {
        //    var data_barang_id = $(item).attr("data-barang-id");
        //    $('#foto_produk_var2_' + data_barang_id).hide();
        //    $('#foto_produk_var2_' + data_barang_id).off('change').on('change', function () {
        //        //var file = this.files[0];
        //        //var fileType = file["type"];
        //        //if ($.inArray(fileType, validImageVar) < 0) {
        //        //    alert('Hanya boleh file berformat .jpg!');
        //        //    return;
        //        //}
        //        //var reader = new FileReader();
        //        //reader.onloadend = function () {
        //        //    $('#box_upload_var2_' + data_barang_id).css('background-image', 'url("' + reader.result + '")')
        //        //        .css('background-size', 'cover');
        //        //    $('#box_upload_var2_' + data_barang_id + ' span').hide();
        //        //    $('#btn_hapus_var2_' + data_barang_id).show();
        //        //}
        //        //if (file) {
        //        //    reader.readAsDataURL(file);
        //        //}

        //        var tempFoto = this;
        //        var file = this.files[0];
        //        var fileName = file["name"];
        //        var fileType = file["type"];
        //        if ($.inArray(fileType, validImageVar) < 0) {
        //            alert('Hanya boleh file berformat .jpg!');
        //            return;
        //        }

        //        var reader = new FileReader();
        //        if (file) {
        //            reader.readAsDataURL(file);
        //        }
        //        reader.onloadend = function () {

        //            //add by nurul 3/3/2020
        //            var image = new Image();
        //            image.src = reader.result;//result is base64-encoded Data URI
        //            var finalFile = reader.result;
        //            //image.name = reader.name;//set name (optional)
        //            //image.size = reader.size;//set size (optional)

        //            image.onload = function () {
        //                var maxWidth = 350,
        //                    maxHeight = 350,
        //                    imageWidth = image.width,
        //                    imageHeight = image.height;

        //                if (image.width > maxWidth) {
        //                    var oc = document.createElement('canvas'), octx = oc.getContext('2d');
        //                    oc.width = image.width;
        //                    oc.height = image.height;
        //                    octx.drawImage(image, 0, 0);
        //                    while (oc.width * 0.5 > maxWidth) {
        //                        oc.width *= 0.5;
        //                        oc.height *= 0.5;
        //                        octx.drawImage(oc, 0, 0, oc.width, oc.height);
        //                    }
        //                    oc.width = maxWidth;
        //                    oc.height = oc.width * image.height / image.width;
        //                    octx.drawImage(image, 0, 0, oc.width, oc.height);
        //                    //document.getElementById('great-image').src = oc.toDataURL();
        //                    finalFile = oc.toDataURL();
        //                } else {
        //                    //document.getElementById('small-image').src = img.src;
        //                    finalFile = reader.result;
        //                }

        //                //if (imageWidth > imageHeight) {
        //                //    if (imageWidth > maxWidth) {
        //                //        imageHeight *= maxWidth / imageWidth;
        //                //        imageWidth = maxWidth;
        //                //    }
        //                //}
        //                //else {
        //                //    if (imageHeight > maxHeight) {
        //                //        imageWidth *= maxHeight / imageHeight;
        //                //        imageHeight = maxHeight;
        //                //    }
        //                //}

        //                //var canvas = document.createElement('canvas');
        //                //canvas.width = imageWidth;
        //                //canvas.height = imageHeight;

        //                //var ctx = canvas.getContext("2d");
        //                //ctx.drawImage(this, 0, 0, imageWidth, imageHeight);

        //                //// The resized file ready for upload
        //                //var finalFile = canvas.toDataURL(fileType);
        //                ////document.getElementById('uploadPreview_induk_1').src = canvas.toDataURL(fileType);
        //                ////file = canvas.toDataURL(fileType);
        //                ////$('#foto_produk_induk_1').files[0] = dataURLtoFile(finalFile, fileName);
        //                var name = fileName.split('.');
        //                var NewName = "";
        //                for (var i = 0; i < name.length; i++) {
        //                    if (i + 1 == name.length) {
        //                        NewName += "_mo." + name[i];
        //                    } else {
        //                        NewName += name[i];
        //                    }
        //                }
        //                file = dataURLtoFile(finalFile, NewName);
        //                //file = dataURLtoFile(finalFile, fileName);
        //                tempFoto.files[0] = file;
        //                //reader.readAsDataURL(file);
        //                if (file) {
        //                    var noone = 0;
        //                    for (var a = 0; a <= imageContainerVar2.length; a++) {
        //                        if (imageContainerVar2[a] != file) {
        //                            noone = noone + 1;
        //                        }
        //                    }
        //                    if (noone == imageContainerVar2.length + 1) {
        //                        imageContainerVar2.push(file);
        //                    }
        //                }
        //                $('#box_upload_var2_' + data_barang_id).css('background-image', 'url("' + finalFile + '")')
        //                    .css('background-size', 'cover');
        //                $('#box_upload_var2_' + data_barang_id + ' span').hide();
        //                $('#box_upload_var2_' + data_barang_id).show();
        //            }
        //            //end add by nurul 3/3/2020


        //        }

        //    });
        //});

        $('.foto_produk_var').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            $('#foto_produk_var_' + data_barang_id).hide();
            $('#foto_produk_var_' + data_barang_id).off('change').on('change', function () {
                var file = this.files[0];
                var fileType = file["type"];
                if ($.inArray(fileType, validImageVar) < 0) {
                    alert('Hanya boleh file berformat .jpg!');
                    return;
                }
                var fileSize = file["size"];
                if (fileSize > 4000000) {
                    alert('Maximal size 4MB');
                    return false;
                }
                var reader = new FileReader();
                reader.onloadend = function () {
                    $('#box_upload_var_' + data_barang_id).css('background-image', 'url("' + reader.result + '")')
                        .css('background-size', 'cover');
                    $('#box_upload_var_' + data_barang_id + ' span').hide();
                    $('#btn_hapus_var_' + data_barang_id).show();
                }
                if (file) {
                    reader.readAsDataURL(file);
                }
            });
        });

        $('.foto_produk_var_2').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            $('#foto_produk_var2_' + data_barang_id).hide();
            $('#foto_produk_var2_' + data_barang_id).off('change').on('change', function () {
                var file = this.files[0];
                var fileType = file["type"];
                var fileSize = file["size"];
                if (fileSize > 4000000) {
                    alert('Maximal size 4MB');
                    return false;
                }
                if ($.inArray(fileType, validImageVar) < 0) {
                    alert('Hanya boleh file berformat .jpg!');
                    return;
                }
                var reader = new FileReader();
                reader.onloadend = function () {
                    $('#box_upload_var2_' + data_barang_id).css('background-image', 'url("' + reader.result + '")')
                        .css('background-size', 'cover');
                    $('#box_upload_var2_' + data_barang_id + ' span').hide();
                    $('#btn_hapus_var2_' + data_barang_id).show();
                }
                if (file) {
                    reader.readAsDataURL(file);
                }
            });
        });

        $('.box_upload_var').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            $(item).off('click').on('click', function () {
                $('#foto_produk_var_' + data_barang_id).click();
            });
        });

        $('.box_upload_var_2').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            $(item).off('click').on('click', function () {
                $('#foto_produk_var2_' + data_barang_id).click();
            });
        });

        getFotoProdukVariant();

        $('#variant-section input[data-jenis="hjual_var"]').off('focus').focus(function () {
            $(this).val(convertToAngka($(this).val()));
        });

        $('#variant-section input[data-jenis="hjual_var"]').off('change').on('change', function () {
            var input = $(this).val();
            var rupiah = convertToRupiah(input);
            $(this).val(rupiah);
        });

        $('#variant-section input[data-jenis="hjual_var"]').off('keydown').on('keydown',
            function (e) {
                if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
                    // Allow: Ctrl+A, Command+A
                    (e.keyCode === 65 && (e.ctrlKey === true || e.metaKey === true)) ||
                    // Allow: home, end, left, right, down, up
                    (e.keyCode >= 35 && e.keyCode <= 40)) {
                    // let it happen, don't do anything
                    return;
                }
                // Ensure that it is a number and stop the keypress
                if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                    e.preventDefault();
                }
            });

        //foto per varian blibli
        $('.btn_hapus_foto_produk_var_blibli').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            var data_barang_kode = $(item).attr("data-barang-kode");
            $('#btn_hapus_var_blibli_' + data_barang_id).hide();
            $('#btn_hapus_var_blibli_' + data_barang_id).off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProdukBliVar", "Manage", new { recnum = "replaceKode", urutan = "replaceUrutan" }))';
                $link = $link.replace("replaceKode", encodeURIComponent(data_barang_id));
                $link = $link.replace("replaceUrutan", 1);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_var_blibli_' + data_barang_id).val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_var_blibli_' + data_barang_id).val(null);
                        $('#box_upload_var_blibli_' + data_barang_id).css('background-image', '');
                        $('#box_upload_var_blibli_' + data_barang_id + ' span').show();
                        $('#btn_hapus_var_blibli_' + data_barang_id).hide();
                    },
                    error: function () {
                    }
                });

                return;
            });
        });

        $('.btn_hapus_foto_produk_var_blibli_2').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            var data_barang_kode = $(item).attr("data-barang-kode");
            $('#btn_hapus_var_blibli2_' + data_barang_id).hide();
            $('#btn_hapus_var_blibli2_' + data_barang_id).off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProdukBliVar", "Manage", new { recnum = "replaceKode", urutan = "replaceUrutan" }))';
                $link = $link.replace("replaceKode", data_barang_id);
                $link = $link.replace("replaceUrutan", 2);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_var_blibli2_' + data_barang_id).val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_var_blibli2_' + data_barang_id).val(null);
                        $('#box_upload_var_blibli2_' + data_barang_id).css('background-image', '');
                        $('#box_upload_var_blibli2_' + data_barang_id + ' span').show();
                        $('#btn_hapus_var_blibli2_' + data_barang_id).hide();
                    },
                    error: function () {
                    }
                });

                return;
            });
        });

        $('.foto_produk_var_blibli').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            $('#foto_produk_var_blibli_' + data_barang_id).hide();
            $('#foto_produk_var_blibli_' + data_barang_id).off('change').on('change', function () {
                var file = this.files[0];
                var fileType = file["type"];
                if ($.inArray(fileType, validImageVar) < 0) {
                    alert('Hanya boleh file berformat .jpg!');
                    return;
                }
                var reader = new FileReader();
                reader.onloadend = function () {
                    $('#box_upload_var_blibli_' + data_barang_id).css('background-image', 'url("' + reader.result + '")')
                        .css('background-size', 'cover');
                    $('#box_upload_var_blibli_' + data_barang_id + ' span').hide();
                    $('#btn_hapus_var_blibli_' + data_barang_id).show();
                }
                if (file) {
                    reader.readAsDataURL(file);
                }
            });
        });

        $('.foto_produk_var_blibli_2').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            $('#foto_produk_var_blibli2_' + data_barang_id).hide();
            $('#foto_produk_var_blibli2_' + data_barang_id).off('change').on('change', function () {
                var file = this.files[0];
                var fileType = file["type"];
                if ($.inArray(fileType, validImageVar) < 0) {
                    alert('Hanya boleh file berformat .jpg!');
                    return;
                }
                var reader = new FileReader();
                reader.onloadend = function () {
                    $('#box_upload_var_blibli2_' + data_barang_id).css('background-image', 'url("' + reader.result + '")')
                        .css('background-size', 'cover');
                    $('#box_upload_var_blibli2_' + data_barang_id + ' span').hide();
                    $('#btn_hapus_var_blibli2_' + data_barang_id).show();
                }
                if (file) {
                    reader.readAsDataURL(file);
                }
            });
        });

        $('.box_upload_var_blibli').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            $(item).off('click').on('click', function () {
                $('#foto_produk_var_blibli_' + data_barang_id).click();
            });
        });

        $('.box_upload_var_blibli_2').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            $(item).off('click').on('click', function () {
                $('#foto_produk_var_blibli2_' + data_barang_id).click();
            });
        });

        getFotoProdukBlibliVariant();

        //add by Tri 2 oct 2019, gambar induk di form barang varian
        $('#foto_produk_induk_1, #foto_produk_induk_2, #foto_produk_induk_3, #foto_produk_induk_4, #foto_produk_induk_5').hide();
        $('#btn_hapus_induk_1, #btn_hapus_induk_2, #btn_hapus_induk_3, #btn_hapus_induk_4, #btn_hapus_induk_5').hide();

        $('#btn_hapus_induk_1').off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProduk", "Manage", new { kodeBarang = "replaceKode", urutan = "replaceUrutan"}))';
            $link = $link.replace("replaceKode", encodeURIComponent($('#gambarInduk_BRG').val()));
                $link = $link.replace("replaceUrutan", 1);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_induk_1').val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_induk_1').val(null);
                        $('#box_upload_induk_1').css('background-image', '');
                        $('#box_upload_induk_1 span').show();
                        $('#btn_hapus_induk_1').hide();
                    },
                    error: function () {
                    }
                });

                return;
            });
        $('#btn_hapus_induk_2').off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProduk", "Manage", new { kodeBarang = "replaceKode", urutan = "replaceUrutan"}))';
            $link = $link.replace("replaceKode", encodeURIComponent($('#gambarInduk_BRG').val()));
                $link = $link.replace("replaceUrutan", 2);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_induk_2').val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_induk_2').val(null);
                        $('#box_upload_induk_2').css('background-image', '');
                        $('#box_upload_induk_2 span').show();
                        $('#btn_hapus_induk_2').hide();
                    },
                    error: function () {
                    }
                });

                return;
            });
        $('#btn_hapus_induk_3').off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProduk", "Manage", new { kodeBarang = "replaceKode", urutan = "replaceUrutan"}))';
            $link = $link.replace("replaceKode", encodeURIComponent($('#gambarInduk_BRG').val()));
                $link = $link.replace("replaceUrutan", 3);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_induk_3').val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_induk_3').val(null);
                        $('#box_upload_induk_3').css('background-image', '');
                        $('#box_upload_induk_3 span').show();
                        $('#btn_hapus_induk_3').hide();
                    },
                    error: function () {
                    }
                });

                return;
            });
        $('#btn_hapus_induk_4').off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProduk", "Manage", new { kodeBarang = "replaceKode", urutan = "replaceUrutan"}))';
            $link = $link.replace("replaceKode", encodeURIComponent($('#gambarInduk_BRG').val()));
                $link = $link.replace("replaceUrutan", 4);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_induk_4').val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_induk_4').val(null);
                        $('#box_upload_induk_4').css('background-image', '');
                        $('#box_upload_induk_4 span').show();
                        $('#btn_hapus_induk_4').hide();
                    },
                    error: function () {
                    }
                });

                return;
            });
        $('#btn_hapus_induk_5').off('click').on('click', function () {
                var $link = '@Html.Raw(Url.Action("DeleteFotoProduk", "Manage", new { kodeBarang = "replaceKode", urutan = "replaceUrutan"}))';
            $link = $link.replace("replaceKode", encodeURIComponent($('#gambarInduk_BRG').val()));
                $link = $link.replace("replaceUrutan", 5);

                $.ajax({
                    url: $link,
                    type: 'GET',
                    success: function () {
                        var str = $('#hidden_url_gambar_induk_5').val();
                        var n = str.lastIndexOf('/');
                        var keyNameFile = str.substring(n + 1);

                        deleteObjectByFileName(keyNameFile);

                        $('#foto_produk_induk_5').val(null);
                        $('#box_upload_induk_5').css('background-image', '');
                        $('#box_upload_induk_5 span').show();
                        $('#btn_hapus_induk_5').hide();
                    },
                    error: function () {
                    }
                });

                return;
        });

        //$('#foto_produk_induk_1').off('change').on('change', function () {
        //    var tempFoto = this;
        //    var file = this.files[0];
        //    var fileName = file["name"];
        //    var fileType = file["type"];
        //    if ($.inArray(fileType, validImageVar) < 0) {
        //        alert('Hanya boleh file berformat .jpg!');
        //        return;
        //    }

        //    var reader = new FileReader();
        //    if (file) {
        //        reader.readAsDataURL(file);
        //    }
        //    reader.onloadend = function () {

        //        //add by nurul 3/3/2020
        //        var image = new Image();
        //        image.src = reader.result;//result is base64-encoded Data URI
        //        var finalFile = reader.result;
        //        //image.name = reader.name;//set name (optional)
        //        //image.size = reader.size;//set size (optional)

        //        image.onload = function () {
        //            var maxWidth = 350,
        //                maxHeight = 350,
        //                imageWidth = image.width,
        //                imageHeight = image.height;

        //            if (image.width > maxWidth) {
        //                var oc = document.createElement('canvas'), octx = oc.getContext('2d');
        //                oc.width = image.width;
        //                oc.height = image.height;
        //                octx.drawImage(image, 0, 0);
        //                while (oc.width * 0.5 > maxWidth) {
        //                    oc.width *= 0.5;
        //                    oc.height *= 0.5;
        //                    octx.drawImage(oc, 0, 0, oc.width, oc.height);
        //                }
        //                oc.width = maxWidth;
        //                oc.height = oc.width * image.height / image.width;
        //                octx.drawImage(image, 0, 0, oc.width, oc.height);
        //                //document.getElementById('great-image').src = oc.toDataURL();
        //                finalFile = oc.toDataURL();
        //            } else {
        //                //document.getElementById('small-image').src = img.src;
        //                finalFile = reader.result;
        //            }

        //            //if (imageWidth > imageHeight) {
        //            //    if (imageWidth > maxWidth) {
        //            //        imageHeight *= maxWidth / imageWidth;
        //            //        imageWidth = maxWidth;
        //            //    }
        //            //}
        //            //else {
        //            //    if (imageHeight > maxHeight) {
        //            //        imageWidth *= maxHeight / imageHeight;
        //            //        imageHeight = maxHeight;
        //            //    }
        //            //}

        //            //var canvas = document.createElement('canvas');
        //            //canvas.width = imageWidth;
        //            //canvas.height = imageHeight;

        //            //var ctx = canvas.getContext("2d");
        //            //ctx.drawImage(this, 0, 0, imageWidth, imageHeight);

        //            //// The resized file ready for upload
        //            //var finalFile = canvas.toDataURL(fileType);
        //            ////document.getElementById('uploadPreview_induk_1').src = canvas.toDataURL(fileType);
        //            ////file = canvas.toDataURL(fileType);
        //            ////$('#foto_produk_induk_1').files[0] = dataURLtoFile(finalFile, fileName);
        //            var name = fileName.split('.');
        //            var NewName = "";
        //            for (var i = 0; i < name.length; i++) {
        //                if (i + 1 == name.length) {
        //                    NewName += "_mo." + name[i];
        //                } else {
        //                    NewName += name[i];
        //                }
        //            }
        //            file = dataURLtoFile(finalFile, NewName);
        //            //file = dataURLtoFile(finalFile, fileName);
        //            tempFoto.files[0] = file;
        //            //reader.readAsDataURL(file);
        //            if (file) {
        //                var noone = 0;
        //                for (var a = 0; a <= imageContainerInduk.length; a++) {
        //                    if (imageContainerInduk[a] != file) {
        //                        noone = noone + 1;
        //                    }
        //                }
        //                if (noone == imageContainerInduk.length + 1) {
        //                    imageContainerInduk.push(file);
        //                }
        //            }
        //            $('#box_upload_induk_1').css('background-image', 'url("' + finalFile + '")')
        //                .css('background-size', 'cover');
        //            $('#box_upload_induk_1 span').hide();
        //            $('#btn_hapus_induk_1').show();
        //            //reader = finalFile;
        //            //file = finalFile;
        //        }
        //        //image.src = readerEvent.target.result;
        //        //end add by nurul 3/3/2020


        //    }

        //});
        //$('#foto_produk_induk_2').off('change').on('change', function () {
        //    var tempFoto = this;
        //    var file = this.files[0];
        //    var fileName = file["name"];
        //    var fileType = file["type"];
        //    if ($.inArray(fileType, validImageVar) < 0) {
        //        alert('Hanya boleh file berformat .jpg!');
        //        return;
        //    }

        //    var reader = new FileReader();
        //    if (file) {
        //        reader.readAsDataURL(file);
        //    }
        //    reader.onloadend = function () {

        //        //add by nurul 3/3/2020
        //        var image = new Image();
        //        image.src = reader.result;//result is base64-encoded Data URI
        //        var finalFile = reader.result;
        //        //image.name = reader.name;//set name (optional)
        //        //image.size = reader.size;//set size (optional)

        //        image.onload = function () {
        //            var maxWidth = 350,
        //                maxHeight = 350,
        //                imageWidth = image.width,
        //                imageHeight = image.height;

        //            if (image.width > maxWidth) {
        //                var oc = document.createElement('canvas'), octx = oc.getContext('2d');
        //                oc.width = image.width;
        //                oc.height = image.height;
        //                octx.drawImage(image, 0, 0);
        //                while (oc.width * 0.5 > maxWidth) {
        //                    oc.width *= 0.5;
        //                    oc.height *= 0.5;
        //                    octx.drawImage(oc, 0, 0, oc.width, oc.height);
        //                }
        //                oc.width = maxWidth;
        //                oc.height = oc.width * image.height / image.width;
        //                octx.drawImage(image, 0, 0, oc.width, oc.height);
        //                //document.getElementById('great-image').src = oc.toDataURL();
        //                finalFile = oc.toDataURL();
        //            } else {
        //                //document.getElementById('small-image').src = img.src;
        //                finalFile = reader.result;
        //            }

        //            //if (imageWidth > imageHeight) {
        //            //    if (imageWidth > maxWidth) {
        //            //        imageHeight *= maxWidth / imageWidth;
        //            //        imageWidth = maxWidth;
        //            //    }
        //            //}
        //            //else {
        //            //    if (imageHeight > maxHeight) {
        //            //        imageWidth *= maxHeight / imageHeight;
        //            //        imageHeight = maxHeight;
        //            //    }
        //            //}

        //            //var canvas = document.createElement('canvas');
        //            //canvas.width = imageWidth;
        //            //canvas.height = imageHeight;

        //            //var ctx = canvas.getContext("2d");
        //            //ctx.drawImage(this, 0, 0, imageWidth, imageHeight);

        //            //// The resized file ready for upload
        //            //var finalFile = canvas.toDataURL(fileType);
        //            ////document.getElementById('uploadPreview_induk_2').src = canvas.toDataURL(fileType);
        //            ////file = canvas.toDataURL(fileType);
        //            ////$('#foto_produk_induk_2').files[0] = dataURLtoFile(finalFile, fileName);
        //            var name = fileName.split('.');
        //            var NewName = "";
        //            for (var i = 0; i < name.length; i++) {
        //                if (i + 1 == name.length) {
        //                    NewName += "_mo." + name[i];
        //                } else {
        //                    NewName += name[i];
        //                }
        //            }
        //            file = dataURLtoFile(finalFile, NewName);
        //            //file = dataURLtoFile(finalFile, fileName);
        //            tempFoto.files[0] = file;
        //            //reader.readAsDataURL(file);
        //            if (file) {
        //                var noone = 0;
        //                for (var a = 0; a <= imageContainerInduk.length; a++) {
        //                    if (imageContainerInduk[a] != file) {
        //                        noone = noone + 1;
        //                    }
        //                }
        //                if (noone == imageContainerInduk.length + 1) {
        //                    imageContainerInduk.push(file);
        //                }
        //            }
        //            $('#box_upload_induk_2').css('background-image', 'url("' + finalFile + '")')
        //                .css('background-size', 'cover');
        //            $('#box_upload_induk_2 span').hide();
        //            $('#btn_hapus_induk_2').show();
        //            //reader = finalFile;

        //        }
        //        //image.src = readerEvent.target.result;
        //        //end add by nurul 3/3/2020


        //    }

        //});
        //$('#foto_produk_induk_3').off('change').on('change', function () {
        //    var tempFoto = this;
        //    var file = this.files[0];
        //    var fileName = file["name"];
        //    var fileType = file["type"];
        //    if ($.inArray(fileType, validImageVar) < 0) {
        //        alert('Hanya boleh file berformat .jpg!');
        //        return;
        //    }

        //    var reader = new FileReader();
        //    if (file) {
        //        reader.readAsDataURL(file);
        //    }
        //    reader.onloadend = function () {

        //        //add by nurul 3/3/2020
        //        var image = new Image();
        //        image.src = reader.result;//result is base64-encoded Data URI
        //        var finalFile = reader.result;
        //        //image.name = reader.name;//set name (optional)
        //        //image.size = reader.size;//set size (optional)

        //        image.onload = function () {
        //            var maxWidth = 350,
        //                maxHeight = 350,
        //                imageWidth = image.width,
        //                imageHeight = image.height;

        //            if (image.width > maxWidth) {
        //                var oc = document.createElement('canvas'), octx = oc.getContext('2d');
        //                oc.width = image.width;
        //                oc.height = image.height;
        //                octx.drawImage(image, 0, 0);
        //                while (oc.width * 0.5 > maxWidth) {
        //                    oc.width *= 0.5;
        //                    oc.height *= 0.5;
        //                    octx.drawImage(oc, 0, 0, oc.width, oc.height);
        //                }
        //                oc.width = maxWidth;
        //                oc.height = oc.width * image.height / image.width;
        //                octx.drawImage(image, 0, 0, oc.width, oc.height);
        //                //document.getElementById('great-image').src = oc.toDataURL();
        //                finalFile = oc.toDataURL();
        //            } else {
        //                //document.getElementById('small-image').src = img.src;
        //                finalFile = reader.result;
        //            }

        //            //if (imageWidth > imageHeight) {
        //            //    if (imageWidth > maxWidth) {
        //            //        imageHeight *= maxWidth / imageWidth;
        //            //        imageWidth = maxWidth;
        //            //    }
        //            //}
        //            //else {
        //            //    if (imageHeight > maxHeight) {
        //            //        imageWidth *= maxHeight / imageHeight;
        //            //        imageHeight = maxHeight;
        //            //    }
        //            //}

        //            //var canvas = document.createElement('canvas');
        //            //canvas.width = imageWidth;
        //            //canvas.height = imageHeight;

        //            //var ctx = canvas.getContext("2d");
        //            //ctx.drawImage(this, 0, 0, imageWidth, imageHeight);

        //            //// The resized file ready for upload
        //            //var finalFile = canvas.toDataURL(fileType);
        //            ////document.getElementById('uploadPreview_induk_3').src = canvas.toDataURL(fileType);
        //            ////file = canvas.toDataURL(fileType);
        //            ////$('#foto_produk_induk_3').files[0] = dataURLtoFile(finalFile, fileName);
        //            var name = fileName.split('.');
        //            var NewName = "";
        //            for (var i = 0; i < name.length; i++) {
        //                if (i + 1 == name.length) {
        //                    NewName += "_mo." + name[i];
        //                } else {
        //                    NewName += name[i];
        //                }
        //            }
        //            file = dataURLtoFile(finalFile, NewName);
        //            //file = dataURLtoFile(finalFile, fileName);
        //            tempFoto.files[0] = file;
        //            //reader.readAsDataURL(file);
        //            if (file) {
        //                var noone = 0;
        //                for (var a = 0; a <= imageContainerInduk.length; a++) {
        //                    if (imageContainerInduk[a] != file) {
        //                        noone = noone + 1;
        //                    }
        //                }
        //                if (noone == imageContainerInduk.length + 1) {
        //                    imageContainerInduk.push(file);
        //                }
        //            }
        //            $('#box_upload_induk_3').css('background-image', 'url("' + finalFile + '")')
        //                .css('background-size', 'cover');
        //            $('#box_upload_induk_3 span').hide();
        //            $('#btn_hapus_induk_3').show();
        //            //reader = finalFile;
        //            //file = finalFile;
        //        }
        //        //image.src = readerEvent.target.result;
        //        //end add by nurul 3/3/2020


        //    }

        //});
        //$('#foto_produk_induk_4').off('change').on('change', function () {
        //    var tempFoto = this;
        //    var file = this.files[0];
        //    var fileName = file["name"];
        //    var fileType = file["type"];
        //    if ($.inArray(fileType, validImageVar) < 0) {
        //        alert('Hanya boleh file berformat .jpg!');
        //        return;
        //    }
        //    var reader = new FileReader();
        //    if (file) {
        //        reader.readAsDataURL(file);
        //    }
        //    reader.onloadend = function () {

        //        //add by nurul 3/3/2020
        //        var image = new Image();
        //        image.src = reader.result;//result is base64-encoded Data URI
        //        var finalFile = reader.result;
        //        //image.name = reader.name;//set name (optional)
        //        //image.size = reader.size;//set size (optional)

        //        image.onload = function () {
        //            var maxWidth = 350,
        //                maxHeight = 350,
        //                imageWidth = image.width,
        //                imageHeight = image.height;

        //            if (image.width > maxWidth) {
        //                var oc = document.createElement('canvas'), octx = oc.getContext('2d');
        //                oc.width = image.width;
        //                oc.height = image.height;
        //                octx.drawImage(image, 0, 0);
        //                while (oc.width * 0.5 > maxWidth) {
        //                    oc.width *= 0.5;
        //                    oc.height *= 0.5;
        //                    octx.drawImage(oc, 0, 0, oc.width, oc.height);
        //                }
        //                oc.width = maxWidth;
        //                oc.height = oc.width * image.height / image.width;
        //                octx.drawImage(image, 0, 0, oc.width, oc.height);
        //                //document.getElementById('great-image').src = oc.toDataURL();
        //                finalFile = oc.toDataURL();
        //            } else {
        //                //document.getElementById('small-image').src = img.src;
        //                finalFile = reader.result;
        //            }

        //            //if (imageWidth > imageHeight) {
        //            //    if (imageWidth > maxWidth) {
        //            //        imageHeight *= maxWidth / imageWidth;
        //            //        imageWidth = maxWidth;
        //            //    }
        //            //}
        //            //else {
        //            //    if (imageHeight > maxHeight) {
        //            //        imageWidth *= maxHeight / imageHeight;
        //            //        imageHeight = maxHeight;
        //            //    }
        //            //}

        //            //var canvas = document.createElement('canvas');
        //            //canvas.width = imageWidth;
        //            //canvas.height = imageHeight;

        //            //var ctx = canvas.getContext("2d");
        //            //ctx.drawImage(this, 0, 0, imageWidth, imageHeight);

        //            //// The resized file ready for upload
        //            //var finalFile = canvas.toDataURL(fileType);
        //            ////document.getElementById('uploadPreview_induk_4').src = canvas.toDataURL(fileType);
        //            ////file = canvas.toDataURL(fileType);
        //            ////$('#foto_produk_induk_4').files[0] = dataURLtoFile(finalFile, fileName);
        //            var name = fileName.split('.');
        //            var NewName = "";
        //            for (var i = 0; i < name.length; i++) {
        //                if (i + 1 == name.length) {
        //                    NewName += "_mo." + name[i];
        //                } else {
        //                    NewName += name[i];
        //                }
        //            }
        //            file = dataURLtoFile(finalFile, NewName);
        //            //file = dataURLtoFile(finalFile, fileName);
        //            tempFoto.files[0] = file;
        //            //reader.readAsDataURL(file);
        //            if (file) {
        //                var noone = 0;
        //                for (var a = 0; a <= imageContainerInduk.length; a++) {
        //                    if (imageContainerInduk[a] != file) {
        //                        noone = noone + 1;
        //                    }
        //                }
        //                if (noone == imageContainerInduk.length +1) {
        //                    imageContainerInduk.push(file);
        //                }
        //            }
        //            $('#box_upload_induk_4').css('background-image', 'url("' + finalFile + '")')
        //                .css('background-size', 'cover');
        //            $('#box_upload_induk_4 span').hide();
        //            $('#btn_hapus_induk_4').show();
        //            //reader = finalFile;
        //            //file = finalFile;
        //        }
        //        //image.src = readerEvent.target.result;
        //        //end add by nurul 3/3/2020


        //    }

        //});
        //$('#foto_produk_induk_5').off('change').on('change', function () {
        //    var tempFoto = this;
        //    var file = this.files[0];
        //    var fileName = file["name"];
        //    var fileType = file["type"];
        //    if ($.inArray(fileType, validImageVar) < 0) {
        //        alert('Hanya boleh file berformat .jpg!');
        //        return;
        //    }
        //    var reader = new FileReader();
        //    if (file) {
        //        reader.readAsDataURL(file);
        //    }
        //    reader.onloadend = function () {

        //        //add by nurul 3/3/2020
        //        var image = new Image();
        //        image.src = reader.result;//result is base64-encoded Data URI
        //        var finalFile = reader.result;
        //        //image.name = reader.name;//set name (optional)
        //        //image.size = reader.size;//set size (optional)

        //        image.onload = function () {
        //            var maxWidth = 350,
        //                maxHeight = 350,
        //                imageWidth = image.width,
        //                imageHeight = image.height;

        //            if (image.width > maxWidth) {
        //                var oc = document.createElement('canvas'), octx = oc.getContext('2d');
        //                oc.width = image.width;
        //                oc.height = image.height;
        //                octx.drawImage(image, 0, 0);
        //                while (oc.width * 0.5 > maxWidth) {
        //                    oc.width *= 0.5;
        //                    oc.height *= 0.5;
        //                    octx.drawImage(oc, 0, 0, oc.width, oc.height);
        //                }
        //                oc.width = maxWidth;
        //                oc.height = oc.width * image.height / image.width;
        //                octx.drawImage(image, 0, 0, oc.width, oc.height);
        //                //document.getElementById('great-image').src = oc.toDataURL();
        //                finalFile = oc.toDataURL();
        //            } else {
        //                //document.getElementById('small-image').src = img.src;
        //                finalFile = reader.result;
        //            }

        //            //if (imageWidth > imageHeight) {
        //            //    if (imageWidth > maxWidth) {
        //            //        imageHeight *= maxWidth / imageWidth;
        //            //        imageWidth = maxWidth;
        //            //    }
        //            //}
        //            //else {
        //            //    if (imageHeight > maxHeight) {
        //            //        imageWidth *= maxHeight / imageHeight;
        //            //        imageHeight = maxHeight;
        //            //    }
        //            //}

        //            //var canvas = document.createElement('canvas');
        //            //canvas.width = imageWidth;
        //            //canvas.height = imageHeight;

        //            //var ctx = canvas.getContext("2d");
        //            //ctx.drawImage(this, 0, 0, imageWidth, imageHeight);

        //            //// The resized file ready for upload
        //            //var finalFile = canvas.toDataURL(fileType);
        //            ////document.getElementById("uploadPreview_induk_5").src = canvas.toDataURL(fileType);
        //            ////file = canvas.toDataURL(fileType);
        //            ////$('#foto_produk_induk_5').files[0] = dataURLtoFile(finalFile, fileName);
        //            var name = fileName.split('.');
        //            var NewName = "";
        //            for (var i = 0; i < name.length; i++) {
        //                if (i + 1 == name.length) {
        //                    NewName += "_mo." + name[i];
        //                } else {
        //                    NewName += name[i];
        //                }
        //            }
        //            file = dataURLtoFile(finalFile, NewName);
        //            //file = dataURLtoFile(finalFile, fileName);
        //            tempFoto.files[0] = file;
        //            //reader.readAsDataURL(file);
        //            if (file) {
        //                var noone = 0;
        //                for (var a = 0; a <= imageContainerInduk.length; a++) {
        //                    if (imageContainerInduk[a] != file) {
        //                        noone = noone + 1;
        //                    }
        //                }
        //                if (noone == imageContainerInduk.length + 1) {
        //                    imageContainerInduk.push(file);
        //                }
        //            }
        //            $('#box_upload_induk_5').css('background-image', 'url("' + finalFile + '")')
        //                .css('background-size', 'cover');
        //            $('#box_upload_induk_5 span').hide();
        //            $('#btn_hapus_induk_5').show();
        //            //reader = finalFile;
        //            //file = finalFile;
        //        }
        //        //image.src = readerEvent.target.result;
        //        //end add by nurul 3/3/2020


        //    }

        //});

        $('#foto_produk_induk_1').off('change').on('change', function () {
            var file = this.files[0];
            var fileType = file["type"];
            
            if ($.inArray(fileType, validImageVar) < 0) {
                alert('Hanya boleh file berformat .jpg!');
                return;
            }
            var fileSize = file["size"];
            if (fileSize > 4000000) {
                alert('Maximal size 4MB');
                return false;
            }
            var reader = new FileReader();
            reader.onloadend = function () {
                $('#box_upload_induk_1').css('background-image', 'url("' + reader.result + '")')
                    .css('background-size', 'cover');
                $('#box_upload_induk_1 span').hide();
                $('#btn_hapus_induk_1').show();
            }
            if (file) {
                reader.readAsDataURL(file);
            }
        });
        $('#foto_produk_induk_2').off('change').on('change', function () {
            var file = this.files[0];
            var fileType = file["type"];
            if ($.inArray(fileType, validImageVar) < 0) {
                alert('Hanya boleh file berformat .jpg!');
                return;
            }
            var fileSize = file["size"];
            if (fileSize > 4000000) {
                alert('Maximal size 4MB');
                return false;
            }
            var reader = new FileReader();
            reader.onloadend = function () {
                $('#box_upload_induk_2').css('background-image', 'url("' + reader.result + '")')
                    .css('background-size', 'cover');
                $('#box_upload_induk_2 span').hide();
                $('#btn_hapus_induk_2').show();
            }
            if (file) {
                reader.readAsDataURL(file);
            }
        });
        $('#foto_produk_induk_3').off('change').on('change', function () {
            var file = this.files[0];
            var fileType = file["type"];
            if ($.inArray(fileType, validImageVar) < 0) {
                alert('Hanya boleh file berformat .jpg!');
                return;
            }
            var fileSize = file["size"];
            if (fileSize > 4000000) {
                alert('Maximal size 4MB');
                return false;
            }
            var reader = new FileReader();
            reader.onloadend = function () {
                $('#box_upload_induk_3').css('background-image', 'url("' + reader.result + '")')
                    .css('background-size', 'cover');
                $('#box_upload_induk_3 span').hide();
                $('#btn_hapus_induk_3').show();
            }
            if (file) {
                reader.readAsDataURL(file);
            }
        });
        $('#foto_produk_induk_4').off('change').on('change', function () {
            var file = this.files[0];
            var fileType = file["type"];
            if ($.inArray(fileType, validImageVar) < 0) {
                alert('Hanya boleh file berformat .jpg!');
                return;
            }
            var fileSize = file["size"];
            if (fileSize > 4000000) {
                alert('Maximal size 4MB');
                return false;
            }
            var reader = new FileReader();
            reader.onloadend = function () {
                $('#box_upload_induk_4').css('background-image', 'url("' + reader.result + '")')
                    .css('background-size', 'cover');
                $('#box_upload_induk_4 span').hide();
                $('#btn_hapus_induk_4').show();
            }
            if (file) {
                reader.readAsDataURL(file);
            }
        });
        $('#foto_produk_induk_5').off('change').on('change', function () {
            var file = this.files[0];
            var fileType = file["type"];
            if ($.inArray(fileType, validImageVar) < 0) {
                alert('Hanya boleh file berformat .jpg!');
                return;
            }
            var fileSize = file["size"];
            if (fileSize > 4000000) {
                alert('Maximal size 4MB');
                return false;
            }
            var reader = new FileReader();
            reader.onloadend = function () {
                $('#box_upload_induk_5').css('background-image', 'url("' + reader.result + '")')
                    .css('background-size', 'cover');
                $('#box_upload_induk_5 span').hide();
                $('#btn_hapus_induk_5').show();
            }
            if (file) {
                reader.readAsDataURL(file);
            }
        });

        $('#box_upload_induk_1').off('click').on('click', function () {
            $('#foto_produk_induk_1').click();
        });

        $('#box_upload_induk_2').off('click').on('click', function () {
            $('#foto_produk_induk_2').click();
        });

        $('#box_upload_induk_3').off('click').on('click', function () {
            $('#foto_produk_induk_3').click();
        });

        $('#box_upload_induk_4').off('click').on('click', function () {
            $('#foto_produk_induk_4').click();
        });

        $('#box_upload_induk_5').off('click').on('click', function () {
            $('#foto_produk_induk_5').click();
        });

        getFotoProdukInduk();
        //end add by Tri 2 oct 2019, gambar induk di form barang varian

    });

    function getFotoProdukVariant() {
        $('.hidden_url_gambar_var').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");

            $('#foto_produk_var_' + data_barang_id).val(null);
            $('#box_upload_var_' + data_barang_id).css('background-image', '');
            $('#box_upload_var_' + data_barang_id + ' span').show();
            $('#btn_hapus_var_' + data_barang_id).hide();

            if ($(item).val() != "") {
                $('#box_upload_var_' + data_barang_id).css({
                    'background-image': 'url("' + $(item).val() + '")',
                    'background-size': 'cover'
                });
                $('#box_upload_var_' + data_barang_id + ' span').hide();
                $('#btn_hapus_var_' + data_barang_id).show();
            }

        });

        $('.hidden_url_gambar_var_2').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");

            $('#foto_produk_var2_' + data_barang_id).val(null);
            $('#box_upload_var2_' + data_barang_id).css('background-image', '');
            $('#box_upload_var2_' + data_barang_id + ' span').show();
            $('#btn_hapus_var2_' + data_barang_id).hide();

            if ($(item).val() != "") {
                $('#box_upload_var2_' + data_barang_id).css({
                    'background-image': 'url("' + $(item).val() + '")',
                    'background-size': 'cover'
                });
                $('#box_upload_var2_' + data_barang_id + ' span').hide();
                $('#btn_hapus_var2_' + data_barang_id).show();
            }

        });
    }

    function getFotoProdukBlibliVariant() {
        $('.hidden_url_gambar_var_blibli').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");

            $('#foto_produk_var_blibli_' + data_barang_id).val(null);
            $('#box_upload_var_blibli_' + data_barang_id).css('background-image', '');
            $('#box_upload_var_blibli_' + data_barang_id + ' span').show();
            $('#btn_hapus_var_blibli_' + data_barang_id).hide();

            if ($(item).val() != "") {
                $('#box_upload_var_blibli_' + data_barang_id).css({
                    'background-image': 'url("' + $(item).val() + '")',
                    'background-size': 'cover'
                });
                $('#box_upload_var_blibli_' + data_barang_id + ' span').hide();
                $('#btn_hapus_var_blibli_' + data_barang_id).show();
            }
        });

        $('.hidden_url_gambar_var_blibli_2').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");

            $('#foto_produk_var_blibli2_' + data_barang_id).val(null);
            $('#box_upload_var_blibli2_' + data_barang_id).css('background-image', '');
            $('#box_upload_var_blibli2_' + data_barang_id + ' span').show();
            $('#btn_hapus_var_blibli2_' + data_barang_id).hide();

            if ($(item).val() != "") {
                $('#box_upload_var_blibli2_' + data_barang_id).css({
                    'background-image': 'url("' + $(item).val() + '")',
                    'background-size': 'cover'
                });
                $('#box_upload_var_blibli2_' + data_barang_id + ' span').hide();
                $('#btn_hapus_var_blibli2_' + data_barang_id).show();
            }
        });
    }

    function getFotoProdukInduk() {
        if ($('#hidden_url_gambar_induk_1').val() != "") {
            $('#box_upload_induk_1').css({
                'background-image': 'url("' + $('#hidden_url_gambar_induk_1').val() + '")',
                'background-size': 'cover'
            });
            $('#box_upload_induk_1 span').hide();
            $('#btn_hapus_induk_1').show();
        }

        if ($('#hidden_url_gambar_induk_2').val() != "") {
            $('#box_upload_induk_2').css({
                'background-image': 'url("' + $('#hidden_url_gambar_induk_2').val() + '")',
                'background-size': 'cover'
            });
            $('#box_upload_induk_2 span').hide();
            $('#btn_hapus_induk_2').show();
        }

        if ($('#hidden_url_gambar_induk_3').val() != "") {
            $('#box_upload_induk_3').css({
                'background-image': 'url("' + $('#hidden_url_gambar_induk_3').val() + '")',
                'background-size': 'cover'
            });
            $('#box_upload_induk_3 span').hide();
            $('#btn_hapus_induk_3').show();
        }

        if ($('#hidden_url_gambar_induk_4').val() != "") {
            $('#box_upload_induk_4').css({
                'background-image': 'url("' + $('#hidden_url_gambar_induk_4').val() + '")',
                'background-size': 'cover'
            });
            $('#box_upload_induk_4 span').hide();
            $('#btn_hapus_induk_4').show();
        }

        if ($('#hidden_url_gambar_induk_5').val() != "") {
            $('#box_upload_induk_5').css({
                'background-image': 'url("' + $('#hidden_url_gambar_induk_5').val() + '")',
                'background-size': 'cover'
            });
            $('#box_upload_induk_5 span').hide();
            $('#btn_hapus_induk_5').show();
        }
    }

    function UpdateGambarVariantBarangBlibli() {
        var listGambarVariant = new FormData();

        //$('.foto_produk_var_blibli').each(function (i, item) {
        //    var data_barang_id = $(item).attr("data-barang-id");
        //    listGambarVariant.append(data_barang_id, $(item)[0].files[0]);
        //});
        tempDataBrgIdBlibli.length = 0;
        tempImageContainerBlibli.length = 0;
        tempSuccessSaveImageBlibli.length = 0;
        $('.foto_produk_var_blibli').each(function (i, item) {
            var data_barang_id = $(item).attr("data-barang-id");
            listGambarVariant.append(data_barang_id, $(item)[0].files[0]);
            tempDataBrgIdBlibli.push(data_barang_id);
            tempImageContainerBlibli.push($(item)[0].files[0]);
        });

        //$('.foto_produk_var_blibli_2').each(function (i, item) {
        //    var data_barang_id = $(item).attr("data-barang-id");
        //    listGambarVariant.append(data_barang_id + '_2', $(item)[0].files[0]);
        //});

        @*$.ajax({
            type: "POST",
            url: '@Url.Action("UpdateGambarVariantBlibli", "Manage")',
            data: listGambarVariant,
            dataType: 'json',
            processData: false,
            contentType: false,
            success: function (response) {
                UpdateHjualVariantBarang();
            },
            error: function (xhr) {
                console.log(xhr);
            }
        });*@

        if (tempDataBrgIdBlibli.length == tempImageContainerBlibli.length) {
                    for (var i = 0; i < tempImageContainerBlibli.length; i++) {
                        var listGambarVariant2 = new FormData();
                        listGambarVariant2.append(tempDataBrgIdBlibli[i], tempImageContainerBlibli[i]);
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("UpdateGambarVariantBlibli", "Manage")',
                            data: listGambarVariant2,
                            dataType: 'json',
                            processData: false,
                            contentType: false,
                            success: function (response) {
                                tempSuccessSaveImageBlibli.push(tempImageContainerBlibli[i]);
                                if (tempSuccessSaveImageBlibli.length == tempImageContainerBlibli.length) {
                                        UpdateHjualVariantBarang();
                                }
                            },
                            error: function (xhr) {
                                console.log(xhr);
                            }
                        });
                    }

        }
    }

    var validasi_simpanBarangVariant = true;
    function simpanBarangVariant() {
        if (confirm('Selesai setting gambar dan harga per variasi ?')) {
            validasi_simpanBarangVariant = true;
            message_validasi_simpanBarangVariant = "";

            if (validasi_simpanBarangVariant) {
                var idBarang = $('#gambarInduk_ID').val();
                var listGambarVariant = new FormData();
                $('#loading_spinner').show();
                tempDataBrgId.length = 0;
                tempImageContainer.length = 0;
                tempSuccessSaveImage.length = 0;

                var index_gambar = 1;
                $('.foto_produk_induk').each(function (i, item) {
                    var data_barang_id = $(item).attr("data-barang-id");
                    listGambarVariant.append(data_barang_id + '_' + index_gambar, $(item)[0].files[0]);
                    tempDataBrgId.push(data_barang_id + '_' + index_gambar);
                    tempImageContainer.push($(item)[0].files[0]);
                    index_gambar = index_gambar + 1;
                    //if (imageContainerInduk[i]) {
                    //    listGambarVariant.append(data_barang_id + '_' + index_gambar, imageContainerInduk[i]);
                    //    index_gambar = index_gambar + 1;
                    //    totalSizeUpload = totalSizeUpload + imageContainerInduk[i].size;
                    //}
                });

                $('.foto_produk_var').each(function (i, item) {
                    var data_barang_id = $(item).attr("data-barang-id");
                    listGambarVariant.append(data_barang_id, $(item)[0].files[0]);
                    tempDataBrgId.push(data_barang_id);
                    tempImageContainer.push($(item)[0].files[0]);
                    //if (imageContainerVar[i]) {
                    //    listGambarVariant.append(data_barang_id, imageContainerVar[i]);
                    //    totalSizeUpload = totalSizeUpload + imageContainerInduk[i].size;
                    //}
                });

                //$('.foto_produk_var_2').each(function (i, item) {
                //    var data_barang_id = $(item).attr("data-barang-id");
                //    listGambarVariant.append(data_barang_id + '_2', $(item)[0].files[0]);
                //});

                //if (totalSizeUpload > 4194304) {
                //    alert("Max size upload 4194304. Size " + totalSizeUpload + ".")
                //} else {
                if (tempDataBrgId.length == tempImageContainer.length) {
                    for (var i = 0; i < tempImageContainer.length; i++) {
                        var listGambarVariant1 = new FormData();
                        listGambarVariant1.append(tempDataBrgId[i], tempImageContainer[i]);
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("UpdateGambarVariantBarang", "Manage")',
                            //data: listGambarVariant,
                            data: listGambarVariant1,
                            dataType: 'json',
                            processData: false,
                            contentType: false,
                            success: function (response) {
                                tempSuccessSaveImage.push(tempImageContainer[i]);
                                if (tempSuccessSaveImage.length == tempImageContainer.length) {
                                    if ($('.foto_produk_var_blibli').length > 0) {
                                        UpdateGambarVariantBarangBlibli();
                                    }
                                    else {
                                        $('#loading_spinner').hide();
                                        UpdateHjualVariantBarang();
                                    }
                                }
                            },
                            error: function (xhr) {
                                $('#loading_spinner').hide();
                                console.log(xhr);
                            }
                        });
                    }

                } else {
                    $('#loading_spinner').hide();
                }
                //}
            }
            else {
                $('#loading_spinner').hide();
                if (message_validasi_autoloadStf02Variant != "") {
                    alert(message_validasi_autoloadStf02Variant);
                    
                }
            }
        }
    }
    function UpdateHjualVariantBarang() {
        var newHjual = [];
        $('#variant-section input[data-jenis="hjual_var"]').each(function (i, item) {
            newHjual[i] = {
                recnum: $(item).attr("data-hjual-recnum"),
                hjual: convertToAngka($(item).val())
            };
        });

        var post_data = {
            brg: $('#Stf02_BRG').val(),
            newhjual: newHjual
        }

        $.ajax({
            type: "POST",
            url: '@Url.Action("UpdateHjualVariantBarang", "Manage")',
            data: post_data,
            beforeSend: function () {
                $('#loading_spinner').show();
            },
            success: function (response) {
                if (response.Errors == null) {
                    //remark by calvin 26 april 2019
                    //$('#table-barang-1-partial').html(response);
                    //Initialize();
                    //end remark by calvin 26 april 2019
                    $('#close-editor-1').click();
                    $("html, body").animate({ scrollTop: 0 }, "slow");
                    $('#loading_spinner').hide();
                    refreshTableBarang();
                } else {
                    if (response.errorHargaPerMP == null) {
                        //console.log(response.Errors);
                        alert(response.Errors[0]);
                    } else {
                        //response.Errors.forEach(setErrorfield);
                        alert(response.errorHargaPerMP);
                    }
                    //alert('Ada data yang tidak valid!');
                }
                $('#loading_spinner').hide();
            },
            error: function (xhr) {
                console.log(xhr);
            }
        });
    }

    //add by nurul 6/3/2020
    function dataURLtoFile(dataurl, filename) {
        var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
            bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
        while (n--) {
            u8arr[n] = bstr.charCodeAt(n);
        }
        return new File([u8arr], filename, { type: mime });
    }
    //end add by nurul 6/3/2020

</script>
<div class="form-horizontal">
    <div id="variant-section">
        <table style="width:100%">
            <tr>
                <td style="width:100%">
                    <ul id="variant-tabs-2" class="nav nav-tabs">
                        <li><a data-toggle="tab" href="#masteronline_detail_tab_variant_2">Master Online</a></li>
                        @{
                            var listMarket = Model.ListMarket;
                            var adaElevenia_variant = 0;
                            var adaBlibli_variant = 0;
                            var adaBukalapak_variant = 0;
                            var adaLazada_variant = 0;
                            var adaShopee_variant = 0;
                            var adaTokped_variant = 0;
                            var adaJdid_variant = 0;
                        }
                        @for (var i = 0; i < listMarket.ToList().Count; i++)
                        {
                            var idMarket = Convert.ToInt32(listMarket[i].NAMA);
                            if (idMarket == 9)
                            {
                                adaElevenia_variant = 1;
                            }
                            else if (idMarket == 16)
                            {
                                adaBlibli_variant = 1;
                            }
                            else if (idMarket == 8)
                            {
                                adaBukalapak_variant = 1;
                            }
                            else if (idMarket == 7)
                            {
                                adaLazada_variant = 1;
                            }
                            else if (idMarket == 17)
                            {
                                adaShopee_variant = 1;
                            }
                            else if (idMarket == 15)
                            {
                                adaTokped_variant = 1;
                            }
                            else if (idMarket == 19)
                            {
                                adaJdid_variant = 1;
                            }
                        }
                        @if (adaShopee_variant == 1)
                        {
                            <li><a data-toggle="tab" href="#shopee_detail_tab_variant_2">Shopee</a></li>
                        }
                        @if (adaTokped_variant == 1)
                        {
                            <li><a data-toggle="tab" href="#tokped_detail_tab_variant_2">Tokopedia</a></li>
                        }
                        @if (adaLazada_variant == 1)
                        {
                            <li><a data-toggle="tab" href="#lazada_detail_tab_variant_2">Lazada</a></li>
                        }
                        @if (adaBlibli_variant == 1)
                        {
                            <li><a data-toggle="tab" href="#blibli_detail_tab_variant_2">Blibli</a></li>
                        }
                        @if (adaElevenia_variant == 1)
                        {
                            <li><a data-toggle="tab" href="#elevenia_detail_tab_variant_2">Elevenia</a></li>
                        }
                        @if (adaJdid_variant == 1)
                        {
                            <li><a data-toggle="tab" href="#jdid_detail_tab_variant_2">JD.ID</a></li>
                        }
                    </ul>
                </td>
            </tr>
        </table>
        <div class="tab-content">
            <div id="masteronline_detail_tab_variant_2" class="tab-pane fade in active">
                <div class="row" style="padding-top:10px">
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="x_panel" id="upload-foto-section">
                                <div class="x_title">
                                    <h2 style="font-size: 16px">Foto Produk Induk</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li>
                                            <a class="collapse-link" id="collapse-link-upload-foto-section"><i class="fa fa-chevron-up"></i></a>
                                        </li>
                                    </ul>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="x_content">
                                    <div class="row">
                                        <div class="col-md-2 foto_produk_section" style="text-align:center;">
                                            <div class="box_upload_var" id="box_upload_induk_1">
                                                <span class="box_upload_placeholder">Tambah Gambar</span>
                                                <input type='file' id='foto_produk_induk_1' data-barang-id="@(Model.gambarInduk?.ID)" name="foto_produk_induk_1" class="foto_produk_induk" accept=".jpg" />
                                                <input type="hidden" id="hidden_url_gambar_induk_1" value="@(Model.gambarInduk?.LINK_GAMBAR_1)" />
                                            </div>
                                            <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var" id="btn_hapus_induk_1">Hapus</button>
                                        </div>
                                        <div class="col-md-2 foto_produk_section" style="text-align:center;">
                                            <div class="box_upload_var" id="box_upload_induk_2">
                                                <span class="box_upload_placeholder">Tambah Gambar</span>
                                                <input type='file' id='foto_produk_induk_2' data-barang-id="@(Model.gambarInduk?.ID)" name="foto_produk_induk_2" class="foto_produk_induk" accept=".jpg" />
                                                <input type="hidden" id="hidden_url_gambar_induk_2" value="@(Model.gambarInduk?.LINK_GAMBAR_2)" />
                                            </div>
                                            <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var" id="btn_hapus_induk_2">Hapus</button>
                                        </div>
                                        <div class="col-md-2 foto_produk_section" style="text-align:center;">
                                            <div class="box_upload_var" id="box_upload_induk_3">
                                                <span class="box_upload_placeholder">Tambah Gambar</span>
                                                <input type='file' id='foto_produk_induk_3' data-barang-id="@(Model.gambarInduk?.ID)" name="foto_produk_induk_3" class="foto_produk_induk" accept=".jpg" />
                                                <input type="hidden" id="hidden_url_gambar_induk_3" value="@(Model.gambarInduk?.LINK_GAMBAR_3)" />
                                            </div>
                                            <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var" id="btn_hapus_induk_3">Hapus</button>
                                        </div>
                                        <div class="col-md-2 foto_produk_section" style="text-align:center;">
                                            <div class="box_upload_var" id="box_upload_induk_4">
                                                <span class="box_upload_placeholder">Tambah Gambar</span>
                                                <input type='file' id='foto_produk_induk_4' data-barang-id="@(Model.gambarInduk?.ID)" name="foto_produk_induk_4" class="foto_produk_induk" accept=".jpg" />
                                                <input type="hidden" id="hidden_url_gambar_induk_4" value="@(Model.gambarInduk?.LINK_GAMBAR_4)" />
                                            </div>
                                            <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var" id="btn_hapus_induk_4">Hapus</button>
                                        </div>
                                        <div class="col-md-2 foto_produk_section" style="text-align:center;">
                                            <div class="box_upload_var" id="box_upload_induk_5">
                                                <span class="box_upload_placeholder">Tambah Gambar</span>
                                                <input type='file' id='foto_produk_induk_5' data-barang-id="@(Model.gambarInduk?.ID)" name="foto_produk_induk_5" class="foto_produk_induk" accept=".jpg" />
                                                <input type="hidden" id="hidden_url_gambar_induk_5" value="@(Model.gambarInduk?.LINK_GAMBAR_5)" />
                                            </div>
                                            <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var" id="btn_hapus_induk_5">Hapus</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <table id="datatable_detail_var_mo" class="table table-striped table-bordered dataTable" role="grid" aria-describedby="datatable_info">
                            <thead>
                                <tr role="row">
                                    <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Name: activate to sort column descending" style="width: 20%;">Kode</th>
                                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 30%;">Nama</th>
                                    <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Picture: activate to sort column descending" style="width: 50%;">Gambar</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var barang in Model.VariantMO)
                                {
                                    <tr>
                                        <td>@barang.BRG</td>
                                        <td>@barang.NAMA @barang.NAMA2</td>
                                        <td class="text-center">
                                            <table style="margin:auto;">
                                                <tr>
                                                    <td style="padding-right:5px;">
                                                        <div class="foto_produk_section">
                                                            <div class="box_upload_var" data-barang-id="@barang.ID" id="box_upload_var_@barang.ID">
                                                                <span class="box_upload_placeholder">Tambah Gambar</span>
                                                                <input type='file' id='foto_produk_var_@barang.ID' data-barang-id="@barang.ID" class="foto_produk_var" accept=".jpg" />
                                                                <input type="hidden" id="hidden_url_gambar_var_@barang.ID" data-barang-id="@barang.ID" class="hidden_url_gambar_var" value="@(barang.LINK_GAMBAR_1)" />
                                                            </div>
                                                            <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var" style="margin:0px" data-barang-kode="@barang.BRG" data-barang-id="@barang.ID" id="btn_hapus_var_@barang.ID">Hapus</button>
                                                        </div>
                                                    </td>
                                                    <td style="padding-left:5px;display:none;">
                                                        @* add 6/9/2019, barang varian 2 gambar *@
                                                        <div class="foto_produk_section">
                                                            <div class="box_upload_var_2" data-barang-id="@barang.ID" id="box_upload_var2_@barang.ID">
                                                                <span class="box_upload_placeholder">Tambah Gambar</span>
                                                                <input type='file' id='foto_produk_var2_@barang.ID' data-barang-id="@barang.ID" class="foto_produk_var_2" accept=".jpg" />
                                                                <input type="hidden" id="hidden_url_gambar_var2_@barang.ID" data-barang-id="@barang.ID" class="hidden_url_gambar_var_2" value="@(barang.LINK_GAMBAR_2)" />
                                                            </div>
                                                            <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var_2" style="margin:0px" data-barang-kode="@barang.BRG" data-barang-id="@barang.ID" id="btn_hapus_var2_@barang.ID">Hapus</button>
                                                        </div>
                                                        @* end add 6/9/2019, barang varian 2 gambar *@
                                                    </td>
                                                </tr>
                                            </table>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div id="elevenia_detail_tab_variant_2" class="tab-pane fade in">
            </div>
            <div id="blibli_detail_tab_variant_2" class="tab-pane fade in">
                @for (var i = 0; i < listMarket.ToList().Count; i++)
                {
                    var idMarket = Convert.ToInt32(listMarket[i].NAMA);
                    var recnumArf01 = Convert.ToInt32(listMarket[i].RecNum);
                    if (idMarket == 16)
                    {
                        <div>
                            <h2 style="font-size: 14px">
                                @($"Blibli ({listMarket[i].PERSO})")
                            </h2>
                        </div>
                        <div class="row" style="padding-top:10px">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                <label>Untuk harga normal per variasi blibli, akan menggunakan [Harga Jual *] yg ada di tab barang.</label>
                                <table id="datatable_detail_var_blibli" class="table table-striped table-bordered dataTable" role="grid" aria-describedby="datatable_info">
                                    <thead>
                                        <tr role="row">
                                            <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Name: activate to sort column descending" style="width: 20%;">Kode</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 35%;">Nama</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 15%;">Harga Promosi</th>
                                            <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Picture: activate to sort column descending" style="width: 15%;">Gambar</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 15%;">Status Link Marketplace</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var barang in Model.VariantMO)
                                        {
                                            var VarStf02H = Model.VariantMO_H.Where(p => p.BRG.ToLower() == barang.BRG.ToLower() && p.IDMARKET == recnumArf01).FirstOrDefault();
                                            if (VarStf02H != null)
                                            {
                                                <tr>
                                                    <td>@barang.BRG</td>
                                                    <td>@barang.NAMA @barang.NAMA2</td>
                                                    <td style="text-align:right">
                                                        @Html.TextBox("txtHargaVariantMP_" + VarStf02H.RecNum, String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", VarStf02H.HJUAL), new { @class = "form-control", @style = "text-align:right", @onblur = "ConvertToAngkaRupiah(this);", required = "required", maxlength = "12", data_jenis = "hjual_var", data_hjual_recnum = VarStf02H.RecNum })
                                                    </td>
                                                    <td class="text-center">
                                                        <table style="margin:auto;">
                                                            <tr>
                                                                <td style="padding-right:5px;">
                                                                    <div class="foto_produk_section">
                                                                        <div class="box_upload_var_blibli" data-barang-id="@VarStf02H.RecNum" id="box_upload_var_blibli_@VarStf02H.RecNum">
                                                                            <span class="box_upload_placeholder">Tambah Gambar</span>
                                                                            <input type='file' id='foto_produk_var_blibli_@VarStf02H.RecNum' data-barang-id="@VarStf02H.RecNum" class="foto_produk_var_blibli" accept=".jpg" />
                                                                            <input type="hidden" id="hidden_url_gambar_var_blibli_@VarStf02H.RecNum" data-barang-id="@VarStf02H.RecNum" class="hidden_url_gambar_var_blibli" value="@(VarStf02H.AVALUE_50)" />
                                                                        </div>
                                                                        <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var_blibli" style="margin:0px" data-barang-kode="@barang.BRG" data-barang-id="@VarStf02H.RecNum" id="btn_hapus_var_blibli_@VarStf02H.RecNum">Hapus</button>
                                                                    </div>
                                                                </td>
                                                                <td style="padding-left:5px;display:none;">
                                                                    @* add 6/9/2019, barang varian 2 gambar *@
                                                                    <div class="foto_produk_section">
                                                                        <div class="box_upload_var_blibli_2" data-barang-id="@VarStf02H.RecNum" id="box_upload_var_blibli2_@VarStf02H.RecNum">
                                                                            <span class="box_upload_placeholder">Tambah Gambar</span>
                                                                            <input type='file' id='foto_produk_var_blibli2_@VarStf02H.RecNum' data-barang-id="@VarStf02H.RecNum" class="foto_produk_var_blibli_2" accept=".jpg" />
                                                                            <input type="hidden" id="hidden_url_gambar_var_blibli2_@VarStf02H.RecNum" data-barang-id="@VarStf02H.RecNum" class="hidden_url_gambar_var_blibli_2" value="@(VarStf02H.AVALUE_49)" />
                                                                        </div>
                                                                        <button type="button" class="btn btn-danger btn-small btn_hapus_foto_produk_var_blibli_2" style="margin:0px" data-barang-kode="@barang.BRG" data-barang-id="@VarStf02H.RecNum" id="btn_hapus_var_blibli2_@VarStf02H.RecNum">Hapus</button>
                                                                    </div>
                                                                    @* end add 6/9/2019, barang varian 2 gambar *@
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>


                                                    <td>
                                                        @if (!string.IsNullOrWhiteSpace(VarStf02H.BRG_MP))
                                                        {
                                                            <label>Sukses</label>
                                                        }
                                                    </td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                                @*}*@
                            </div>
                        </div>
                    }
                }
            </div>
            <div id="lazada_detail_tab_variant_2" class="tab-pane fade in">
                @for (var i = 0; i < listMarket.ToList().Count; i++)
                {
                    var idMarket = Convert.ToInt32(listMarket[i].NAMA);
                    var recnumArf01 = Convert.ToInt32(listMarket[i].RecNum);
                    if (idMarket == 7)
                    {
                        <div>
                            <h2 style="font-size: 14px">
                                @($"Lazada ({listMarket[i].PERSO})")
                            </h2>
                        </div>
                        <div class="row" style="padding-top:10px">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                @*@if (string.IsNullOrEmpty(listMarket[i].Sort1_Cust))
                                    {
                                        <label>Gagal Sync, Item tidak akan diupload ke akun ini.</label>
                                    }
                                    else
                                    {*@
                                <table id="datatable_detail_var_lazada" class="table table-striped table-bordered dataTable" role="grid" aria-describedby="datatable_info">
                                    <thead>
                                        <tr role="row">
                                            <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Name: activate to sort column descending" style="width: 20%;">Kode</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 35%;">Nama</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 30%;">Harga</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 15%;">Status Link Marketplace</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var barang in Model.VariantMO)
                                        {
                                            var VarStf02H = Model.VariantMO_H.Where(p => p.BRG.ToLower() == barang.BRG.ToLower() && p.IDMARKET == recnumArf01).FirstOrDefault();
                                            if (VarStf02H != null)
                                            {
                                                <tr>
                                                    <td>@barang.BRG</td>
                                                    <td>@barang.NAMA @barang.NAMA2</td>
                                                    <td style="text-align:right">
                                                        @Html.TextBox("txtHargaVariantMP_" + VarStf02H.RecNum, String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", VarStf02H.HJUAL), new { @class = "form-control", @style = "text-align:right", @onblur = "ConvertToAngkaRupiah(this);", required = "required", maxlength = "12", data_jenis = "hjual_var", data_hjual_recnum = VarStf02H.RecNum })
                                                    </td>
                                                    <td>
                                                        @if (!string.IsNullOrWhiteSpace(VarStf02H.BRG_MP))
                                                        {
                                                            <label>Sukses</label>
                                                        }
                                                    </td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                                @*}*@
                            </div>
                        </div>
                    }
                }
            </div>
            <div id="shopee_detail_tab_variant_2" class="tab-pane fade in">
                @for (var i = 0; i < listMarket.ToList().Count; i++)
                {
                    var idMarket = Convert.ToInt32(listMarket[i].NAMA);
                    var recnumArf01 = Convert.ToInt32(listMarket[i].RecNum);
                    if (idMarket == 17)
                    {
                        <div>
                            <h2 style="font-size: 14px">
                                @($"Shopee ({listMarket[i].PERSO})")
                            </h2>
                        </div>
                        <div class="row" style="padding-top:10px">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                @*@if (string.IsNullOrEmpty(listMarket[i].Sort1_Cust))
                                    {
                                        <label>Gagal Sync, Item tidak akan diupload ke akun ini.</label>
                                    }
                                    else
                                    {*@
                                <table id="datatable_detail_var_shopee" class="table table-striped table-bordered dataTable" role="grid" aria-describedby="datatable_info">
                                    <thead>
                                        <tr role="row">
                                            <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Name: activate to sort column descending" style="width: 20%;">Kode</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 35%;">Nama</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 30%;">Harga</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 15%;">Status Link Marketplace</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var barang in Model.VariantMO)
                                        {
                                            var VarStf02H = Model.VariantMO_H.Where(p => p.BRG.ToLower() == barang.BRG.ToLower() && p.IDMARKET == recnumArf01).FirstOrDefault();
                                            if (VarStf02H != null)
                                            {
                                                <tr>
                                                    <td>@barang.BRG</td>
                                                    <td>@barang.NAMA @barang.NAMA2</td>
                                                    <td style="text-align:right">
                                                        @Html.TextBox("txtHargaVariantMP_" + VarStf02H.RecNum, String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", VarStf02H.HJUAL), new { @class = "form-control", @style = "text-align:right", @onblur = "ConvertToAngkaRupiah(this);", required = "required", maxlength = "12", data_jenis = "hjual_var", data_hjual_recnum = VarStf02H.RecNum })
                                                    </td>
                                                    <td>
                                                        @if (!string.IsNullOrWhiteSpace(VarStf02H.BRG_MP))
                                                        {
                                                            <label>Sukses</label>
                                                        }
                                                    </td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                                @*}*@
                            </div>
                        </div>
                    }
                }
            </div>
            <div id="tokped_detail_tab_variant_2" class="tab-pane fade in">
                @for (var i = 0; i < listMarket.ToList().Count; i++)
                {
                    var idMarket = Convert.ToInt32(listMarket[i].NAMA);
                    var recnumArf01 = Convert.ToInt32(listMarket[i].RecNum);
                    if (idMarket == 15)
                    {
                        <div>
                            <h2 style="font-size: 14px">
                                @($"Tokopedia ({listMarket[i].PERSO})")
                            </h2>
                        </div>
                        <div class="row" style="padding-top:10px">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                @*@if (string.IsNullOrEmpty(listMarket[i].Sort1_Cust))
                                    {
                                        <label>Gagal Sync, Item tidak akan diupload ke akun ini.</label>
                                    }
                                    else
                                    {*@
                                <table id="datatable_detail_var_tokped" class="table table-striped table-bordered dataTable" role="grid" aria-describedby="datatable_info">
                                    <thead>
                                        <tr role="row">
                                            <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Name: activate to sort column descending" style="width: 20%;">Kode</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 35%;">Nama</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 30%;">Harga</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 15%;">Status Link Marketplace</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var barang in Model.VariantMO)
                                        {
                                            var VarStf02H = Model.VariantMO_H.Where(p => p.BRG.ToLower() == barang.BRG.ToLower() && p.IDMARKET == recnumArf01).FirstOrDefault();
                                            if (VarStf02H != null)
                                            {
                                                <tr>
                                                    <td>@barang.BRG</td>
                                                    <td>@barang.NAMA @barang.NAMA2</td>
                                                    <td style="text-align:right">
                                                        @Html.TextBox("txtHargaVariantMP_" + VarStf02H.RecNum, String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", VarStf02H.HJUAL), new { @class = "form-control", @style = "text-align:right", @onblur = "ConvertToAngkaRupiah(this);", required = "required", maxlength = "12", data_jenis = "hjual_var", data_hjual_recnum = VarStf02H.RecNum })
                                                    </td>
                                                    <td>
                                                        @if (!string.IsNullOrWhiteSpace(VarStf02H.BRG_MP))
                                                        {
                                                            <label>Sukses</label>
                                                        }
                                                    </td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                                @*}*@
                            </div>
                        </div>
                    }
                }
            </div>
            <div id="jdid_detail_tab_variant_2" class="tab-pane fade in">
                @for (var i = 0; i < listMarket.ToList().Count; i++)
                {
                    var idMarket = Convert.ToInt32(listMarket[i].NAMA);
                    var recnumArf01 = Convert.ToInt32(listMarket[i].RecNum);
                    if (idMarket == 19)
                    {
                        <div>
                            <h2 style="font-size: 14px">
                                @($"JD.ID ({listMarket[i].PERSO})")
                            </h2>
                        </div>
                        <div class="row" style="padding-top:10px">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                @*@if (string.IsNullOrEmpty(listMarket[i].Sort1_Cust))
                                    {
                                        <label>Gagal Sync, Item tidak akan diupload ke akun ini.</label>
                                    }
                                    else
                                    {*@
                                <table id="datatable_detail_var_jdid" class="table table-striped table-bordered dataTable" role="grid" aria-describedby="datatable_info">
                                    <thead>
                                        <tr role="row">
                                            <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Name: activate to sort column descending" style="width: 20%;">Kode</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 35%;">Nama</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 30%;">Harga</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 15%;">Status Link Marketplace</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var barang in Model.VariantMO)
                                        {
                                            var VarStf02H = Model.VariantMO_H.Where(p => p.BRG.ToLower() == barang.BRG.ToLower() && p.IDMARKET == recnumArf01).FirstOrDefault();
                                            if (VarStf02H != null)
                                            {
                                                <tr>
                                                    <td>@barang.BRG</td>
                                                    <td>@barang.NAMA @barang.NAMA2</td>
                                                    <td style="text-align:right">
                                                        @Html.TextBox("txtHargaVariantMP_" + VarStf02H.RecNum, String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", VarStf02H.HJUAL), new { @class = "form-control", @style = "text-align:right", @onblur = "ConvertToAngkaRupiah(this);", required = "required", maxlength = "12", data_jenis = "hjual_var", data_hjual_recnum = VarStf02H.RecNum })
                                                    </td>
                                                    <td>
                                                        @if (!string.IsNullOrWhiteSpace(VarStf02H.BRG_MP))
                                                        {
                                                            <label>Sukses</label>
                                                        }
                                                    </td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                                @*}*@
                            </div>
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</div>

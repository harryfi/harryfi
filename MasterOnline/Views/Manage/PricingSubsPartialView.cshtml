@using System.Globalization
@using MasterOnline.ViewModels
@model MasterOnline.ViewModels.SubsViewModel

@{
    var context = new MoDbContext();
    var dataSession = Session["SessionInfo"] as AccountUserViewModel;

    var kodeSubs = "";
    var tglBerakhir = "";
    if (dataSession?.User != null)
    {
        var accId = context.User.Single(u => u.Username == dataSession.User.Username).AccountId;
        kodeSubs = context.Account.Single(a => a.AccountId == accId).KODE_SUBSCRIPTION;
        tglBerakhir = context.Account.Single(a => a.AccountId == accId).TGL_SUBSCRIPTION?.ToString("dd/MM/yyyy");
        context.Dispose();
    }
    else
    {
        kodeSubs = dataSession?.Account?.KODE_SUBSCRIPTION;
        tglBerakhir = dataSession?.Account?.TGL_SUBSCRIPTION?.ToString("dd/MM/yyyy");
    }
}

<div class="snip1404">
    <div>
        <label>
            Selamat bisnis Anda telah berkembang! Saat ini status keanggotaan Anda ialah sebagai berikut,
        </label>
        <p>
            Jenis Langganan:
            <span style="color: #2ac52a;">
                @{
                    switch (kodeSubs)
                    {
                        case "01":
                            @("FREE")
                            break;
                        case "02":
                            @("BASIC")
                            break;
                        case "03":
                            @("PREMIUM")
                            break;
                    }
                }
            </span>
        </p>
        <p>Tanggal Berakhir: <span style="color: red;">@tglBerakhir</span></p>
        @if (kodeSubs != "01")
        {
            <button style="margin-bottom: 35px;" class="btn btn-danger" data-toggle="modal" data-target="#konfBerhentiBerlangganan" type="button" id="btn_unsubscribe">Berhenti Berlangganan</button>
        }
    </div>
    @foreach (var subs in Model?.ListSubs)
    {
        <div class="plan @(subs.KODE == "02" ? "featured" : null)">
            <header>
                <h4 class="plan-title">
                    @subs.KETERANGAN
                </h4>
                <div class="plan-cost">
                    <span class="plan-price">Rp @String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", subs.HARGA)</span>
                    <span class="plan-type">/bulan</span>
                </div>
            </header>
            <ul class="plan-features">
                <li><i class="ion-checkmark"> </i>@subs.JUMLAH_MP marketplace</li>
                <li><i class="ion-checkmark"> </i>@(subs.JUMLAH_PESANAN == 999999999 ? "> 100" : subs.JUMLAH_PESANAN.ToString()) pesanan / bulan</li>
                @*<li><i class="ion-checkmark"> </i>Unlimited Email</li>
                    <li><i class="ion-checkmark"> </i>250Gb mo Transfer</li>
                    <li><i class="ion-checkmark"> </i>24/7 Tech Support</li>
                    <li><i class="ion-checkmark"> </i>Daily Backups</li>*@
            </ul>
            @*<div class="plan-select"><a href="">@(subs.KODE == kodeSubs ? "Tetap Paket Ini" : "Pindah Paket Ini")</a></div>*@
            <div class="text-center btn-section" style="@(subs.KODE == "01" ? "margin-top: 56px;" : null)">
                @if (subs.KODE != "01")
                {
                    <button id="btn_times_" type="button" class="btn">3x</button>
                    <button type="button" class="btn">6x</button>
                    <button type="button" class="btn">12x</button>
                }
            </div>
            <div class="plan-select" onclick="clickSub(String(@subs.KODE))"><a>@(subs.KODE == kodeSubs ? "Tetap Paket Ini" : "Pindah Paket Ini")</a></div>
        </div>
    }
</div>
<div class="text-center" style="margin-top: -15px; border-radius: 10px; padding-top: 40px; padding-bottom: 10px; background: #ffffff6b;">
    <img src="~/Content/Images/payment_logo.png" width="50%" />
</div>


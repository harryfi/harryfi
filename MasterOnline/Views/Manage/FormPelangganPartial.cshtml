@using System.Globalization
@using MasterOnline.ViewModels
@model MasterOnline.ViewModels.CustomerViewModel
@{
    //var dataSession = Session["SessionInfo"] as AccountUserViewModel;
    var username = "";
    var context = new MoDbContext("");
    //if (dataSession?.User != null)
    //{
    //    //var accId = context.User.Single(u => u.Username == dataSession.User.Username).AccountId;
    //    var accId = context.User.Single(u => u.UserId == dataSession.User.UserId).AccountId;
    //    username = context.Account.Single(a => a.AccountId == accId).Username;
    //    //remark by calvin 3 desember 2018
    //    //context.Dispose();
    //    //end remark by calvin 3 desember 2018
    //}
    //else
    //{
    //    username = dataSession?.Account.Username;
    //}

    var sessionAccount = HttpContext.Current.Session["SessionAccount"];
    var sessionAccountUserID = HttpContext.Current.Session["SessionAccountUserID"];
    var sessionAccountUserName = HttpContext.Current.Session["SessionAccountUserName"];
    var sessionAccountEmail = HttpContext.Current.Session["SessionAccountEmail"];
    var sessionAccountTglSub = HttpContext.Current.Session["SessionAccountTglSub"];
    var sessionAccountKodeSub = HttpContext.Current.Session["SessionAccountKodeSub"];
    var sessionAccountDataSourcePathDebug = HttpContext.Current.Session["SessionAccountDataSourcePathDebug"];
    var sessionAccountDataSourcePath = HttpContext.Current.Session["SessionAccountDataSourcePath"];
    var sessionAccountDatabasePathErasoft = HttpContext.Current.Session["SessionAccountDatabasePathErasoft"];

    var sessionUser = System.Web.HttpContext.Current.Session["SessionUser"];
    var sessionUserUserID = System.Web.HttpContext.Current.Session["SessionUserUserID"];
    var sessionUserUsername = System.Web.HttpContext.Current.Session["SessionUserUsername"];
    var sessionUserEmail = System.Web.HttpContext.Current.Session["SessionUserEmail"];
    var sessionUserAccountID = System.Web.HttpContext.Current.Session["SessionUserAccountID"];

    if (sessionUser != null)
    {
        var usrID = Convert.ToInt64(sessionUserUserID);
        var accId = context.User.Single(u => u.UserId == usrID).AccountId;
        username = context.Account.Single(a => a.AccountId == accId).Username;
    }
    else
    {
        username = sessionAccountUserName.ToString();
    }

    if (username.Length > 20)
    {
        username = username.Substring(0, 17) + "...";
    }
}
@Html.AntiForgeryToken()
@Html.HiddenFor(m => m.Customers.USERNAME, new { Value = username })
@Html.HiddenFor(m => m.Customers.KLINK, new { Value = "1" })
@Html.HiddenFor(m => m.Customers.TGL_INPUT, new { Value = DateTime.Now.ToString("dd/MM/yyyy") })
@Html.HiddenFor(m => m.Customers.RecNum)
@Html.HiddenFor(m => m.Customers.AL, new { Value = "." })
@Html.HiddenFor(m => m.Customers.TLP, new { Value = "." })
@Html.HiddenFor(m => m.Customers.KODEKABKOT, new { Value = "3174" })
@Html.HiddenFor(m => m.Customers.KODEPOS, new { Value = "." })
@Html.HiddenFor(m => m.Customers.KODEPROV, new { Value = "31" })
@Html.HiddenFor(m => m.Customers.TOP, new { Value = "1" })

@Html.HiddenFor(m => m.Customers.Sort1_Cust)
@Html.HiddenFor(m => m.Customers.API_CLIENT_P)
@Html.HiddenFor(m => m.Customers.API_CLIENT_U)
@Html.HiddenFor(m => m.Customers.API_KEY)

<script type="text/javascript">

    $(document).ready(function () {
        Initialize();
        initRequired();


        //$(function () {
        //    $('#setting-detail-market-tabs a:first').tab('show');
        //});

    });

</script>
<div class="form-horizontal">
    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="" role="tabpanel" data-example-id="togglable-tabs">
                <ul id="customerTab" class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active">
                        <a href="#tab_content_marketplace" id="marketplace-tab" role="tab" data-toggle="tab" aria-expanded="true">Detail Marketplace/Customer</a>
                    </li>
                    <li role="presentation" class="">
                        <a href="#tab_content_gudang" role="tab" id="gudang-tab" aria-expanded="false" @*class="disabled-tab"*@>Gudang</a>
                    </li>
                </ul>
                <div id="customerTabContent" class="tab-content" style="padding-top:10px">
                    <div role="tabpanel" class="tab-pane fade active in" id="tab_content_marketplace" aria-labelledby="marketplace-tab">
                        <div class="row">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                <div class="x_panel">
                                    <div class="x_title">
                                        <h2 style="font-size: 16px">Detail Marketplace / Customer</h2>
                                        <ul class="nav navbar-right panel_toolbox">
                                            <li>
                                                <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                            </li>
                                        </ul>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="x_content">
                                        <br>
                                        <div class="form-group">
                                            @Html.LabelFor(m => m.Customers.CUST, "Kode", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                @Html.HiddenFor(m => m.Customers.CUST)
                                                @if (Model.Customers != null)
                                                {
                                                    <input type="text" value="@Model.Customers.CUST" disabled class="form-control" />
                                                }
                                                else
                                                {
                                                    <input id="CUSTNUMBER" type="text" value="[AUTO]" disabled class="form-control" />
                                                }
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            @Html.LabelFor(m => m.Customers.NAMA, "Nama Marketplace *", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                @Html.HiddenFor(m => m.Customers.NAMA)
                                                <select id="MARKET" placeholder="Harap pilih" required="required"></select>
                                            </div>
                                        </div>
                                        <div class="form-group" id="versi-blibli" hidden="hidden">
                                            @Html.LabelFor(m => m.Customers.KD_ANALISA, "Versi *", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                                            <div class="col-md-6 col-sm-6 col-xs-12" id="divCBVersi">
                                                @Html.HiddenFor(m => m.Customers.KD_ANALISA)
                                                @*<select style="display:none" single class="selectize-dropdown single" id="Customers_KD_ANALISA" placeholder="Harap pilih"></select>*@
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            @Html.LabelFor(m => m.Customers.PERSO, "Nama Akun *", new { @class = "control-label col-md-3 col-sm-3 col-xs-12", id = "id-nama-akun" })
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                @Html.TextBoxFor(m => m.Customers.PERSO, new { @class = "form-control", required = "required", id = "txt-nama-akun" })
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            @Html.LabelFor(m => m.Customers.MULTI_LOKASI, "Multi Lokasi", new { @class = "control-label col-md-4 col-sm-4 col-xs-12" })
                                            @Html.HiddenFor(m => m.Customers.MULTI_LOKASI, new { data_cbx = $"cbx-MultiLokasi", @class = "cbxMultiLokasi" })
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                @if ((Model.Customers == null ? "" : Model.Customers.MULTI_LOKASI) == "1")
                                                {
                                                    //memiliki multi lokasi
                                                    <label class="checkbox-container">
                                                        <input type="checkbox" id="cbx_MultiLokasi" class="cbxMulti" name="@($"cbx-Multi-Lokasi")" checked />
                                                        <span class="checkmark cm-multilokasi"></span>
                                                    </label>
                                                }
                                                else
                                                {
                                                    <label class="checkbox-container">
                                                        <input type="checkbox" id="cbx_MultiLokasi" class="cbxMulti" name="@($"cbx-Multi-Lokasi")" />
                                                        <span class="checkmark cm-multilokasi"></span>
                                                    </label>
                                                }
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            @Html.LabelFor(m => m.Customers.EMAIL, "Email Akun *", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                @Html.TextBoxFor(m => m.Customers.EMAIL, new { @class = "form-control", @autocomplete = "off", type = "email", required = "required" })
                                            </div>
                                        </div>
                                        <div id="BlibliSellerID" class="form-group"></div>
                                        <div class="form-group" id="password-akun">
                                            @Html.LabelFor(m => m.Customers.PASSWORD, "Password Akun *", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                @Html.TextBoxFor(m => m.Customers.PASSWORD, new { @class = "form-control", @autocomplete = "off", type = "password", required = "required" })
                                            </div>
                                        </div>
                                        <div id="blibliAPIKey" class="form-group">
                                        </div>
                                        <div class="form-group" id="status-sync">
                                            @Html.LabelFor(m => m.Customers.TIDAK_HIT_UANG_R, "Status Sync Pesanan & Stok", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                                            <div class="col-md-6 col-sm-6 col-xs-12">
                                                @Html.HiddenFor(m => m.Customers.TIDAK_HIT_UANG_R)
                                                <select style="display:none" single class="selectize-dropdown single" id="Customers_TIDAK_HIT_UANG_R" placeholder="Harap pilih" required="disabled"></select>
                                            </div>
                                        </div>
                                        @*add by nurul 28/4/2021*@
                                        <div id="JDShopId" class="form-group">
                                        </div>
                                        @*add by nurul 28/4/2021*@
                                        <div class="form-group">
                                            <div id="divAPIKey"></div>
                                            <div class="col-md-2 col-sm-2 col-xs-6" id="buttonGen"></div>
                                        </div>
                                        <div id="descAPIKey" class="form-group">
                                            <div id="emptyDiv" class=" col-md-3 col-sm-3 col-xs-1"></div>
                                            @*<label id="lblDesc" style="visibility:hidden">API key harus terisi untuk dapat terintegrasi dengan marketplace.</label>*@
                                            <label id="lblDesc" style="visibility:hidden">API key adalah kode yang harus diisi untuk dapat terkoneksi dengan marketplace.</label>
                                            <br />
                                            @*<label id="lblDesc2" style="visibility:hidden">API key harus terisi untuk dapat terintegrasi dengan marketplace.</label>*@
                                            <label id="lblDesc2" style="visibility:hidden">API key adalah kode yang harus diisi untuk dapat terkoneksi dengan marketplace.</label>
                                            <label id="lblPopUp" style="visibility:hidden;color:blue" onclick="openModalDesc(MARKET.value)"><u>Di Sini</u></label>
                                            <div id="emptyDiv2" class=" col-md-3 col-sm-3 col-xs-1"></div>
                                        </div>
                                        <div id="BlibliMerchantID" class="form-group">
                                        </div>
                                        <div id="BlibliClient" class="form-group">
                                        </div>
                                        <div id="BlibliClientPass" class="form-group">
                                        </div>
                                        @*add by Tri 10/04/2019*@
                                        <div id="JDAppSecret" class="form-group">
                                        </div>
                                        <div id="JDAccessToken" class="form-group">
                                        </div>
                                        @*end add by Tri 10/04/2019*@
                                        @*add by nurul 24/10/2018*@
                                        <div id="descAPIKey2" class="form-group">
                                            <div id="emptyDiv3" class="col-md-3 col-sm-3 col-xs-1"></div>
                                            <label id="lblDesc3" style="visibility:hidden">1. Untuk dapat tersambung secara otomatis ke Tokopedia, Anda harus terdaftar sebagai official store (pemegang merk). Apabila Anda sudah terdaftar sebagai official store di Tokopedia, silahkan hubungi customer service kami.</label>
                                            <br />
                                            <label id="lblDesc4" style="visibility:hidden"></label>
                                            <div id="emptyDiv4" class="col-md-3 col-sm-3 col-xs-1"></div>
                                        </div>
                                        @*end add by nurul 24/10/2018*@
                                        @*add by nurul 25/03/2019*@
                                        <div id="TokpedShopID" class="form-group">
                                        </div>
                                        <div id="LabelTokped1" class="form-group">
                                        </div>
                                        <div id="LabelTokped2" class="form-group">
                                        </div>
                                        @*end add by nurul 25/03/2019*@
                                        @*<input type="button" class="btn btn-primary pull-right" value="Simpan" id="simpan_btn" onclick="simpanCustomer(this)" />*@
                                        <input type="button" class="btn btn-primary pull-right" value="Simpan" onclick="simpanCustomer(this)" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr />
                        <input type="button" class="btn btn-primary pull-right" id="simpan_btn" value="Simpan" onclick="simpanBarang1(this)" />
                        <input type="button" style="display:none" class="btn btn-primary pull-right" id="next_btn" value="Lanjut Ke Tab Variasi" onclick="simpanBarangInduk(this)" />
                    </div>
                    <div role="tabpanel" class="tab-pane fade in" id="tab_content_gudang" aria-labelledby="gudang-tab">
                        <div class="row" style="padding-bottom:10px">
                            @Html.Label("labelInfoCust", "Kode", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                            <div class="col-md-7 col-sm-7 col-xs-12">
                                @Html.TextBox("txtInfoCust", "", new { @class = "form-control", disabled = "disabled" })
                            </div>
                        </div>
                        <div class="row" style="padding-bottom:10px">
                            @Html.Label("labelInfoNamaMp", "Nama Marketplace", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                            <div class="col-md-7 col-sm-7 col-xs-12">
                                @Html.TextBox("txtInfoNamaMp", "", new { @class = "form-control", disabled = "disabled" })
                            </div>
                        </div>
                        <div class="row" style="padding-bottom:10px">
                            @Html.Label("labelInfoNamaAkun", "Nama Akun", new { @class = "control-label col-md-3 col-sm-3 col-xs-12" })
                            <div class="col-md-7 col-sm-7 col-xs-12">
                                @Html.TextBox("txtInfoNamaAkun", "", new { @class = "form-control", disabled = "disabled" })
                            </div>
                        </div>
                        <input id="txtNewParent" style="display:none;" />
                        <div class="row">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                <div class="x_panel">
                                    <div class="x_title">
                                        <h2 style="font-size: 16px">Mapping Gudang</h2>
                                        <ul class="nav navbar-right panel_toolbox">
                                            <li>
                                                <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                            </li>
                                        </ul>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="x_content">
                                        <div id="loading_mapping_gudang" class="text-center">
                                            <img src="~/Content/Images/spinner.gif" width="100" />
                                        </div>
                                        <div id="var-mapping-gudang">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr />
                        <input type="button" style="display:none" class="btn btn-primary pull-right" id="simpan_variant_btn" value="Simpan" onclick="simpanBarangVariant(this)" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@using System.Globalization
@model MasterOnline.ViewModels.PesananViewModel
<table id="datatable_sedangproses" class="table table-striped table-bordered dataTable" role="grid" aria-describedby="datatable_info">
    <thead>
        <tr role="row">
            <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Name: activate to sort column descending" style="width: 90px;">No. Order</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Position: activate to sort column ascending" style="width: 100px;">Tanggal Pesanan</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Office: activate to sort column ascending" style="width: 50px;">Marketplace</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Age: activate to sort column ascending" style="width: 90px;">Pembeli</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Start date: activate to sort column ascending" style="width: 90px; ">Total</th>
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Salary: activate to sort column ascending" style="width: 60px; text-align: center;">Gd & Qty</th>
            @* change by nurul 8/10/2018<th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending" style="width: 50px; max-width: 50px; text-align: center;">Kirim</th>*@
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending" style="width: 50px; max-width: 50px; text-align: center;">Ubah Status</th>
            @*<th class="sorting text-center" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending" style="width: 10px; max-width: 10px; border-left:hidden"><input type="checkbox" class="dt-checkboxes-select-all" id="checkbox_all_gntstatus_packing" style="border-left:hidden" /></th>*@
            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending" style="width: 80px;">Undo Status</th>
            @*<th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending" style="width: 50px; max-width: 50px;">Hapus</th>*@
        </tr>
    </thead>
    <tbody>
        @foreach (var pesanan in Model.ListPesanan)
        {
            var buyer = Model.ListPembeli.SingleOrDefault(m => m.BUYER_CODE == pesanan.PEMESAN);
            var pelanggan = Model.ListPelanggan.FirstOrDefault(m => m.CUST == pesanan.CUST);
            var idMarket = 0;
            if (pelanggan != null)
            {
                idMarket = Convert.ToInt32(pelanggan.NAMA);
            }
            var market = Model.ListMarketplace.FirstOrDefault(m => m.IdMarket == idMarket);
            var NamaMarket = "";
            if (market != null)
            {
                NamaMarket = market.NamaMarket;
            }
        <tr>
            <td>@pesanan.NO_BUKTI</td>
            <td>@(pesanan.TGL?.ToString("dd/MM/yyyy"))</td>
            @*<td>@NamaMarket</td> 'change by nurul 14/2/2019*@
            <td>
                @if (pelanggan?.PERSO != null)
                {
                    @(NamaMarket + " (" + pelanggan.PERSO + ")")
                }
                else
                {
                    @NamaMarket
                }
            </td>
            <td>
                @*remark by nurul 24/9/2018 @(buyer.NAMA + " (" + buyer.PERSO + ")")*@
                @*@(buyer == null ? "" : buyer.NAMA + " (" + pelanggan.PERSO + ")")*@
                @(buyer == null ? "" : buyer.NAMA)
            </td>
            <td style="text-align:right">@String.Format(CultureInfo.CreateSpecificCulture("id-id"), "{0:N}", pesanan.NETTO)</td>
            <td class="edit-hapus-col">
                <button class="btn btn-primary" data-toggle="modal" data-target="#modalGudangDanQty" onclick="getBarangForGudangQty('@pesanan.NO_BUKTI', '@pesanan.RecNum')" >
                    <span class="glyphicon glyphicon-th-large" aria-hidden="true"></span>
                </button>
            </td>
            <td class="edit-hapus-col">
                <button class="btn btn-success ubah-packing" id="ubah1_packing" data-toggle="modal" data-target="#konfUbahStatusSiapkirim" onclick="passRecStatus(@pesanan.RecNum, '03', '@pesanan.NO_BUKTI')">
                    @*<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>*@
                    @*<span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>*@
                    <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                </button>
            </td>
            @*<td style="border-left:hidden">
                <input type="checkbox" class="dt-checkboxes center checkbox_gntstatus_packing" id="chekbox-@(pesanan.RecNum)" data-recnum="@pesanan.RecNum" style="border-left:hidden" />
            </td>*@
            <td class="edit-hapus-col">
                <button class="btn btn-warning" data-toggle="modal" data-target="#konfUndoStatusSiapkirim" onclick="passRecStatus(@pesanan.RecNum, '01', '@pesanan.NO_BUKTI')">
                    <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span>
                </button>
            </td>
            @*<td class="edit-hapus-col">
            <button class="btn btn-danger" data-toggle="modal" data-target="#konfHapusPesanan" onclick="pass(@pesanan.RecNum)">
                <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
            </button>
        </td>*@
        </tr>
        }
    </tbody>
</table>
